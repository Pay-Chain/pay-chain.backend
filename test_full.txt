go test -v ./...
=== RUN   TestParseUserID
--- PASS: TestParseUserID (0.00s)
=== RUN   TestResolveAPIKeyName
--- PASS: TestResolveAPIKeyName (0.00s)
=== RUN   TestMain_ExitsWhenUserIDMissing
--- PASS: TestMain_ExitsWhenUserIDMissing (0.01s)
=== RUN   TestMain_ExitsOnDBConnectionFailure
--- PASS: TestMain_ExitsOnDBConnectionFailure (0.01s)
=== RUN   TestMain_ExitsOnInvalidUserIDFormat
--- PASS: TestMain_ExitsOnInvalidUserIDFormat (0.01s)
=== RUN   TestRunAdminAPIKey_Branches
=== RUN   TestRunAdminAPIKey_Branches/flag_parse_error
flag provided but not defined: -unknown-flag
Usage of admin-apikey:
  -name string
    	api key display name (optional)
  -user-id string
    	target user UUID (required)
=== RUN   TestRunAdminAPIKey_Branches/prepare_error
2026/02/18 18:05:57 No .env file found, using environment variables
=== RUN   TestRunAdminAPIKey_Branches/user_load_error
=== RUN   TestRunAdminAPIKey_Branches/non_admin_user
=== RUN   TestRunAdminAPIKey_Branches/create_api_key_error
=== RUN   TestRunAdminAPIKey_Branches/success_output
=== RUN   TestRunAdminAPIKey_Branches/nil_closer_fallback_branch
--- PASS: TestRunAdminAPIKey_Branches (0.00s)
    --- PASS: TestRunAdminAPIKey_Branches/flag_parse_error (0.00s)
    --- PASS: TestRunAdminAPIKey_Branches/prepare_error (0.00s)
    --- PASS: TestRunAdminAPIKey_Branches/user_load_error (0.00s)
    --- PASS: TestRunAdminAPIKey_Branches/non_admin_user (0.00s)
    --- PASS: TestRunAdminAPIKey_Branches/create_api_key_error (0.00s)
    --- PASS: TestRunAdminAPIKey_Branches/success_output (0.00s)
    --- PASS: TestRunAdminAPIKey_Branches/nil_closer_fallback_branch (0.00s)
=== RUN   TestRunAdminAPIKey_UsesDefaultInjectedFunctionsWhenNil
--- PASS: TestRunAdminAPIKey_UsesDefaultInjectedFunctionsWhenNil (0.00s)
=== RUN   TestRunAdminAPIKey_DefaultNilsForLoaders
2026/02/18 18:05:57 No .env file found, using environment variables
--- PASS: TestRunAdminAPIKey_DefaultNilsForLoaders (0.00s)
=== RUN   TestAdminRuntimeImpl_WrapperMethods
--- PASS: TestAdminRuntimeImpl_WrapperMethods (0.00s)
=== RUN   TestDefaultAdminAPIKeyDeps_PrepareBranch
--- PASS: TestDefaultAdminAPIKeyDeps_PrepareBranch (0.00s)
=== RUN   TestDefaultAdminAPIKeyDeps_Prepare_SQLDBInitErrorBranch
--- PASS: TestDefaultAdminAPIKeyDeps_Prepare_SQLDBInitErrorBranch (0.00s)
PASS
ok  	pay-chain.backend/cmd/admin-apikey	(cached)
=== RUN   TestGenerateRandomHex
--- PASS: TestGenerateRandomHex (0.00s)
=== RUN   TestValidateInputs
--- PASS: TestValidateInputs (0.00s)
=== RUN   TestBuildCredentials
--- PASS: TestBuildCredentials (0.00s)
=== RUN   TestBuildCredentials_RngFailureBranches
--- PASS: TestBuildCredentials_RngFailureBranches (0.00s)
=== RUN   TestMain_Success
--- PASS: TestMain_Success (0.00s)
=== RUN   TestGenerateRandomHex_ReadError
--- PASS: TestGenerateRandomHex_ReadError (0.00s)
=== RUN   TestMain_ExitsOnInvalidInput
--- PASS: TestMain_ExitsOnInvalidInput (0.00s)
PASS
ok  	pay-chain.backend/cmd/apikey-gen	(cached)
=== RUN   TestGeneratePasswordHash
--- PASS: TestGeneratePasswordHash (0.14s)
=== RUN   TestGeneratePasswordHash_InvalidCost
--- PASS: TestGeneratePasswordHash_InvalidCost (0.00s)
=== RUN   TestMain_PrintsHash
--- PASS: TestMain_PrintsHash (1.35s)
PASS
ok  	pay-chain.backend/cmd/genhash	(cached)
=== RUN   TestResolvePassword
--- PASS: TestResolvePassword (0.00s)
=== RUN   TestGenerateHash
--- PASS: TestGenerateHash (0.35s)
=== RUN   TestMain_PrintsHash
--- PASS: TestMain_PrintsHash (0.30s)
=== RUN   TestMain_DefaultPasswordAndFatalBranch
--- PASS: TestMain_DefaultPasswordAndFatalBranch (0.00s)
PASS
ok  	pay-chain.backend/cmd/hash-gen	(cached)
=== RUN   TestMainProcess_ExitsOnRedisInitFailure
--- PASS: TestMainProcess_ExitsOnRedisInitFailure (2.14s)
=== RUN   TestMainProcess_ExitsOnInvalidServerPortAfterSetup
--- PASS: TestMainProcess_ExitsOnInvalidServerPortAfterSetup (0.04s)
=== RUN   TestMainProcess_ExitsOnInvalidSessionEncryptionKey
--- PASS: TestMainProcess_ExitsOnInvalidSessionEncryptionKey (0.04s)
=== RUN   TestMainProcess_ExitsOnDBOpenFailure
--- PASS: TestMainProcess_ExitsOnDBOpenFailure (0.02s)
=== RUN   TestRunMainProcess_RedisInitError
2026-02-18T18:06:01.149+0700	[34mINFO[0m	server/main.go:66	Logger initialized	{"env": "development"}
2026-02-18T18:06:01.149+0700	[31mERROR[0m	server/main.go:70	Failed to initialize Redis	{"error": "redis down"}
pay-chain.backend/cmd/server.runMainProcess
	/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/cmd/server/main.go:70
pay-chain.backend/cmd/server.TestRunMainProcess_RedisInitError
	/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/cmd/server/main_unit_test.go:84
testing.tRunner
	/usr/local/go/src/testing/testing.go:1934
--- PASS: TestRunMainProcess_RedisInitError (0.00s)
=== RUN   TestRunMainProcess_DBOpenError
2026-02-18T18:06:01.149+0700	[34mINFO[0m	server/main.go:66	Logger initialized	{"env": "development"}
2026-02-18T18:06:01.149+0700	[34mINFO[0m	server/main.go:73	Redis initialized
--- PASS: TestRunMainProcess_DBOpenError (0.00s)
=== RUN   TestRunMainProcess_SessionStoreError
2026-02-18T18:06:01.149+0700	[34mINFO[0m	server/main.go:66	Logger initialized	{"env": "development"}
2026-02-18T18:06:01.149+0700	[34mINFO[0m	server/main.go:73	Redis initialized
2026/02/18 18:06:01 âœ… Connected to PostgreSQL via GORM
--- PASS: TestRunMainProcess_SessionStoreError (0.00s)
=== RUN   TestRunMainProcess_ServerRunError
2026-02-18T18:06:01.150+0700	[34mINFO[0m	server/main.go:66	Logger initialized	{"env": "development"}
2026-02-18T18:06:01.150+0700	[34mINFO[0m	server/main.go:73	Redis initialized
2026/02/18 18:06:01 âœ… Connected to PostgreSQL via GORM
[GIN-debug] [WARNING] Running in "debug" mode. Switch to "release" mode in production.
 - using env:	export GIN_MODE=release
 - using code:	gin.SetMode(gin.ReleaseMode)

[GIN-debug] GET    /health                   --> pay-chain.backend/cmd/server.registerHealthRoute.func1 (5 handlers)
[GIN-debug] POST   /api/v1/auth/register     --> pay-chain.backend/internal/interfaces/http/handlers.(*AuthHandler).Register-fm (5 handlers)
[GIN-debug] POST   /api/v1/auth/login        --> pay-chain.backend/internal/interfaces/http/handlers.(*AuthHandler).Login-fm (5 handlers)
[GIN-debug] POST   /api/v1/auth/verify-email --> pay-chain.backend/internal/interfaces/http/handlers.(*AuthHandler).VerifyEmail-fm (5 handlers)
[GIN-debug] POST   /api/v1/auth/refresh      --> pay-chain.backend/internal/interfaces/http/handlers.(*AuthHandler).RefreshToken-fm (5 handlers)
[GIN-debug] GET    /api/v1/auth/session-expiry --> pay-chain.backend/internal/interfaces/http/handlers.(*AuthHandler).GetSessionExpiry-fm (5 handlers)
[GIN-debug] GET    /api/v1/auth/me           --> pay-chain.backend/internal/interfaces/http/handlers.(*AuthHandler).GetMe-fm (6 handlers)
[GIN-debug] POST   /api/v1/auth/change-password --> pay-chain.backend/internal/interfaces/http/handlers.(*AuthHandler).ChangePassword-fm (6 handlers)
[GIN-debug] POST   /api/v1/payments          --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentHandler).CreatePayment-fm (7 handlers)
[GIN-debug] GET    /api/v1/payments/:id      --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentHandler).GetPayment-fm (6 handlers)
[GIN-debug] GET    /api/v1/payments          --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentHandler).ListPayments-fm (6 handlers)
[GIN-debug] GET    /api/v1/payments/:id/events --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentHandler).GetPaymentEvents-fm (6 handlers)
[GIN-debug] POST   /api/v1/payment-requests  --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentRequestHandler).CreatePaymentRequest-fm (6 handlers)
[GIN-debug] GET    /api/v1/payment-requests  --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentRequestHandler).ListPaymentRequests-fm (6 handlers)
[GIN-debug] GET    /api/v1/payment-requests/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentRequestHandler).GetPaymentRequest-fm (6 handlers)
[GIN-debug] GET    /api/v1/pay/:id           --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentRequestHandler).GetPublicPaymentRequest-fm (5 handlers)
[GIN-debug] POST   /api/v1/wallets/connect   --> pay-chain.backend/internal/interfaces/http/handlers.(*WalletHandler).ConnectWallet-fm (6 handlers)
[GIN-debug] GET    /api/v1/wallets           --> pay-chain.backend/internal/interfaces/http/handlers.(*WalletHandler).ListWallets-fm (6 handlers)
[GIN-debug] PUT    /api/v1/wallets/:id/primary --> pay-chain.backend/internal/interfaces/http/handlers.(*WalletHandler).SetPrimaryWallet-fm (6 handlers)
[GIN-debug] DELETE /api/v1/wallets/:id       --> pay-chain.backend/internal/interfaces/http/handlers.(*WalletHandler).DisconnectWallet-fm (6 handlers)
[GIN-debug] POST   /api/v1/merchants/apply   --> pay-chain.backend/internal/interfaces/http/handlers.(*MerchantHandler).ApplyMerchant-fm (6 handlers)
[GIN-debug] GET    /api/v1/merchants/status  --> pay-chain.backend/internal/interfaces/http/handlers.(*MerchantHandler).GetMerchantStatus-fm (6 handlers)
[GIN-debug] GET    /api/v1/chains            --> pay-chain.backend/internal/interfaces/http/handlers.(*ChainHandler).ListChains-fm (5 handlers)
[GIN-debug] GET    /api/v1/tokens            --> pay-chain.backend/internal/interfaces/http/handlers.(*TokenHandler).ListSupportedTokens-fm (5 handlers)
[GIN-debug] GET    /api/v1/tokens/stablecoins --> pay-chain.backend/internal/interfaces/http/handlers.(*TokenHandler).ListStablecoins-fm (5 handlers)
[GIN-debug] GET    /api/v1/contracts         --> pay-chain.backend/internal/interfaces/http/handlers.(*SmartContractHandler).ListSmartContracts-fm (5 handlers)
[GIN-debug] GET    /api/v1/contracts/lookup  --> pay-chain.backend/internal/interfaces/http/handlers.(*SmartContractHandler).GetContractByChainAndAddress-fm (5 handlers)
[GIN-debug] GET    /api/v1/contracts/:id     --> pay-chain.backend/internal/interfaces/http/handlers.(*SmartContractHandler).GetSmartContract-fm (5 handlers)
[GIN-debug] GET    /api/v1/teams             --> pay-chain.backend/internal/interfaces/http/handlers.(*TeamHandler).ListPublicTeams-fm (5 handlers)
[GIN-debug] GET    /api/v1/payment-bridges   --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).ListPaymentBridges-fm (5 handlers)
[GIN-debug] GET    /api/v1/bridge-configs    --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).ListBridgeConfigs-fm (5 handlers)
[GIN-debug] GET    /api/v1/fee-configs       --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).ListFeeConfigs-fm (5 handlers)
[GIN-debug] POST   /api/v1/contracts         --> pay-chain.backend/internal/interfaces/http/handlers.(*SmartContractHandler).CreateSmartContract-fm (6 handlers)
[GIN-debug] PUT    /api/v1/contracts/:id     --> pay-chain.backend/internal/interfaces/http/handlers.(*SmartContractHandler).UpdateSmartContract-fm (6 handlers)
[GIN-debug] DELETE /api/v1/contracts/:id     --> pay-chain.backend/internal/interfaces/http/handlers.(*SmartContractHandler).DeleteSmartContract-fm (6 handlers)
[GIN-debug] POST   /api/v1/api-keys          --> pay-chain.backend/internal/interfaces/http/handlers.(*ApiKeyHandler).CreateApiKey-fm (6 handlers)
[GIN-debug] GET    /api/v1/api-keys          --> pay-chain.backend/internal/interfaces/http/handlers.(*ApiKeyHandler).ListApiKeys-fm (6 handlers)
[GIN-debug] DELETE /api/v1/api-keys/:id      --> pay-chain.backend/internal/interfaces/http/handlers.(*ApiKeyHandler).RevokeApiKey-fm (6 handlers)
[GIN-debug] POST   /api/v1/payment-app       --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentAppHandler).CreatePaymentApp-fm (6 handlers)
[GIN-debug] GET    /api/v1/payment-app/diagnostics/route-error/:paymentId --> pay-chain.backend/internal/interfaces/http/handlers.(*RouteErrorHandler).GetRouteError-fm (6 handlers)
[GIN-debug] POST   /api/v1/webhooks/indexer  --> pay-chain.backend/internal/interfaces/http/handlers.(*WebhookHandler).HandleIndexerWebhook-fm (5 handlers)
[GIN-debug] GET    /api/v1/admin/users       --> pay-chain.backend/internal/interfaces/http/handlers.(*AdminHandler).ListUsers-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/merchants   --> pay-chain.backend/internal/interfaces/http/handlers.(*AdminHandler).ListMerchants-fm (7 handlers)
[GIN-debug] PUT    /api/v1/admin/merchants/:id/status --> pay-chain.backend/internal/interfaces/http/handlers.(*AdminHandler).UpdateMerchantStatus-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/stats       --> pay-chain.backend/internal/interfaces/http/handlers.(*AdminHandler).GetStats-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/chains      --> pay-chain.backend/internal/interfaces/http/handlers.(*ChainHandler).CreateChain-fm (7 handlers)
[GIN-debug] PUT    /api/v1/admin/chains/:id  --> pay-chain.backend/internal/interfaces/http/handlers.(*ChainHandler).UpdateChain-fm (7 handlers)
[GIN-debug] DELETE /api/v1/admin/chains/:id  --> pay-chain.backend/internal/interfaces/http/handlers.(*ChainHandler).DeleteChain-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/rpcs        --> pay-chain.backend/internal/interfaces/http/handlers.(*RpcHandler).ListRPCs-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/tokens      --> pay-chain.backend/internal/interfaces/http/handlers.(*TokenHandler).ListSupportedTokens-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/tokens      --> pay-chain.backend/internal/interfaces/http/handlers.(*TokenHandler).CreateToken-fm (7 handlers)
[GIN-debug] PUT    /api/v1/admin/tokens/:id  --> pay-chain.backend/internal/interfaces/http/handlers.(*TokenHandler).UpdateToken-fm (7 handlers)
[GIN-debug] DELETE /api/v1/admin/tokens/:id  --> pay-chain.backend/internal/interfaces/http/handlers.(*TokenHandler).DeleteToken-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/teams       --> pay-chain.backend/internal/interfaces/http/handlers.(*TeamHandler).ListAdminTeams-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/teams       --> pay-chain.backend/internal/interfaces/http/handlers.(*TeamHandler).CreateTeam-fm (7 handlers)
[GIN-debug] PUT    /api/v1/admin/teams/:id   --> pay-chain.backend/internal/interfaces/http/handlers.(*TeamHandler).UpdateTeam-fm (7 handlers)
[GIN-debug] DELETE /api/v1/admin/teams/:id   --> pay-chain.backend/internal/interfaces/http/handlers.(*TeamHandler).DeleteTeam-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/payment-bridges --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).ListPaymentBridges-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/payment-bridges --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).CreatePaymentBridge-fm (7 handlers)
[GIN-debug] PUT    /api/v1/admin/payment-bridges/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).UpdatePaymentBridge-fm (7 handlers)
[GIN-debug] DELETE /api/v1/admin/payment-bridges/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).DeletePaymentBridge-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/bridge-configs --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).ListBridgeConfigs-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/bridge-configs --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).CreateBridgeConfig-fm (7 handlers)
[GIN-debug] PUT    /api/v1/admin/bridge-configs/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).UpdateBridgeConfig-fm (7 handlers)
[GIN-debug] DELETE /api/v1/admin/bridge-configs/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).DeleteBridgeConfig-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/fee-configs --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).ListFeeConfigs-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/fee-configs --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).CreateFeeConfig-fm (7 handlers)
2026/02/18 18:06:01 ğŸ• Starting payment request expiry job...
[GIN-debug] PUT    /api/v1/admin/fee-configs/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).UpdateFeeConfig-fm (7 handlers)
[GIN-debug] DELETE /api/v1/admin/fee-configs/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).DeleteFeeConfig-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/onchain-adapters/status --> pay-chain.backend/internal/interfaces/http/handlers.(*OnchainAdapterHandler).GetStatus-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/onchain-adapters/register --> pay-chain.backend/internal/interfaces/http/handlers.(*OnchainAdapterHandler).RegisterAdapter-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/onchain-adapters/default-bridge --> pay-chain.backend/internal/interfaces/http/handlers.(*OnchainAdapterHandler).SetDefaultBridgeType-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/onchain-adapters/hyperbridge-config --> pay-chain.backend/internal/interfaces/http/handlers.(*OnchainAdapterHandler).SetHyperbridgeConfig-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/onchain-adapters/ccip-config --> pay-chain.backend/internal/interfaces/http/handlers.(*OnchainAdapterHandler).SetCCIPConfig-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/onchain-adapters/layerzero-config --> pay-chain.backend/internal/interfaces/http/handlers.(*OnchainAdapterHandler).SetLayerZeroConfig-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/contracts/config-check --> pay-chain.backend/internal/interfaces/http/handlers.(*ContractConfigAuditHandler).Check-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/contracts/:id/config-check --> pay-chain.backend/internal/interfaces/http/handlers.(*ContractConfigAuditHandler).CheckByContract-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/crosschain-config/overview --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainConfigHandler).Overview-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/crosschain-config/preflight --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainConfigHandler).Preflight-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/crosschain-config/recheck --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainConfigHandler).Recheck-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/crosschain-config/recheck-bulk --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainConfigHandler).RecheckBulk-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/crosschain-config/auto-fix --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainConfigHandler).AutoFix-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/crosschain-config/auto-fix-bulk --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainConfigHandler).AutoFixBulk-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/route-policies --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainPolicyHandler).ListRoutePolicies-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/route-policies --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainPolicyHandler).CreateRoutePolicy-fm (7 handlers)
[GIN-debug] PUT    /api/v1/admin/route-policies/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainPolicyHandler).UpdateRoutePolicy-fm (7 handlers)
[GIN-debug] DELETE /api/v1/admin/route-policies/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainPolicyHandler).DeleteRoutePolicy-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/layerzero-configs --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainPolicyHandler).ListLayerZeroConfigs-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/layerzero-configs --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainPolicyHandler).CreateLayerZeroConfig-fm (7 handlers)
[GIN-debug] PUT    /api/v1/admin/layerzero-configs/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainPolicyHandler).UpdateLayerZeroConfig-fm (7 handlers)
[GIN-debug] DELETE /api/v1/admin/layerzero-configs/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainPolicyHandler).DeleteLayerZeroConfig-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/diagnostics/route-error/:paymentId --> pay-chain.backend/internal/interfaces/http/handlers.(*RouteErrorHandler).GetRouteError-fm (7 handlers)
2026/02/18 18:06:01 ğŸ“‹ Registered Routes:
2026/02/18 18:06:01    GET /api/v1/admin/contracts/config-check
2026/02/18 18:06:01    GET /api/v1/admin/contracts/:id/config-check
2026/02/18 18:06:01    GET /api/v1/admin/crosschain-config/overview
2026/02/18 18:06:01    GET /api/v1/admin/crosschain-config/preflight
2026/02/18 18:06:01    GET /api/v1/admin/tokens
2026/02/18 18:06:01    GET /api/v1/admin/teams
2026/02/18 18:06:01    GET /api/v1/admin/rpcs
2026/02/18 18:06:01    GET /api/v1/admin/route-policies
2026/02/18 18:06:01    GET /api/v1/admin/users
2026/02/18 18:06:01    GET /api/v1/admin/merchants
2026/02/18 18:06:01    GET /api/v1/admin/stats
2026/02/18 18:06:01    GET /api/v1/admin/payment-bridges
2026/02/18 18:06:01    GET /api/v1/admin/bridge-configs
2026/02/18 18:06:01    GET /api/v1/admin/fee-configs
2026/02/18 18:06:01    GET /api/v1/admin/onchain-adapters/status
2026/02/18 18:06:01    GET /api/v1/admin/layerzero-configs
2026/02/18 18:06:01    GET /api/v1/admin/diagnostics/route-error/:paymentId
2026/02/18 18:06:01    GET /api/v1/auth/session-expiry
2026/02/18 18:06:01    GET /api/v1/auth/me
2026/02/18 18:06:01    GET /api/v1/api-keys
2026/02/18 18:06:01    GET /api/v1/payment-requests
2026/02/18 18:06:01    GET /api/v1/payment-requests/:id
2026/02/18 18:06:01    GET /api/v1/payment-bridges
2026/02/18 18:06:01    GET /api/v1/payment-app/diagnostics/route-error/:paymentId
2026/02/18 18:06:01    GET /api/v1/payments
2026/02/18 18:06:01    GET /api/v1/payments/:id
2026/02/18 18:06:01    GET /api/v1/payments/:id/events
2026/02/18 18:06:01    GET /api/v1/pay/:id
2026/02/18 18:06:01    GET /api/v1/contracts
2026/02/18 18:06:01    GET /api/v1/contracts/lookup
2026/02/18 18:06:01    GET /api/v1/contracts/:id
2026/02/18 18:06:01    GET /api/v1/chains
2026/02/18 18:06:01    GET /api/v1/tokens
2026/02/18 18:06:01    GET /api/v1/tokens/stablecoins
2026/02/18 18:06:01    GET /api/v1/teams
2026/02/18 18:06:01    GET /api/v1/wallets
2026/02/18 18:06:01    GET /api/v1/merchants/status
2026/02/18 18:06:01    GET /api/v1/bridge-configs
2026/02/18 18:06:01    GET /api/v1/fee-configs
2026/02/18 18:06:01    GET /health
2026/02/18 18:06:01    POST /api/v1/admin/onchain-adapters/register
2026/02/18 18:06:01    POST /api/v1/admin/onchain-adapters/default-bridge
2026/02/18 18:06:01    POST /api/v1/admin/onchain-adapters/hyperbridge-config
2026/02/18 18:06:01    POST /api/v1/admin/onchain-adapters/ccip-config
2026/02/18 18:06:01    POST /api/v1/admin/onchain-adapters/layerzero-config
2026/02/18 18:06:01    POST /api/v1/admin/crosschain-config/recheck
2026/02/18 18:06:01    POST /api/v1/admin/crosschain-config/recheck-bulk
2026/02/18 18:06:01    POST /api/v1/admin/crosschain-config/auto-fix
2026/02/18 18:06:01    POST /api/v1/admin/crosschain-config/auto-fix-bulk
2026/02/18 18:06:01    POST /api/v1/admin/chains
2026/02/18 18:06:01    POST /api/v1/admin/tokens
2026/02/18 18:06:01    POST /api/v1/admin/teams
2026/02/18 18:06:01    POST /api/v1/admin/payment-bridges
2026/02/18 18:06:01    POST /api/v1/admin/bridge-configs
2026/02/18 18:06:01    POST /api/v1/admin/fee-configs
2026/02/18 18:06:01    POST /api/v1/admin/route-policies
2026/02/18 18:06:01    POST /api/v1/admin/layerzero-configs
2026/02/18 18:06:01    POST /api/v1/auth/register
2026/02/18 18:06:01    POST /api/v1/auth/refresh
2026/02/18 18:06:01    POST /api/v1/auth/login
2026/02/18 18:06:01    POST /api/v1/auth/verify-email
2026/02/18 18:06:01    POST /api/v1/auth/change-password
2026/02/18 18:06:01    POST /api/v1/api-keys
2026/02/18 18:06:01    POST /api/v1/payment-requests
2026/02/18 18:06:01    POST /api/v1/payment-app
2026/02/18 18:06:01    POST /api/v1/payments
2026/02/18 18:06:01    POST /api/v1/wallets/connect
2026/02/18 18:06:01    POST /api/v1/webhooks/indexer
2026/02/18 18:06:01    POST /api/v1/merchants/apply
2026/02/18 18:06:01    POST /api/v1/contracts
2026/02/18 18:06:01    PUT /api/v1/admin/tokens/:id
2026/02/18 18:06:01    PUT /api/v1/admin/teams/:id
2026/02/18 18:06:01    PUT /api/v1/admin/merchants/:id/status
2026/02/18 18:06:01    PUT /api/v1/admin/chains/:id
2026/02/18 18:06:01    PUT /api/v1/admin/payment-bridges/:id
2026/02/18 18:06:01    PUT /api/v1/admin/bridge-configs/:id
2026/02/18 18:06:01    PUT /api/v1/admin/fee-configs/:id
2026/02/18 18:06:01    PUT /api/v1/admin/route-policies/:id
2026/02/18 18:06:01    PUT /api/v1/admin/layerzero-configs/:id
2026/02/18 18:06:01    PUT /api/v1/wallets/:id/primary
2026/02/18 18:06:01    PUT /api/v1/contracts/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/tokens/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/teams/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/chains/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/payment-bridges/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/bridge-configs/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/fee-configs/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/route-policies/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/layerzero-configs/:id
2026/02/18 18:06:01    DELETE /api/v1/api-keys/:id
2026/02/18 18:06:01    DELETE /api/v1/wallets/:id
2026/02/18 18:06:01    DELETE /api/v1/contracts/:id
2026/02/18 18:06:01 ğŸš€ Pay-Chain Backend starting on port 18080
2026/02/18 18:06:01 ğŸ“š API: http://localhost:18080/api/v1
2026/02/18 18:06:01 â¤ï¸ Health: http://localhost:18080/health
--- PASS: TestRunMainProcess_ServerRunError (0.00s)
=== RUN   TestRunMainProcess_SuccessPath
2026-02-18T18:06:01.151+0700	[34mINFO[0m	server/main.go:66	Logger initialized	{"env": "development"}
2026-02-18T18:06:01.151+0700	[34mINFO[0m	server/main.go:73	Redis initialized
2026/02/18 18:06:01 â¹ï¸ Payment request expiry job stopped (context cancelled)
2026/02/18 18:06:01 âœ… Connected to PostgreSQL via GORM
[GIN-debug] [WARNING] Running in "debug" mode. Switch to "release" mode in production.
 - using env:	export GIN_MODE=release
 - using code:	gin.SetMode(gin.ReleaseMode)

[GIN-debug] GET    /health                   --> pay-chain.backend/cmd/server.registerHealthRoute.func1 (5 handlers)
[GIN-debug] POST   /api/v1/auth/register     --> pay-chain.backend/internal/interfaces/http/handlers.(*AuthHandler).Register-fm (5 handlers)
[GIN-debug] POST   /api/v1/auth/login        --> pay-chain.backend/internal/interfaces/http/handlers.(*AuthHandler).Login-fm (5 handlers)
[GIN-debug] POST   /api/v1/auth/verify-email --> pay-chain.backend/internal/interfaces/http/handlers.(*AuthHandler).VerifyEmail-fm (5 handlers)
[GIN-debug] POST   /api/v1/auth/refresh      --> pay-chain.backend/internal/interfaces/http/handlers.(*AuthHandler).RefreshToken-fm (5 handlers)
[GIN-debug] GET    /api/v1/auth/session-expiry --> pay-chain.backend/internal/interfaces/http/handlers.(*AuthHandler).GetSessionExpiry-fm (5 handlers)
[GIN-debug] GET    /api/v1/auth/me           --> pay-chain.backend/internal/interfaces/http/handlers.(*AuthHandler).GetMe-fm (6 handlers)
[GIN-debug] POST   /api/v1/auth/change-password --> pay-chain.backend/internal/interfaces/http/handlers.(*AuthHandler).ChangePassword-fm (6 handlers)
[GIN-debug] POST   /api/v1/payments          --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentHandler).CreatePayment-fm (7 handlers)
[GIN-debug] GET    /api/v1/payments/:id      --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentHandler).GetPayment-fm (6 handlers)
[GIN-debug] GET    /api/v1/payments          --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentHandler).ListPayments-fm (6 handlers)
[GIN-debug] GET    /api/v1/payments/:id/events --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentHandler).GetPaymentEvents-fm (6 handlers)
[GIN-debug] POST   /api/v1/payment-requests  --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentRequestHandler).CreatePaymentRequest-fm (6 handlers)
[GIN-debug] GET    /api/v1/payment-requests  --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentRequestHandler).ListPaymentRequests-fm (6 handlers)
[GIN-debug] GET    /api/v1/payment-requests/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentRequestHandler).GetPaymentRequest-fm (6 handlers)
[GIN-debug] GET    /api/v1/pay/:id           --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentRequestHandler).GetPublicPaymentRequest-fm (5 handlers)
[GIN-debug] POST   /api/v1/wallets/connect   --> pay-chain.backend/internal/interfaces/http/handlers.(*WalletHandler).ConnectWallet-fm (6 handlers)
[GIN-debug] GET    /api/v1/wallets           --> pay-chain.backend/internal/interfaces/http/handlers.(*WalletHandler).ListWallets-fm (6 handlers)
2026/02/18 18:06:01 ğŸ• Starting payment request expiry job...
[GIN-debug] PUT    /api/v1/wallets/:id/primary --> pay-chain.backend/internal/interfaces/http/handlers.(*WalletHandler).SetPrimaryWallet-fm (6 handlers)
[GIN-debug] DELETE /api/v1/wallets/:id       --> pay-chain.backend/internal/interfaces/http/handlers.(*WalletHandler).DisconnectWallet-fm (6 handlers)
[GIN-debug] POST   /api/v1/merchants/apply   --> pay-chain.backend/internal/interfaces/http/handlers.(*MerchantHandler).ApplyMerchant-fm (6 handlers)
[GIN-debug] GET    /api/v1/merchants/status  --> pay-chain.backend/internal/interfaces/http/handlers.(*MerchantHandler).GetMerchantStatus-fm (6 handlers)
[GIN-debug] GET    /api/v1/chains            --> pay-chain.backend/internal/interfaces/http/handlers.(*ChainHandler).ListChains-fm (5 handlers)
[GIN-debug] GET    /api/v1/tokens            --> pay-chain.backend/internal/interfaces/http/handlers.(*TokenHandler).ListSupportedTokens-fm (5 handlers)
[GIN-debug] GET    /api/v1/tokens/stablecoins --> pay-chain.backend/internal/interfaces/http/handlers.(*TokenHandler).ListStablecoins-fm (5 handlers)
[GIN-debug] GET    /api/v1/contracts         --> pay-chain.backend/internal/interfaces/http/handlers.(*SmartContractHandler).ListSmartContracts-fm (5 handlers)
[GIN-debug] GET    /api/v1/contracts/lookup  --> pay-chain.backend/internal/interfaces/http/handlers.(*SmartContractHandler).GetContractByChainAndAddress-fm (5 handlers)
[GIN-debug] GET    /api/v1/contracts/:id     --> pay-chain.backend/internal/interfaces/http/handlers.(*SmartContractHandler).GetSmartContract-fm (5 handlers)
[GIN-debug] GET    /api/v1/teams             --> pay-chain.backend/internal/interfaces/http/handlers.(*TeamHandler).ListPublicTeams-fm (5 handlers)
[GIN-debug] GET    /api/v1/payment-bridges   --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).ListPaymentBridges-fm (5 handlers)
[GIN-debug] GET    /api/v1/bridge-configs    --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).ListBridgeConfigs-fm (5 handlers)
[GIN-debug] GET    /api/v1/fee-configs       --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).ListFeeConfigs-fm (5 handlers)
[GIN-debug] POST   /api/v1/contracts         --> pay-chain.backend/internal/interfaces/http/handlers.(*SmartContractHandler).CreateSmartContract-fm (6 handlers)
[GIN-debug] PUT    /api/v1/contracts/:id     --> pay-chain.backend/internal/interfaces/http/handlers.(*SmartContractHandler).UpdateSmartContract-fm (6 handlers)
[GIN-debug] DELETE /api/v1/contracts/:id     --> pay-chain.backend/internal/interfaces/http/handlers.(*SmartContractHandler).DeleteSmartContract-fm (6 handlers)
[GIN-debug] POST   /api/v1/api-keys          --> pay-chain.backend/internal/interfaces/http/handlers.(*ApiKeyHandler).CreateApiKey-fm (6 handlers)
[GIN-debug] GET    /api/v1/api-keys          --> pay-chain.backend/internal/interfaces/http/handlers.(*ApiKeyHandler).ListApiKeys-fm (6 handlers)
[GIN-debug] DELETE /api/v1/api-keys/:id      --> pay-chain.backend/internal/interfaces/http/handlers.(*ApiKeyHandler).RevokeApiKey-fm (6 handlers)
[GIN-debug] POST   /api/v1/payment-app       --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentAppHandler).CreatePaymentApp-fm (6 handlers)
[GIN-debug] GET    /api/v1/payment-app/diagnostics/route-error/:paymentId --> pay-chain.backend/internal/interfaces/http/handlers.(*RouteErrorHandler).GetRouteError-fm (6 handlers)
[GIN-debug] POST   /api/v1/webhooks/indexer  --> pay-chain.backend/internal/interfaces/http/handlers.(*WebhookHandler).HandleIndexerWebhook-fm (5 handlers)
[GIN-debug] GET    /api/v1/admin/users       --> pay-chain.backend/internal/interfaces/http/handlers.(*AdminHandler).ListUsers-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/merchants   --> pay-chain.backend/internal/interfaces/http/handlers.(*AdminHandler).ListMerchants-fm (7 handlers)
[GIN-debug] PUT    /api/v1/admin/merchants/:id/status --> pay-chain.backend/internal/interfaces/http/handlers.(*AdminHandler).UpdateMerchantStatus-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/stats       --> pay-chain.backend/internal/interfaces/http/handlers.(*AdminHandler).GetStats-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/chains      --> pay-chain.backend/internal/interfaces/http/handlers.(*ChainHandler).CreateChain-fm (7 handlers)
[GIN-debug] PUT    /api/v1/admin/chains/:id  --> pay-chain.backend/internal/interfaces/http/handlers.(*ChainHandler).UpdateChain-fm (7 handlers)
[GIN-debug] DELETE /api/v1/admin/chains/:id  --> pay-chain.backend/internal/interfaces/http/handlers.(*ChainHandler).DeleteChain-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/rpcs        --> pay-chain.backend/internal/interfaces/http/handlers.(*RpcHandler).ListRPCs-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/tokens      --> pay-chain.backend/internal/interfaces/http/handlers.(*TokenHandler).ListSupportedTokens-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/tokens      --> pay-chain.backend/internal/interfaces/http/handlers.(*TokenHandler).CreateToken-fm (7 handlers)
[GIN-debug] PUT    /api/v1/admin/tokens/:id  --> pay-chain.backend/internal/interfaces/http/handlers.(*TokenHandler).UpdateToken-fm (7 handlers)
[GIN-debug] DELETE /api/v1/admin/tokens/:id  --> pay-chain.backend/internal/interfaces/http/handlers.(*TokenHandler).DeleteToken-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/teams       --> pay-chain.backend/internal/interfaces/http/handlers.(*TeamHandler).ListAdminTeams-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/teams       --> pay-chain.backend/internal/interfaces/http/handlers.(*TeamHandler).CreateTeam-fm (7 handlers)
[GIN-debug] PUT    /api/v1/admin/teams/:id   --> pay-chain.backend/internal/interfaces/http/handlers.(*TeamHandler).UpdateTeam-fm (7 handlers)
[GIN-debug] DELETE /api/v1/admin/teams/:id   --> pay-chain.backend/internal/interfaces/http/handlers.(*TeamHandler).DeleteTeam-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/payment-bridges --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).ListPaymentBridges-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/payment-bridges --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).CreatePaymentBridge-fm (7 handlers)
[GIN-debug] PUT    /api/v1/admin/payment-bridges/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).UpdatePaymentBridge-fm (7 handlers)
[GIN-debug] DELETE /api/v1/admin/payment-bridges/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).DeletePaymentBridge-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/bridge-configs --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).ListBridgeConfigs-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/bridge-configs --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).CreateBridgeConfig-fm (7 handlers)
[GIN-debug] PUT    /api/v1/admin/bridge-configs/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).UpdateBridgeConfig-fm (7 handlers)
[GIN-debug] DELETE /api/v1/admin/bridge-configs/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).DeleteBridgeConfig-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/fee-configs --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).ListFeeConfigs-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/fee-configs --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).CreateFeeConfig-fm (7 handlers)
[GIN-debug] PUT    /api/v1/admin/fee-configs/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).UpdateFeeConfig-fm (7 handlers)
[GIN-debug] DELETE /api/v1/admin/fee-configs/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).DeleteFeeConfig-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/onchain-adapters/status --> pay-chain.backend/internal/interfaces/http/handlers.(*OnchainAdapterHandler).GetStatus-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/onchain-adapters/register --> pay-chain.backend/internal/interfaces/http/handlers.(*OnchainAdapterHandler).RegisterAdapter-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/onchain-adapters/default-bridge --> pay-chain.backend/internal/interfaces/http/handlers.(*OnchainAdapterHandler).SetDefaultBridgeType-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/onchain-adapters/hyperbridge-config --> pay-chain.backend/internal/interfaces/http/handlers.(*OnchainAdapterHandler).SetHyperbridgeConfig-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/onchain-adapters/ccip-config --> pay-chain.backend/internal/interfaces/http/handlers.(*OnchainAdapterHandler).SetCCIPConfig-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/onchain-adapters/layerzero-config --> pay-chain.backend/internal/interfaces/http/handlers.(*OnchainAdapterHandler).SetLayerZeroConfig-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/contracts/config-check --> pay-chain.backend/internal/interfaces/http/handlers.(*ContractConfigAuditHandler).Check-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/contracts/:id/config-check --> pay-chain.backend/internal/interfaces/http/handlers.(*ContractConfigAuditHandler).CheckByContract-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/crosschain-config/overview --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainConfigHandler).Overview-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/crosschain-config/preflight --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainConfigHandler).Preflight-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/crosschain-config/recheck --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainConfigHandler).Recheck-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/crosschain-config/recheck-bulk --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainConfigHandler).RecheckBulk-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/crosschain-config/auto-fix --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainConfigHandler).AutoFix-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/crosschain-config/auto-fix-bulk --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainConfigHandler).AutoFixBulk-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/route-policies --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainPolicyHandler).ListRoutePolicies-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/route-policies --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainPolicyHandler).CreateRoutePolicy-fm (7 handlers)
[GIN-debug] PUT    /api/v1/admin/route-policies/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainPolicyHandler).UpdateRoutePolicy-fm (7 handlers)
[GIN-debug] DELETE /api/v1/admin/route-policies/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainPolicyHandler).DeleteRoutePolicy-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/layerzero-configs --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainPolicyHandler).ListLayerZeroConfigs-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/layerzero-configs --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainPolicyHandler).CreateLayerZeroConfig-fm (7 handlers)
[GIN-debug] PUT    /api/v1/admin/layerzero-configs/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainPolicyHandler).UpdateLayerZeroConfig-fm (7 handlers)
[GIN-debug] DELETE /api/v1/admin/layerzero-configs/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainPolicyHandler).DeleteLayerZeroConfig-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/diagnostics/route-error/:paymentId --> pay-chain.backend/internal/interfaces/http/handlers.(*RouteErrorHandler).GetRouteError-fm (7 handlers)
2026/02/18 18:06:01 ğŸ“‹ Registered Routes:
2026/02/18 18:06:01    GET /api/v1/admin/contracts/config-check
2026/02/18 18:06:01    GET /api/v1/admin/contracts/:id/config-check
2026/02/18 18:06:01    GET /api/v1/admin/crosschain-config/overview
2026/02/18 18:06:01    GET /api/v1/admin/crosschain-config/preflight
2026/02/18 18:06:01    GET /api/v1/admin/tokens
2026/02/18 18:06:01    GET /api/v1/admin/teams
2026/02/18 18:06:01    GET /api/v1/admin/rpcs
2026/02/18 18:06:01    GET /api/v1/admin/route-policies
2026/02/18 18:06:01    GET /api/v1/admin/users
2026/02/18 18:06:01    GET /api/v1/admin/merchants
2026/02/18 18:06:01    GET /api/v1/admin/stats
2026/02/18 18:06:01    GET /api/v1/admin/payment-bridges
2026/02/18 18:06:01    GET /api/v1/admin/bridge-configs
2026/02/18 18:06:01    GET /api/v1/admin/fee-configs
2026/02/18 18:06:01    GET /api/v1/admin/onchain-adapters/status
2026/02/18 18:06:01    GET /api/v1/admin/layerzero-configs
2026/02/18 18:06:01    GET /api/v1/admin/diagnostics/route-error/:paymentId
2026/02/18 18:06:01    GET /api/v1/auth/session-expiry
2026/02/18 18:06:01    GET /api/v1/auth/me
2026/02/18 18:06:01    GET /api/v1/api-keys
2026/02/18 18:06:01    GET /api/v1/payment-requests
2026/02/18 18:06:01    GET /api/v1/payment-requests/:id
2026/02/18 18:06:01    GET /api/v1/payment-bridges
2026/02/18 18:06:01    GET /api/v1/payment-app/diagnostics/route-error/:paymentId
2026/02/18 18:06:01    GET /api/v1/payments
2026/02/18 18:06:01    GET /api/v1/payments/:id
2026/02/18 18:06:01    GET /api/v1/payments/:id/events
2026/02/18 18:06:01    GET /api/v1/pay/:id
2026/02/18 18:06:01    GET /api/v1/contracts
2026/02/18 18:06:01    GET /api/v1/contracts/lookup
2026/02/18 18:06:01    GET /api/v1/contracts/:id
2026/02/18 18:06:01    GET /api/v1/chains
2026/02/18 18:06:01    GET /api/v1/tokens
2026/02/18 18:06:01    GET /api/v1/tokens/stablecoins
2026/02/18 18:06:01    GET /api/v1/teams
2026/02/18 18:06:01    GET /api/v1/wallets
2026/02/18 18:06:01    GET /api/v1/merchants/status
2026/02/18 18:06:01    GET /api/v1/bridge-configs
2026/02/18 18:06:01    GET /api/v1/fee-configs
2026/02/18 18:06:01    GET /health
2026/02/18 18:06:01    POST /api/v1/admin/onchain-adapters/register
2026/02/18 18:06:01    POST /api/v1/admin/onchain-adapters/default-bridge
2026/02/18 18:06:01    POST /api/v1/admin/onchain-adapters/hyperbridge-config
2026/02/18 18:06:01    POST /api/v1/admin/onchain-adapters/ccip-config
2026/02/18 18:06:01    POST /api/v1/admin/onchain-adapters/layerzero-config
2026/02/18 18:06:01    POST /api/v1/admin/crosschain-config/recheck
2026/02/18 18:06:01    POST /api/v1/admin/crosschain-config/recheck-bulk
2026/02/18 18:06:01    POST /api/v1/admin/crosschain-config/auto-fix
2026/02/18 18:06:01    POST /api/v1/admin/crosschain-config/auto-fix-bulk
2026/02/18 18:06:01    POST /api/v1/admin/chains
2026/02/18 18:06:01    POST /api/v1/admin/tokens
2026/02/18 18:06:01    POST /api/v1/admin/teams
2026/02/18 18:06:01    POST /api/v1/admin/payment-bridges
2026/02/18 18:06:01    POST /api/v1/admin/bridge-configs
2026/02/18 18:06:01    POST /api/v1/admin/fee-configs
2026/02/18 18:06:01    POST /api/v1/admin/route-policies
2026/02/18 18:06:01    POST /api/v1/admin/layerzero-configs
2026/02/18 18:06:01    POST /api/v1/auth/register
2026/02/18 18:06:01    POST /api/v1/auth/refresh
2026/02/18 18:06:01    POST /api/v1/auth/login
2026/02/18 18:06:01    POST /api/v1/auth/verify-email
2026/02/18 18:06:01    POST /api/v1/auth/change-password
2026/02/18 18:06:01    POST /api/v1/api-keys
2026/02/18 18:06:01    POST /api/v1/payment-requests
2026/02/18 18:06:01    POST /api/v1/payment-app
2026/02/18 18:06:01    POST /api/v1/payments
2026/02/18 18:06:01    POST /api/v1/wallets/connect
2026/02/18 18:06:01    POST /api/v1/webhooks/indexer
2026/02/18 18:06:01    POST /api/v1/merchants/apply
2026/02/18 18:06:01    POST /api/v1/contracts
2026/02/18 18:06:01    PUT /api/v1/admin/tokens/:id
2026/02/18 18:06:01    PUT /api/v1/admin/teams/:id
2026/02/18 18:06:01    PUT /api/v1/admin/merchants/:id/status
2026/02/18 18:06:01    PUT /api/v1/admin/chains/:id
2026/02/18 18:06:01    PUT /api/v1/admin/payment-bridges/:id
2026/02/18 18:06:01    PUT /api/v1/admin/bridge-configs/:id
2026/02/18 18:06:01    PUT /api/v1/admin/fee-configs/:id
2026/02/18 18:06:01    PUT /api/v1/admin/route-policies/:id
2026/02/18 18:06:01    PUT /api/v1/admin/layerzero-configs/:id
2026/02/18 18:06:01    PUT /api/v1/wallets/:id/primary
2026/02/18 18:06:01    PUT /api/v1/contracts/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/tokens/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/teams/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/chains/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/payment-bridges/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/bridge-configs/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/fee-configs/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/route-policies/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/layerzero-configs/:id
2026/02/18 18:06:01    DELETE /api/v1/api-keys/:id
2026/02/18 18:06:01    DELETE /api/v1/wallets/:id
2026/02/18 18:06:01    DELETE /api/v1/contracts/:id
2026/02/18 18:06:01 ğŸš€ Pay-Chain Backend starting on port 18080
2026/02/18 18:06:01 ğŸ“š API: http://localhost:18080/api/v1
2026/02/18 18:06:01 â¤ï¸ Health: http://localhost:18080/health
2026/02/18 18:06:01 â¹ï¸ Payment request expiry job stopped (context cancelled)
--- PASS: TestRunMainProcess_SuccessPath (0.00s)
=== RUN   TestRunMainProcess_SuccessPath_WithDotenvLoadError
2026/02/18 18:06:01 No .env file found, using environment variables
2026-02-18T18:06:01.153+0700	[34mINFO[0m	server/main.go:66	Logger initialized	{"env": "development"}
2026-02-18T18:06:01.153+0700	[34mINFO[0m	server/main.go:73	Redis initialized
2026/02/18 18:06:01 âœ… Connected to PostgreSQL via GORM
[GIN-debug] [WARNING] Running in "debug" mode. Switch to "release" mode in production.
 - using env:	export GIN_MODE=release
 - using code:	gin.SetMode(gin.ReleaseMode)

[GIN-debug] GET    /health                   --> pay-chain.backend/cmd/server.registerHealthRoute.func1 (5 handlers)
[GIN-debug] POST   /api/v1/auth/register     --> pay-chain.backend/internal/interfaces/http/handlers.(*AuthHandler).Register-fm (5 handlers)
2026/02/18 18:06:01 ğŸ• Starting payment request expiry job...
[GIN-debug] POST   /api/v1/auth/login        --> pay-chain.backend/internal/interfaces/http/handlers.(*AuthHandler).Login-fm (5 handlers)
[GIN-debug] POST   /api/v1/auth/verify-email --> pay-chain.backend/internal/interfaces/http/handlers.(*AuthHandler).VerifyEmail-fm (5 handlers)
[GIN-debug] POST   /api/v1/auth/refresh      --> pay-chain.backend/internal/interfaces/http/handlers.(*AuthHandler).RefreshToken-fm (5 handlers)
[GIN-debug] GET    /api/v1/auth/session-expiry --> pay-chain.backend/internal/interfaces/http/handlers.(*AuthHandler).GetSessionExpiry-fm (5 handlers)
[GIN-debug] GET    /api/v1/auth/me           --> pay-chain.backend/internal/interfaces/http/handlers.(*AuthHandler).GetMe-fm (6 handlers)
[GIN-debug] POST   /api/v1/auth/change-password --> pay-chain.backend/internal/interfaces/http/handlers.(*AuthHandler).ChangePassword-fm (6 handlers)
[GIN-debug] POST   /api/v1/payments          --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentHandler).CreatePayment-fm (7 handlers)
[GIN-debug] GET    /api/v1/payments/:id      --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentHandler).GetPayment-fm (6 handlers)
[GIN-debug] GET    /api/v1/payments          --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentHandler).ListPayments-fm (6 handlers)
[GIN-debug] GET    /api/v1/payments/:id/events --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentHandler).GetPaymentEvents-fm (6 handlers)
[GIN-debug] POST   /api/v1/payment-requests  --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentRequestHandler).CreatePaymentRequest-fm (6 handlers)
[GIN-debug] GET    /api/v1/payment-requests  --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentRequestHandler).ListPaymentRequests-fm (6 handlers)
[GIN-debug] GET    /api/v1/payment-requests/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentRequestHandler).GetPaymentRequest-fm (6 handlers)
[GIN-debug] GET    /api/v1/pay/:id           --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentRequestHandler).GetPublicPaymentRequest-fm (5 handlers)
[GIN-debug] POST   /api/v1/wallets/connect   --> pay-chain.backend/internal/interfaces/http/handlers.(*WalletHandler).ConnectWallet-fm (6 handlers)
[GIN-debug] GET    /api/v1/wallets           --> pay-chain.backend/internal/interfaces/http/handlers.(*WalletHandler).ListWallets-fm (6 handlers)
[GIN-debug] PUT    /api/v1/wallets/:id/primary --> pay-chain.backend/internal/interfaces/http/handlers.(*WalletHandler).SetPrimaryWallet-fm (6 handlers)
[GIN-debug] DELETE /api/v1/wallets/:id       --> pay-chain.backend/internal/interfaces/http/handlers.(*WalletHandler).DisconnectWallet-fm (6 handlers)
[GIN-debug] POST   /api/v1/merchants/apply   --> pay-chain.backend/internal/interfaces/http/handlers.(*MerchantHandler).ApplyMerchant-fm (6 handlers)
[GIN-debug] GET    /api/v1/merchants/status  --> pay-chain.backend/internal/interfaces/http/handlers.(*MerchantHandler).GetMerchantStatus-fm (6 handlers)
[GIN-debug] GET    /api/v1/chains            --> pay-chain.backend/internal/interfaces/http/handlers.(*ChainHandler).ListChains-fm (5 handlers)
[GIN-debug] GET    /api/v1/tokens            --> pay-chain.backend/internal/interfaces/http/handlers.(*TokenHandler).ListSupportedTokens-fm (5 handlers)
[GIN-debug] GET    /api/v1/tokens/stablecoins --> pay-chain.backend/internal/interfaces/http/handlers.(*TokenHandler).ListStablecoins-fm (5 handlers)
[GIN-debug] GET    /api/v1/contracts         --> pay-chain.backend/internal/interfaces/http/handlers.(*SmartContractHandler).ListSmartContracts-fm (5 handlers)
[GIN-debug] GET    /api/v1/contracts/lookup  --> pay-chain.backend/internal/interfaces/http/handlers.(*SmartContractHandler).GetContractByChainAndAddress-fm (5 handlers)
[GIN-debug] GET    /api/v1/contracts/:id     --> pay-chain.backend/internal/interfaces/http/handlers.(*SmartContractHandler).GetSmartContract-fm (5 handlers)
[GIN-debug] GET    /api/v1/teams             --> pay-chain.backend/internal/interfaces/http/handlers.(*TeamHandler).ListPublicTeams-fm (5 handlers)
[GIN-debug] GET    /api/v1/payment-bridges   --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).ListPaymentBridges-fm (5 handlers)
[GIN-debug] GET    /api/v1/bridge-configs    --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).ListBridgeConfigs-fm (5 handlers)
[GIN-debug] GET    /api/v1/fee-configs       --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).ListFeeConfigs-fm (5 handlers)
[GIN-debug] POST   /api/v1/contracts         --> pay-chain.backend/internal/interfaces/http/handlers.(*SmartContractHandler).CreateSmartContract-fm (6 handlers)
[GIN-debug] PUT    /api/v1/contracts/:id     --> pay-chain.backend/internal/interfaces/http/handlers.(*SmartContractHandler).UpdateSmartContract-fm (6 handlers)
[GIN-debug] DELETE /api/v1/contracts/:id     --> pay-chain.backend/internal/interfaces/http/handlers.(*SmartContractHandler).DeleteSmartContract-fm (6 handlers)
[GIN-debug] POST   /api/v1/api-keys          --> pay-chain.backend/internal/interfaces/http/handlers.(*ApiKeyHandler).CreateApiKey-fm (6 handlers)
[GIN-debug] GET    /api/v1/api-keys          --> pay-chain.backend/internal/interfaces/http/handlers.(*ApiKeyHandler).ListApiKeys-fm (6 handlers)
[GIN-debug] DELETE /api/v1/api-keys/:id      --> pay-chain.backend/internal/interfaces/http/handlers.(*ApiKeyHandler).RevokeApiKey-fm (6 handlers)
[GIN-debug] POST   /api/v1/payment-app       --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentAppHandler).CreatePaymentApp-fm (6 handlers)
[GIN-debug] GET    /api/v1/payment-app/diagnostics/route-error/:paymentId --> pay-chain.backend/internal/interfaces/http/handlers.(*RouteErrorHandler).GetRouteError-fm (6 handlers)
[GIN-debug] POST   /api/v1/webhooks/indexer  --> pay-chain.backend/internal/interfaces/http/handlers.(*WebhookHandler).HandleIndexerWebhook-fm (5 handlers)
[GIN-debug] GET    /api/v1/admin/users       --> pay-chain.backend/internal/interfaces/http/handlers.(*AdminHandler).ListUsers-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/merchants   --> pay-chain.backend/internal/interfaces/http/handlers.(*AdminHandler).ListMerchants-fm (7 handlers)
[GIN-debug] PUT    /api/v1/admin/merchants/:id/status --> pay-chain.backend/internal/interfaces/http/handlers.(*AdminHandler).UpdateMerchantStatus-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/stats       --> pay-chain.backend/internal/interfaces/http/handlers.(*AdminHandler).GetStats-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/chains      --> pay-chain.backend/internal/interfaces/http/handlers.(*ChainHandler).CreateChain-fm (7 handlers)
[GIN-debug] PUT    /api/v1/admin/chains/:id  --> pay-chain.backend/internal/interfaces/http/handlers.(*ChainHandler).UpdateChain-fm (7 handlers)
[GIN-debug] DELETE /api/v1/admin/chains/:id  --> pay-chain.backend/internal/interfaces/http/handlers.(*ChainHandler).DeleteChain-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/rpcs        --> pay-chain.backend/internal/interfaces/http/handlers.(*RpcHandler).ListRPCs-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/tokens      --> pay-chain.backend/internal/interfaces/http/handlers.(*TokenHandler).ListSupportedTokens-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/tokens      --> pay-chain.backend/internal/interfaces/http/handlers.(*TokenHandler).CreateToken-fm (7 handlers)
[GIN-debug] PUT    /api/v1/admin/tokens/:id  --> pay-chain.backend/internal/interfaces/http/handlers.(*TokenHandler).UpdateToken-fm (7 handlers)
[GIN-debug] DELETE /api/v1/admin/tokens/:id  --> pay-chain.backend/internal/interfaces/http/handlers.(*TokenHandler).DeleteToken-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/teams       --> pay-chain.backend/internal/interfaces/http/handlers.(*TeamHandler).ListAdminTeams-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/teams       --> pay-chain.backend/internal/interfaces/http/handlers.(*TeamHandler).CreateTeam-fm (7 handlers)
[GIN-debug] PUT    /api/v1/admin/teams/:id   --> pay-chain.backend/internal/interfaces/http/handlers.(*TeamHandler).UpdateTeam-fm (7 handlers)
[GIN-debug] DELETE /api/v1/admin/teams/:id   --> pay-chain.backend/internal/interfaces/http/handlers.(*TeamHandler).DeleteTeam-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/payment-bridges --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).ListPaymentBridges-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/payment-bridges --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).CreatePaymentBridge-fm (7 handlers)
[GIN-debug] PUT    /api/v1/admin/payment-bridges/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).UpdatePaymentBridge-fm (7 handlers)
[GIN-debug] DELETE /api/v1/admin/payment-bridges/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).DeletePaymentBridge-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/bridge-configs --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).ListBridgeConfigs-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/bridge-configs --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).CreateBridgeConfig-fm (7 handlers)
[GIN-debug] PUT    /api/v1/admin/bridge-configs/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).UpdateBridgeConfig-fm (7 handlers)
[GIN-debug] DELETE /api/v1/admin/bridge-configs/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).DeleteBridgeConfig-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/fee-configs --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).ListFeeConfigs-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/fee-configs --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).CreateFeeConfig-fm (7 handlers)
[GIN-debug] PUT    /api/v1/admin/fee-configs/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).UpdateFeeConfig-fm (7 handlers)
[GIN-debug] DELETE /api/v1/admin/fee-configs/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*PaymentConfigHandler).DeleteFeeConfig-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/onchain-adapters/status --> pay-chain.backend/internal/interfaces/http/handlers.(*OnchainAdapterHandler).GetStatus-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/onchain-adapters/register --> pay-chain.backend/internal/interfaces/http/handlers.(*OnchainAdapterHandler).RegisterAdapter-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/onchain-adapters/default-bridge --> pay-chain.backend/internal/interfaces/http/handlers.(*OnchainAdapterHandler).SetDefaultBridgeType-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/onchain-adapters/hyperbridge-config --> pay-chain.backend/internal/interfaces/http/handlers.(*OnchainAdapterHandler).SetHyperbridgeConfig-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/onchain-adapters/ccip-config --> pay-chain.backend/internal/interfaces/http/handlers.(*OnchainAdapterHandler).SetCCIPConfig-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/onchain-adapters/layerzero-config --> pay-chain.backend/internal/interfaces/http/handlers.(*OnchainAdapterHandler).SetLayerZeroConfig-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/contracts/config-check --> pay-chain.backend/internal/interfaces/http/handlers.(*ContractConfigAuditHandler).Check-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/contracts/:id/config-check --> pay-chain.backend/internal/interfaces/http/handlers.(*ContractConfigAuditHandler).CheckByContract-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/crosschain-config/overview --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainConfigHandler).Overview-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/crosschain-config/preflight --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainConfigHandler).Preflight-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/crosschain-config/recheck --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainConfigHandler).Recheck-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/crosschain-config/recheck-bulk --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainConfigHandler).RecheckBulk-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/crosschain-config/auto-fix --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainConfigHandler).AutoFix-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/crosschain-config/auto-fix-bulk --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainConfigHandler).AutoFixBulk-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/route-policies --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainPolicyHandler).ListRoutePolicies-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/route-policies --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainPolicyHandler).CreateRoutePolicy-fm (7 handlers)
[GIN-debug] PUT    /api/v1/admin/route-policies/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainPolicyHandler).UpdateRoutePolicy-fm (7 handlers)
[GIN-debug] DELETE /api/v1/admin/route-policies/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainPolicyHandler).DeleteRoutePolicy-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/layerzero-configs --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainPolicyHandler).ListLayerZeroConfigs-fm (7 handlers)
[GIN-debug] POST   /api/v1/admin/layerzero-configs --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainPolicyHandler).CreateLayerZeroConfig-fm (7 handlers)
[GIN-debug] PUT    /api/v1/admin/layerzero-configs/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainPolicyHandler).UpdateLayerZeroConfig-fm (7 handlers)
[GIN-debug] DELETE /api/v1/admin/layerzero-configs/:id --> pay-chain.backend/internal/interfaces/http/handlers.(*CrosschainPolicyHandler).DeleteLayerZeroConfig-fm (7 handlers)
[GIN-debug] GET    /api/v1/admin/diagnostics/route-error/:paymentId --> pay-chain.backend/internal/interfaces/http/handlers.(*RouteErrorHandler).GetRouteError-fm (7 handlers)
2026/02/18 18:06:01 ğŸ“‹ Registered Routes:
2026/02/18 18:06:01    GET /api/v1/admin/contracts/config-check
2026/02/18 18:06:01    GET /api/v1/admin/contracts/:id/config-check
2026/02/18 18:06:01    GET /api/v1/admin/crosschain-config/overview
2026/02/18 18:06:01    GET /api/v1/admin/crosschain-config/preflight
2026/02/18 18:06:01    GET /api/v1/admin/tokens
2026/02/18 18:06:01    GET /api/v1/admin/teams
2026/02/18 18:06:01    GET /api/v1/admin/rpcs
2026/02/18 18:06:01    GET /api/v1/admin/route-policies
2026/02/18 18:06:01    GET /api/v1/admin/users
2026/02/18 18:06:01    GET /api/v1/admin/merchants
2026/02/18 18:06:01    GET /api/v1/admin/stats
2026/02/18 18:06:01    GET /api/v1/admin/payment-bridges
2026/02/18 18:06:01    GET /api/v1/admin/bridge-configs
2026/02/18 18:06:01    GET /api/v1/admin/fee-configs
2026/02/18 18:06:01    GET /api/v1/admin/onchain-adapters/status
2026/02/18 18:06:01    GET /api/v1/admin/layerzero-configs
2026/02/18 18:06:01    GET /api/v1/admin/diagnostics/route-error/:paymentId
2026/02/18 18:06:01    GET /api/v1/auth/session-expiry
2026/02/18 18:06:01    GET /api/v1/auth/me
2026/02/18 18:06:01    GET /api/v1/api-keys
2026/02/18 18:06:01    GET /api/v1/payment-requests
2026/02/18 18:06:01    GET /api/v1/payment-requests/:id
2026/02/18 18:06:01    GET /api/v1/payment-bridges
2026/02/18 18:06:01    GET /api/v1/payment-app/diagnostics/route-error/:paymentId
2026/02/18 18:06:01    GET /api/v1/payments
2026/02/18 18:06:01    GET /api/v1/payments/:id
2026/02/18 18:06:01    GET /api/v1/payments/:id/events
2026/02/18 18:06:01    GET /api/v1/pay/:id
2026/02/18 18:06:01    GET /api/v1/contracts
2026/02/18 18:06:01    GET /api/v1/contracts/lookup
2026/02/18 18:06:01    GET /api/v1/contracts/:id
2026/02/18 18:06:01    GET /api/v1/chains
2026/02/18 18:06:01    GET /api/v1/tokens
2026/02/18 18:06:01    GET /api/v1/tokens/stablecoins
2026/02/18 18:06:01    GET /api/v1/teams
2026/02/18 18:06:01    GET /api/v1/wallets
2026/02/18 18:06:01    GET /api/v1/merchants/status
2026/02/18 18:06:01    GET /api/v1/bridge-configs
2026/02/18 18:06:01    GET /api/v1/fee-configs
2026/02/18 18:06:01    GET /health
2026/02/18 18:06:01    POST /api/v1/admin/onchain-adapters/register
2026/02/18 18:06:01    POST /api/v1/admin/onchain-adapters/default-bridge
2026/02/18 18:06:01    POST /api/v1/admin/onchain-adapters/hyperbridge-config
2026/02/18 18:06:01    POST /api/v1/admin/onchain-adapters/ccip-config
2026/02/18 18:06:01    POST /api/v1/admin/onchain-adapters/layerzero-config
2026/02/18 18:06:01    POST /api/v1/admin/crosschain-config/recheck
2026/02/18 18:06:01    POST /api/v1/admin/crosschain-config/recheck-bulk
2026/02/18 18:06:01    POST /api/v1/admin/crosschain-config/auto-fix
2026/02/18 18:06:01    POST /api/v1/admin/crosschain-config/auto-fix-bulk
2026/02/18 18:06:01    POST /api/v1/admin/chains
2026/02/18 18:06:01    POST /api/v1/admin/tokens
2026/02/18 18:06:01    POST /api/v1/admin/teams
2026/02/18 18:06:01    POST /api/v1/admin/payment-bridges
2026/02/18 18:06:01    POST /api/v1/admin/bridge-configs
2026/02/18 18:06:01    POST /api/v1/admin/fee-configs
2026/02/18 18:06:01    POST /api/v1/admin/route-policies
2026/02/18 18:06:01    POST /api/v1/admin/layerzero-configs
2026/02/18 18:06:01    POST /api/v1/auth/register
2026/02/18 18:06:01    POST /api/v1/auth/refresh
2026/02/18 18:06:01    POST /api/v1/auth/login
2026/02/18 18:06:01    POST /api/v1/auth/verify-email
2026/02/18 18:06:01    POST /api/v1/auth/change-password
2026/02/18 18:06:01    POST /api/v1/api-keys
2026/02/18 18:06:01    POST /api/v1/payment-requests
2026/02/18 18:06:01    POST /api/v1/payment-app
2026/02/18 18:06:01    POST /api/v1/payments
2026/02/18 18:06:01    POST /api/v1/wallets/connect
2026/02/18 18:06:01    POST /api/v1/webhooks/indexer
2026/02/18 18:06:01    POST /api/v1/merchants/apply
2026/02/18 18:06:01    POST /api/v1/contracts
2026/02/18 18:06:01    PUT /api/v1/admin/tokens/:id
2026/02/18 18:06:01    PUT /api/v1/admin/teams/:id
2026/02/18 18:06:01    PUT /api/v1/admin/merchants/:id/status
2026/02/18 18:06:01    PUT /api/v1/admin/chains/:id
2026/02/18 18:06:01    PUT /api/v1/admin/payment-bridges/:id
2026/02/18 18:06:01    PUT /api/v1/admin/bridge-configs/:id
2026/02/18 18:06:01    PUT /api/v1/admin/fee-configs/:id
2026/02/18 18:06:01    PUT /api/v1/admin/route-policies/:id
2026/02/18 18:06:01    PUT /api/v1/admin/layerzero-configs/:id
2026/02/18 18:06:01    PUT /api/v1/wallets/:id/primary
2026/02/18 18:06:01    PUT /api/v1/contracts/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/tokens/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/teams/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/chains/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/payment-bridges/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/bridge-configs/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/fee-configs/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/route-policies/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/layerzero-configs/:id
2026/02/18 18:06:01    DELETE /api/v1/api-keys/:id
2026/02/18 18:06:01    DELETE /api/v1/wallets/:id
2026/02/18 18:06:01    DELETE /api/v1/contracts/:id
2026/02/18 18:06:01 ğŸš€ Pay-Chain Backend starting on port 18080
2026/02/18 18:06:01 ğŸ“š API: http://localhost:18080/api/v1
2026/02/18 18:06:01 â¤ï¸ Health: http://localhost:18080/health
--- PASS: TestRunMainProcess_SuccessPath_WithDotenvLoadError (0.00s)
=== RUN   TestDefaultOpenDBAndRunServerWrappers_ExecuteBodies
2026/02/18 18:06:01 â¹ï¸ Payment request expiry job stopped (context cancelled)
[GIN-debug] [WARNING] Running in "debug" mode. Switch to "release" mode in production.
 - using env:	export GIN_MODE=release
 - using code:	gin.SetMode(gin.ReleaseMode)

[GIN-debug] [WARNING] You trusted all proxies, this is NOT safe. We recommend you to set a value.
Please check https://github.com/gin-gonic/gin/blob/master/docs/doc.md#dont-trust-all-proxies for details.
[GIN-debug] Listening and serving HTTP on :invalid-port
[GIN-debug] [ERROR] listen tcp: lookup tcp/invalid-port: unknown port
--- PASS: TestDefaultOpenDBAndRunServerWrappers_ExecuteBodies (0.02s)
=== RUN   TestRunMainProcess_ProductionModeAndPingWarnPath
2026-02-18T18:06:01.172+0700	[34mINFO[0m	server/main.go:66	Logger initialized	{"env": "production"}
2026-02-18T18:06:01.172+0700	[34mINFO[0m	server/main.go:73	Redis initialized
2026/02/18 18:06:01 âš ï¸ Database not available: sql: database is closed (endpoints will return errors)
2026/02/18 18:06:01 ğŸ• Starting payment request expiry job...
2026/02/18 18:06:01 ğŸ“‹ Registered Routes:
2026/02/18 18:06:01    GET /api/v1/admin/contracts/config-check
2026/02/18 18:06:01    GET /api/v1/admin/contracts/:id/config-check
2026/02/18 18:06:01    GET /api/v1/admin/crosschain-config/overview
2026/02/18 18:06:01    GET /api/v1/admin/crosschain-config/preflight
2026/02/18 18:06:01    GET /api/v1/admin/tokens
2026/02/18 18:06:01    GET /api/v1/admin/teams
2026/02/18 18:06:01    GET /api/v1/admin/rpcs
2026/02/18 18:06:01    GET /api/v1/admin/route-policies
2026/02/18 18:06:01    GET /api/v1/admin/users
2026/02/18 18:06:01    GET /api/v1/admin/merchants
2026/02/18 18:06:01    GET /api/v1/admin/stats
2026/02/18 18:06:01    GET /api/v1/admin/payment-bridges
2026/02/18 18:06:01    GET /api/v1/admin/bridge-configs
2026/02/18 18:06:01    GET /api/v1/admin/fee-configs
2026/02/18 18:06:01    GET /api/v1/admin/onchain-adapters/status
2026/02/18 18:06:01    GET /api/v1/admin/layerzero-configs
2026/02/18 18:06:01    GET /api/v1/admin/diagnostics/route-error/:paymentId
2026/02/18 18:06:01    GET /api/v1/auth/session-expiry
2026/02/18 18:06:01    GET /api/v1/auth/me
2026/02/18 18:06:01    GET /api/v1/api-keys
2026/02/18 18:06:01    GET /api/v1/payment-requests
2026/02/18 18:06:01    GET /api/v1/payment-requests/:id
2026/02/18 18:06:01    GET /api/v1/payment-bridges
2026/02/18 18:06:01    GET /api/v1/payment-app/diagnostics/route-error/:paymentId
2026/02/18 18:06:01    GET /api/v1/payments
2026/02/18 18:06:01    GET /api/v1/payments/:id
2026/02/18 18:06:01    GET /api/v1/payments/:id/events
2026/02/18 18:06:01    GET /api/v1/pay/:id
2026/02/18 18:06:01    GET /api/v1/contracts
2026/02/18 18:06:01    GET /api/v1/contracts/lookup
2026/02/18 18:06:01    GET /api/v1/contracts/:id
2026/02/18 18:06:01    GET /api/v1/chains
2026/02/18 18:06:01    GET /api/v1/tokens
2026/02/18 18:06:01    GET /api/v1/tokens/stablecoins
2026/02/18 18:06:01    GET /api/v1/teams
2026/02/18 18:06:01    GET /api/v1/wallets
2026/02/18 18:06:01    GET /api/v1/merchants/status
2026/02/18 18:06:01    GET /api/v1/bridge-configs
2026/02/18 18:06:01    GET /api/v1/fee-configs
2026/02/18 18:06:01    GET /health
2026/02/18 18:06:01    POST /api/v1/admin/onchain-adapters/register
2026/02/18 18:06:01    POST /api/v1/admin/onchain-adapters/default-bridge
2026/02/18 18:06:01    POST /api/v1/admin/onchain-adapters/hyperbridge-config
2026/02/18 18:06:01    POST /api/v1/admin/onchain-adapters/ccip-config
2026/02/18 18:06:01    POST /api/v1/admin/onchain-adapters/layerzero-config
2026/02/18 18:06:01    POST /api/v1/admin/crosschain-config/recheck
2026/02/18 18:06:01    POST /api/v1/admin/crosschain-config/recheck-bulk
2026/02/18 18:06:01    POST /api/v1/admin/crosschain-config/auto-fix
2026/02/18 18:06:01    POST /api/v1/admin/crosschain-config/auto-fix-bulk
2026/02/18 18:06:01    POST /api/v1/admin/chains
2026/02/18 18:06:01    POST /api/v1/admin/tokens
2026/02/18 18:06:01    POST /api/v1/admin/teams
2026/02/18 18:06:01    POST /api/v1/admin/payment-bridges
2026/02/18 18:06:01    POST /api/v1/admin/bridge-configs
2026/02/18 18:06:01    POST /api/v1/admin/fee-configs
2026/02/18 18:06:01    POST /api/v1/admin/route-policies
2026/02/18 18:06:01    POST /api/v1/admin/layerzero-configs
2026/02/18 18:06:01    POST /api/v1/auth/register
2026/02/18 18:06:01    POST /api/v1/auth/refresh
2026/02/18 18:06:01    POST /api/v1/auth/login
2026/02/18 18:06:01    POST /api/v1/auth/verify-email
2026/02/18 18:06:01    POST /api/v1/auth/change-password
2026/02/18 18:06:01    POST /api/v1/api-keys
2026/02/18 18:06:01    POST /api/v1/payment-requests
2026/02/18 18:06:01    POST /api/v1/payment-app
2026/02/18 18:06:01    POST /api/v1/payments
2026/02/18 18:06:01    POST /api/v1/wallets/connect
2026/02/18 18:06:01    POST /api/v1/webhooks/indexer
2026/02/18 18:06:01    POST /api/v1/merchants/apply
2026/02/18 18:06:01    POST /api/v1/contracts
2026/02/18 18:06:01    PUT /api/v1/admin/tokens/:id
2026/02/18 18:06:01    PUT /api/v1/admin/teams/:id
2026/02/18 18:06:01    PUT /api/v1/admin/merchants/:id/status
2026/02/18 18:06:01    PUT /api/v1/admin/chains/:id
2026/02/18 18:06:01    PUT /api/v1/admin/payment-bridges/:id
2026/02/18 18:06:01    PUT /api/v1/admin/bridge-configs/:id
2026/02/18 18:06:01    PUT /api/v1/admin/fee-configs/:id
2026/02/18 18:06:01    PUT /api/v1/admin/route-policies/:id
2026/02/18 18:06:01    PUT /api/v1/admin/layerzero-configs/:id
2026/02/18 18:06:01    PUT /api/v1/wallets/:id/primary
2026/02/18 18:06:01    PUT /api/v1/contracts/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/tokens/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/teams/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/chains/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/payment-bridges/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/bridge-configs/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/fee-configs/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/route-policies/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/layerzero-configs/:id
2026/02/18 18:06:01    DELETE /api/v1/api-keys/:id
2026/02/18 18:06:01    DELETE /api/v1/wallets/:id
2026/02/18 18:06:01    DELETE /api/v1/contracts/:id
2026/02/18 18:06:01 ğŸš€ Pay-Chain Backend starting on port 18080
2026/02/18 18:06:01 ğŸ“š API: http://localhost:18080/api/v1
2026/02/18 18:06:01 â¤ï¸ Health: http://localhost:18080/health
--- PASS: TestRunMainProcess_ProductionModeAndPingWarnPath (0.00s)
=== RUN   TestRunMainProcess_GracefulShutdownSignalBranch
2026-02-18T18:06:01.173+0700	[34mINFO[0m	server/main.go:66	Logger initialized	{"env": "development"}
2026/02/18 18:06:01 â¹ï¸ Payment request expiry job stopped (context cancelled)
2026-02-18T18:06:01.173+0700	[34mINFO[0m	server/main.go:73	Redis initialized
2026/02/18 18:06:01 âœ… Connected to PostgreSQL via GORM
2026/02/18 18:06:01 ğŸ• Starting payment request expiry job...
2026/02/18 18:06:01 ğŸ“‹ Registered Routes:
2026/02/18 18:06:01    GET /api/v1/admin/contracts/config-check
2026/02/18 18:06:01    GET /api/v1/admin/contracts/:id/config-check
2026/02/18 18:06:01    GET /api/v1/admin/crosschain-config/overview
2026/02/18 18:06:01    GET /api/v1/admin/crosschain-config/preflight
2026/02/18 18:06:01    GET /api/v1/admin/tokens
2026/02/18 18:06:01    GET /api/v1/admin/teams
2026/02/18 18:06:01    GET /api/v1/admin/rpcs
2026/02/18 18:06:01    GET /api/v1/admin/route-policies
2026/02/18 18:06:01    GET /api/v1/admin/users
2026/02/18 18:06:01    GET /api/v1/admin/merchants
2026/02/18 18:06:01    GET /api/v1/admin/stats
2026/02/18 18:06:01    GET /api/v1/admin/payment-bridges
2026/02/18 18:06:01    GET /api/v1/admin/bridge-configs
2026/02/18 18:06:01    GET /api/v1/admin/fee-configs
2026/02/18 18:06:01    GET /api/v1/admin/onchain-adapters/status
2026/02/18 18:06:01    GET /api/v1/admin/layerzero-configs
2026/02/18 18:06:01    GET /api/v1/admin/diagnostics/route-error/:paymentId
2026/02/18 18:06:01    GET /api/v1/auth/session-expiry
2026/02/18 18:06:01    GET /api/v1/auth/me
2026/02/18 18:06:01    GET /api/v1/api-keys
2026/02/18 18:06:01    GET /api/v1/payment-requests
2026/02/18 18:06:01    GET /api/v1/payment-requests/:id
2026/02/18 18:06:01    GET /api/v1/payment-bridges
2026/02/18 18:06:01    GET /api/v1/payment-app/diagnostics/route-error/:paymentId
2026/02/18 18:06:01    GET /api/v1/payments
2026/02/18 18:06:01    GET /api/v1/payments/:id
2026/02/18 18:06:01    GET /api/v1/payments/:id/events
2026/02/18 18:06:01    GET /api/v1/pay/:id
2026/02/18 18:06:01    GET /api/v1/contracts
2026/02/18 18:06:01    GET /api/v1/contracts/lookup
2026/02/18 18:06:01    GET /api/v1/contracts/:id
2026/02/18 18:06:01    GET /api/v1/chains
2026/02/18 18:06:01    GET /api/v1/tokens
2026/02/18 18:06:01    GET /api/v1/tokens/stablecoins
2026/02/18 18:06:01    GET /api/v1/teams
2026/02/18 18:06:01    GET /api/v1/wallets
2026/02/18 18:06:01    GET /api/v1/merchants/status
2026/02/18 18:06:01    GET /api/v1/bridge-configs
2026/02/18 18:06:01    GET /api/v1/fee-configs
2026/02/18 18:06:01    GET /health
2026/02/18 18:06:01    POST /api/v1/admin/onchain-adapters/register
2026/02/18 18:06:01    POST /api/v1/admin/onchain-adapters/default-bridge
2026/02/18 18:06:01    POST /api/v1/admin/onchain-adapters/hyperbridge-config
2026/02/18 18:06:01    POST /api/v1/admin/onchain-adapters/ccip-config
2026/02/18 18:06:01    POST /api/v1/admin/onchain-adapters/layerzero-config
2026/02/18 18:06:01    POST /api/v1/admin/crosschain-config/recheck
2026/02/18 18:06:01    POST /api/v1/admin/crosschain-config/recheck-bulk
2026/02/18 18:06:01    POST /api/v1/admin/crosschain-config/auto-fix
2026/02/18 18:06:01    POST /api/v1/admin/crosschain-config/auto-fix-bulk
2026/02/18 18:06:01    POST /api/v1/admin/chains
2026/02/18 18:06:01    POST /api/v1/admin/tokens
2026/02/18 18:06:01    POST /api/v1/admin/teams
2026/02/18 18:06:01    POST /api/v1/admin/payment-bridges
2026/02/18 18:06:01    POST /api/v1/admin/bridge-configs
2026/02/18 18:06:01    POST /api/v1/admin/fee-configs
2026/02/18 18:06:01    POST /api/v1/admin/route-policies
2026/02/18 18:06:01    POST /api/v1/admin/layerzero-configs
2026/02/18 18:06:01    POST /api/v1/auth/register
2026/02/18 18:06:01    POST /api/v1/auth/refresh
2026/02/18 18:06:01    POST /api/v1/auth/login
2026/02/18 18:06:01    POST /api/v1/auth/verify-email
2026/02/18 18:06:01    POST /api/v1/auth/change-password
2026/02/18 18:06:01    POST /api/v1/api-keys
2026/02/18 18:06:01    POST /api/v1/payment-requests
2026/02/18 18:06:01    POST /api/v1/payment-app
2026/02/18 18:06:01    POST /api/v1/payments
2026/02/18 18:06:01    POST /api/v1/wallets/connect
2026/02/18 18:06:01    POST /api/v1/webhooks/indexer
2026/02/18 18:06:01    POST /api/v1/merchants/apply
2026/02/18 18:06:01    POST /api/v1/contracts
2026/02/18 18:06:01    PUT /api/v1/admin/tokens/:id
2026/02/18 18:06:01    PUT /api/v1/admin/teams/:id
2026/02/18 18:06:01    PUT /api/v1/admin/merchants/:id/status
2026/02/18 18:06:01    PUT /api/v1/admin/chains/:id
2026/02/18 18:06:01    PUT /api/v1/admin/payment-bridges/:id
2026/02/18 18:06:01    PUT /api/v1/admin/bridge-configs/:id
2026/02/18 18:06:01    PUT /api/v1/admin/fee-configs/:id
2026/02/18 18:06:01    PUT /api/v1/admin/route-policies/:id
2026/02/18 18:06:01    PUT /api/v1/admin/layerzero-configs/:id
2026/02/18 18:06:01    PUT /api/v1/wallets/:id/primary
2026/02/18 18:06:01    PUT /api/v1/contracts/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/tokens/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/teams/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/chains/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/payment-bridges/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/bridge-configs/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/fee-configs/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/route-policies/:id
2026/02/18 18:06:01    DELETE /api/v1/admin/layerzero-configs/:id
2026/02/18 18:06:01    DELETE /api/v1/api-keys/:id
2026/02/18 18:06:01    DELETE /api/v1/wallets/:id
2026/02/18 18:06:01    DELETE /api/v1/contracts/:id
2026/02/18 18:06:01 ğŸš€ Pay-Chain Backend starting on port 18080
2026/02/18 18:06:01 ğŸ“š API: http://localhost:18080/api/v1
2026/02/18 18:06:01 â¤ï¸ Health: http://localhost:18080/health
2026/02/18 18:06:01 ğŸ›‘ Shutting down server...
2026/02/18 18:06:01 ğŸ›‘ Shutting down server...
2026/02/18 18:06:01 ğŸ›‘ Shutting down server...
2026/02/18 18:06:01 ğŸ›‘ Shutting down server...
2026/02/18 18:06:01 ğŸ›‘ Shutting down server...
2026/02/18 18:06:01 â¹ï¸ Payment request expiry job stopped
--- PASS: TestRunMainProcess_GracefulShutdownSignalBranch (0.05s)
=== RUN   TestRunMainProcess_GetStdDBError
2026-02-18T18:06:01.225+0700	[34mINFO[0m	server/main.go:66	Logger initialized	{"env": "development"}
2026-02-18T18:06:01.225+0700	[34mINFO[0m	server/main.go:73	Redis initialized
--- PASS: TestRunMainProcess_GetStdDBError (0.00s)
=== RUN   TestApplyCORSMiddleware
--- PASS: TestApplyCORSMiddleware (0.00s)
=== RUN   TestRegisterHealthRoute
--- PASS: TestRegisterHealthRoute (0.00s)
=== RUN   TestRegisterAPIV1Routes_RegistersKeyRoutes
--- PASS: TestRegisterAPIV1Routes_RegistersKeyRoutes (0.00s)
=== RUN   TestRegisterAPIV1Routes_RouteResponds
--- PASS: TestRegisterAPIV1Routes_RouteResponds (0.00s)
PASS
ok  	pay-chain.backend/cmd/server	(cached)
=== RUN   TestDatabaseConfig_URL
--- PASS: TestDatabaseConfig_URL (0.00s)
=== RUN   TestLoad_ConfigFromEnv
--- PASS: TestLoad_ConfigFromEnv (0.00s)
=== RUN   TestLoad_ConfigFallbacks
--- PASS: TestLoad_ConfigFallbacks (0.00s)
PASS
ok  	pay-chain.backend/internal/config	(cached)
=== RUN   TestChain_GetCAIP2ID
--- PASS: TestChain_GetCAIP2ID (0.00s)
=== RUN   TestNormalizeChainID
=== RUN   TestNormalizeChainID/evm_caip2
    chain_test.go:46: expected "eip155:8453" got "8453"
=== RUN   TestNormalizeChainID/solana_caip2
    chain_test.go:46: expected "solana:devnet" got "devnet"
=== RUN   TestNormalizeChainID/trimmed_raw
=== RUN   TestNormalizeChainID/empty
--- FAIL: TestNormalizeChainID (0.00s)
    --- FAIL: TestNormalizeChainID/evm_caip2 (0.00s)
    --- FAIL: TestNormalizeChainID/solana_caip2 (0.00s)
    --- PASS: TestNormalizeChainID/trimmed_raw (0.00s)
    --- PASS: TestNormalizeChainID/empty (0.00s)
FAIL
FAIL	pay-chain.backend/internal/domain/entities	0.295s
=== RUN   TestAppError_Constructors
--- PASS: TestAppError_Constructors (0.00s)
PASS
ok  	pay-chain.backend/internal/domain/errors	(cached)
?   	pay-chain.backend/internal/domain/repositories	[no test files]
=== RUN   TestNewClientFactory_InitializesMaps
--- PASS: TestNewClientFactory_InitializesMaps (0.00s)
=== RUN   TestClientFactory_GetEVMClient_InvalidURL
--- PASS: TestClientFactory_GetEVMClient_InvalidURL (0.00s)
=== RUN   TestEVMClient_ChainIDAccessor
--- PASS: TestEVMClient_ChainIDAccessor (0.00s)
=== RUN   TestNewEVMClient_InvalidURL
--- PASS: TestNewEVMClient_InvalidURL (0.00s)
=== RUN   TestClientFactory_RegisterEVMClient
--- PASS: TestClientFactory_RegisterEVMClient (0.00s)
=== RUN   TestClientFactory_GetEVMClient_DoubleCheckBranchViaHook
--- PASS: TestClientFactory_GetEVMClient_DoubleCheckBranchViaHook (0.00s)
=== RUN   TestClientFactory_GetEVMClient_NewClientSuccessPath
--- PASS: TestClientFactory_GetEVMClient_NewClientSuccessPath (0.00s)
=== RUN   TestNewEVMClientWithCallView_DefaultChainIDAndCall
--- PASS: TestNewEVMClientWithCallView_DefaultChainIDAndCall (0.00s)
=== RUN   TestEVMClient_Methods_PanicWhenClientNil
--- PASS: TestEVMClient_Methods_PanicWhenClientNil (0.00s)
=== RUN   TestEVMClient_Methods_WithMockRPC
--- PASS: TestEVMClient_Methods_WithMockRPC (0.01s)
=== RUN   TestClientFactory_GetEVMClient_CachePath
--- PASS: TestClientFactory_GetEVMClient_CachePath (0.00s)
=== RUN   TestClientFactory_GetEVMClient_DoubleCheckPath
--- PASS: TestClientFactory_GetEVMClient_DoubleCheckPath (0.00s)
=== RUN   TestNewEVMClient_ErrorBranches
=== RUN   TestNewEVMClient_ErrorBranches/dial_failure
=== RUN   TestNewEVMClient_ErrorBranches/chain_id_failure
=== RUN   TestNewEVMClient_ErrorBranches/success_via_hooks
--- PASS: TestNewEVMClient_ErrorBranches (0.00s)
    --- PASS: TestNewEVMClient_ErrorBranches/dial_failure (0.00s)
    --- PASS: TestNewEVMClient_ErrorBranches/chain_id_failure (0.00s)
    --- PASS: TestNewEVMClient_ErrorBranches/success_via_hooks (0.00s)
=== RUN   TestEVMClient_Close_WithNilClient
--- PASS: TestEVMClient_Close_WithNilClient (0.00s)
=== RUN   TestEVMClient_Close_WithNonNilClient
--- PASS: TestEVMClient_Close_WithNonNilClient (0.00s)
=== RUN   TestEVMClient_GetTokenBalance_CallError
--- PASS: TestEVMClient_GetTokenBalance_CallError (0.00s)
=== RUN   TestEVMClient_GetTokenBalance_SuccessViaCallContractHook
--- PASS: TestEVMClient_GetTokenBalance_SuccessViaCallContractHook (0.00s)
=== RUN   TestEVMClient_DefaultHookBodies_AreReachable
--- PASS: TestEVMClient_DefaultHookBodies_AreReachable (0.00s)
PASS
ok  	pay-chain.backend/internal/infrastructure/blockchain	(cached)
=== RUN   TestNewConnection_PingFailure
--- PASS: TestNewConnection_PingFailure (0.00s)
=== RUN   TestNewConnection_OpenAndPingHooks
--- PASS: TestNewConnection_OpenAndPingHooks (0.00s)
PASS
ok  	pay-chain.backend/internal/infrastructure/datasources/postgres	(cached)
=== RUN   TestNewPaymentRequestExpiryJob
--- PASS: TestNewPaymentRequestExpiryJob (0.00s)
=== RUN   TestProcessExpiredRequests_NoItems
--- PASS: TestProcessExpiredRequests_NoItems (0.00s)
=== RUN   TestProcessExpiredRequests_Success
2026/02/18 18:05:59 ğŸ”„ Processing 2 expired payment requests...
2026/02/18 18:05:59 âœ… Expired 2 payment requests
--- PASS: TestProcessExpiredRequests_Success (0.00s)
=== RUN   TestProcessExpiredRequests_GetError
2026/02/18 18:05:59 âŒ Error fetching expired payment requests: db down
--- PASS: TestProcessExpiredRequests_GetError (0.00s)
=== RUN   TestProcessExpiredRequests_ExpireError
2026/02/18 18:05:59 ğŸ”„ Processing 1 expired payment requests...
2026/02/18 18:05:59 âŒ Error expiring payment requests: update failed
--- PASS: TestProcessExpiredRequests_ExpireError (0.00s)
=== RUN   TestStartStop_StopsByContext
2026/02/18 18:05:59 ğŸ• Starting payment request expiry job...
2026/02/18 18:05:59 â¹ï¸ Payment request expiry job stopped (context cancelled)
--- PASS: TestStartStop_StopsByContext (0.00s)
=== RUN   TestStartStop_StopsByStopChannel
2026/02/18 18:05:59 ğŸ• Starting payment request expiry job...
2026/02/18 18:05:59 â¹ï¸ Payment request expiry job stopped
--- PASS: TestStartStop_StopsByStopChannel (0.00s)
=== RUN   TestStartStop_TickerTriggersProcessingBeforeStop
2026/02/18 18:05:59 ğŸ• Starting payment request expiry job...
2026/02/18 18:05:59 ğŸ”„ Processing 1 expired payment requests...
2026/02/18 18:05:59 âœ… Expired 1 payment requests
2026/02/18 18:05:59 ğŸ”„ Processing 1 expired payment requests...
2026/02/18 18:05:59 âœ… Expired 1 payment requests
2026/02/18 18:05:59 â¹ï¸ Payment request expiry job stopped
--- PASS: TestStartStop_TickerTriggersProcessingBeforeStop (0.01s)
PASS
ok  	pay-chain.backend/internal/infrastructure/jobs	(cached)
=== RUN   TestTableNames
--- PASS: TestTableNames (0.00s)
PASS
ok  	pay-chain.backend/internal/infrastructure/models	(cached)
=== RUN   TestApiKeyRepository_CRUDAndFinders

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/api_key_repo_impl.go:61 [35;1mrecord not found
[0m[33m[0.027ms] [34;1m[rows:0][0m SELECT * FROM `api_keys` WHERE id = "ddb8b14a-4bdc-4bd7-94b0-66eae25a02eb" AND `api_keys`.`deleted_at` IS NULL ORDER BY `api_keys`.`id` LIMIT 1
--- PASS: TestApiKeyRepository_CRUDAndFinders (0.00s)
=== RUN   TestApiKeyRepository_NotFoundBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/api_key_repo_impl.go:61 [35;1mrecord not found
[0m[33m[0.229ms] [34;1m[rows:0][0m SELECT * FROM `api_keys` WHERE id = "2c9ed344-7a7b-4458-a622-096deccf6d3d" AND `api_keys`.`deleted_at` IS NULL ORDER BY `api_keys`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/api_key_repo_impl.go:36 [35;1mrecord not found
[0m[33m[0.027ms] [34;1m[rows:0][0m SELECT * FROM `api_keys` WHERE key_hash = "missing" AND `api_keys`.`deleted_at` IS NULL ORDER BY `api_keys`.`id` LIMIT 1
--- PASS: TestApiKeyRepository_NotFoundBranches (0.00s)
=== RUN   TestApiKeyRepository_DBErrorBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/api_key_repo_impl.go:26 [35;1mno such table: api_keys
[0m[33m[0.201ms] [34;1m[rows:0][0m INSERT INTO `api_keys` (`user_id`,`name`,`key_prefix`,`key_hash`,`secret_encrypted`,`secret_masked`,`permissions`,`is_active`,`last_used_at`,`expires_at`,`created_at`,`updated_at`,`deleted_at`,`id`) VALUES ("bd0e3810-6a33-40b5-b5b6-a30487f9e304","default","pk","hash","enc","mask","[""read""]",true,NULL,NULL,"2026-02-18 18:01:08.438","2026-02-18 18:01:08.438",NULL,"c242ea66-8ecf-4218-9261-8369d8672b2f") RETURNING `id`

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/api_key_repo_impl.go:36 [35;1mno such table: api_keys
[0m[33m[0.019ms] [34;1m[rows:0][0m SELECT * FROM `api_keys` WHERE key_hash = "hash" AND `api_keys`.`deleted_at` IS NULL ORDER BY `api_keys`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/api_key_repo_impl.go:47 [35;1mno such table: api_keys
[0m[33m[0.010ms] [34;1m[rows:0][0m SELECT * FROM `api_keys` WHERE user_id = "b3dbbd2e-deb3-4dea-9ffd-f2de12cde0c8" AND `api_keys`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/api_key_repo_impl.go:61 [35;1mno such table: api_keys
[0m[33m[0.013ms] [34;1m[rows:0][0m SELECT * FROM `api_keys` WHERE id = "7f903028-425c-4100-a769-9331214f8582" AND `api_keys`.`deleted_at` IS NULL ORDER BY `api_keys`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/api_key_repo_impl.go:72 [35;1mno such table: api_keys
[0m[33m[0.039ms] [34;1m[rows:0][0m UPDATE `api_keys` SET `is_active`=true,`last_used_at`=NULL,`name`="default",`permissions`="[""read""]",`secret_encrypted`="enc",`secret_masked`="mask",`updated_at`="2026-02-18 18:01:08.439" WHERE id = "f4475c00-4031-4dc5-9ee8-8e5e25a4b560" AND `api_keys`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/api_key_repo_impl.go:91 [35;1mno such table: api_keys
[0m[33m[0.026ms] [34;1m[rows:0][0m UPDATE `api_keys` SET `deleted_at`="2026-02-18 18:01:08.439" WHERE id = "13b68041-ae5a-496e-ac04-8f56fef6d7f6" AND `api_keys`.`deleted_at` IS NULL
--- PASS: TestApiKeyRepository_DBErrorBranches (0.00s)
=== RUN   TestBridgeConfigRepository_CRUDAndNotFound

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/bridge_config_repo_impl.go:31 [35;1mrecord not found
[0m[33m[0.030ms] [34;1m[rows:0][0m SELECT * FROM `bridge_configs` WHERE (source_chain_id = "5456f17d-13b6-4d3a-8768-9bf45e95f743" AND dest_chain_id = "23913ff1-8a01-45d8-9ed2-22421163c291" AND is_active = true) AND `bridge_configs`.`deleted_at` IS NULL ORDER BY updated_at DESC,`bridge_configs`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/bridge_config_repo_impl.go:52 [35;1mrecord not found
[0m[33m[0.022ms] [34;1m[rows:0][0m SELECT * FROM `bridge_configs` WHERE id = "4675bb29-41d3-4f0c-9d5b-a6dcf8e98165" AND `bridge_configs`.`deleted_at` IS NULL ORDER BY `bridge_configs`.`id` LIMIT 1
--- PASS: TestBridgeConfigRepository_CRUDAndNotFound (0.00s)
=== RUN   TestBridgeConfigRepository_Create_AssignsIDWhenNil
--- PASS: TestBridgeConfigRepository_Create_AssignsIDWhenNil (0.00s)
=== RUN   TestFeeConfigRepository_CRUDAndNotFound

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/fee_config_repo_impl.go:43 [35;1mrecord not found
[0m[33m[0.024ms] [34;1m[rows:0][0m SELECT * FROM `fee_configs` WHERE id = "beb37131-72ff-41fc-8caa-ca9723342b5c" AND `fee_configs`.`deleted_at` IS NULL ORDER BY `fee_configs`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/fee_config_repo_impl.go:30 [35;1mrecord not found
[0m[33m[0.032ms] [34;1m[rows:0][0m SELECT * FROM `fee_configs` WHERE (chain_id = "20224c1d-c08d-4bdc-95e0-01c7c3605c24" AND token_id = "1bcdd0f6-3d7e-4361-97d9-001ff6775a21") AND `fee_configs`.`deleted_at` IS NULL ORDER BY updated_at DESC,`fee_configs`.`id` LIMIT 1
--- PASS: TestFeeConfigRepository_CRUDAndNotFound (0.00s)
=== RUN   TestFeeConfigRepository_Create_AssignsIDWhenNil
--- PASS: TestFeeConfigRepository_Create_AssignsIDWhenNil (0.00s)
=== RUN   TestBridgeAndFeeConfigRepository_DBErrorBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/bridge_config_repo_impl.go:52 [35;1mno such table: bridge_configs
[0m[33m[0.101ms] [34;1m[rows:0][0m SELECT * FROM `bridge_configs` WHERE id = "b66e4436-089c-4ab4-8718-70c15b28eb47" AND `bridge_configs`.`deleted_at` IS NULL ORDER BY `bridge_configs`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/bridge_config_repo_impl.go:31 [35;1mno such table: bridge_configs
[0m[33m[0.015ms] [34;1m[rows:0][0m SELECT * FROM `bridge_configs` WHERE (source_chain_id = "2377331a-2a18-478a-b1c3-8d1f661a3ee0" AND dest_chain_id = "c5c56f37-e229-4078-97ce-e6cf585068f4" AND is_active = true) AND `bridge_configs`.`deleted_at` IS NULL ORDER BY updated_at DESC,`bridge_configs`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/bridge_config_repo_impl.go:82 [35;1mno such table: bridge_configs
[0m[33m[0.007ms] [34;1m[rows:0][0m SELECT count(*) FROM `bridge_configs` WHERE `bridge_configs`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/bridge_config_repo_impl.go:127 [35;1mno such table: bridge_configs
[0m[33m[0.026ms] [34;1m[rows:0][0m UPDATE `bridge_configs` SET `bridge_id`="00000000-0000-0000-0000-000000000000",`config`="",`dest_chain_id`="00000000-0000-0000-0000-000000000000",`fee_percentage`="",`is_active`=false,`router_address`="",`source_chain_id`="00000000-0000-0000-0000-000000000000",`updated_at`="2026-02-18 18:01:08.443" WHERE id = "0f2b0aa5-7fed-40c5-b753-1b6d499d993f" AND `bridge_configs`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/bridge_config_repo_impl.go:147 [35;1mno such table: bridge_configs
[0m[33m[0.068ms] [34;1m[rows:0][0m UPDATE `bridge_configs` SET `deleted_at`="2026-02-18 18:01:08.443" WHERE id = "6255d52d-1b9e-48e1-95da-8d48cdf712fd" AND `bridge_configs`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/fee_config_repo_impl.go:43 [35;1mno such table: fee_configs
[0m[33m[0.092ms] [34;1m[rows:0][0m SELECT * FROM `fee_configs` WHERE id = "41d04b70-d5ed-4e57-9dbb-3489833ad23a" AND `fee_configs`.`deleted_at` IS NULL ORDER BY `fee_configs`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/fee_config_repo_impl.go:30 [35;1mno such table: fee_configs
[0m[33m[0.012ms] [34;1m[rows:0][0m SELECT * FROM `fee_configs` WHERE (chain_id = "c0fe3c72-e0bd-4b8d-bc7e-74546a278ae6" AND token_id = "138b84a0-3aaf-472c-80c6-f88d1fd4a3e1") AND `fee_configs`.`deleted_at` IS NULL ORDER BY updated_at DESC,`fee_configs`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/fee_config_repo_impl.go:65 [35;1mno such table: fee_configs
[0m[33m[0.007ms] [34;1m[rows:0][0m SELECT count(*) FROM `fee_configs` WHERE `fee_configs`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/fee_config_repo_impl.go:105 [35;1mno such table: fee_configs
[0m[33m[0.034ms] [34;1m[rows:0][0m UPDATE `fee_configs` SET `chain_id`="00000000-0000-0000-0000-000000000000",`fixed_base_fee`="",`max_fee`=NULL,`min_fee`="",`platform_fee_percent`="",`token_id`="00000000-0000-0000-0000-000000000000",`updated_at`="2026-02-18 18:01:08.443" WHERE id = "4835cf84-decb-4714-b3b2-50f019319a2d" AND `fee_configs`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/fee_config_repo_impl.go:124 [35;1mno such table: fee_configs
[0m[33m[0.028ms] [34;1m[rows:0][0m UPDATE `fee_configs` SET `deleted_at`="2026-02-18 18:01:08.443" WHERE id = "94e075b8-e5df-4a05-b258-f5a1a3f6410b" AND `fee_configs`.`deleted_at` IS NULL
--- PASS: TestBridgeAndFeeConfigRepository_DBErrorBranches (0.00s)
=== RUN   TestChainRepo_ToEntity_ToRpcEntity_AndNamespace
--- PASS: TestChainRepo_ToEntity_ToRpcEntity_AndNamespace (0.00s)
=== RUN   TestChainRepo_GetByCAIP2_Branches
=== RUN   TestChainRepo_GetByCAIP2_Branches/invalid_input
=== RUN   TestChainRepo_GetByCAIP2_Branches/fallback_by_reference
=== RUN   TestChainRepo_GetByCAIP2_Branches/not_found_malformed_caip2

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/chain_repo_impl.go:76 [35;1mrecord not found
[0m[33m[0.029ms] [34;1m[rows:0][0m SELECT * FROM `chains` WHERE chain_id = "999999" AND `chains`.`deleted_at` IS NULL ORDER BY `chains`.`id` LIMIT 1
=== RUN   TestChainRepo_GetByCAIP2_Branches/not_found_valid_caip2
--- PASS: TestChainRepo_GetByCAIP2_Branches (0.00s)
    --- PASS: TestChainRepo_GetByCAIP2_Branches/invalid_input (0.00s)
    --- PASS: TestChainRepo_GetByCAIP2_Branches/fallback_by_reference (0.00s)
    --- PASS: TestChainRepo_GetByCAIP2_Branches/not_found_malformed_caip2 (0.00s)
    --- PASS: TestChainRepo_GetByCAIP2_Branches/not_found_valid_caip2 (0.00s)
=== RUN   TestChainRepository_BasicCRUD

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/chain_repo_impl.go:30 [35;1mrecord not found
[0m[33m[0.019ms] [34;1m[rows:0][0m SELECT * FROM `chains` WHERE id = "42367393-b0a1-404a-a9fe-7820d3529e67" AND `chains`.`deleted_at` IS NULL ORDER BY `chains`.`id` LIMIT 1
--- PASS: TestChainRepository_BasicCRUD (0.00s)
=== RUN   TestChainRepository_NotFoundAndInvalidBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/chain_repo_impl.go:30 [35;1mrecord not found
[0m[33m[0.134ms] [34;1m[rows:0][0m SELECT * FROM `chains` WHERE id = "bfca6f9a-4282-4de0-96c5-edd4c08fe230" AND `chains`.`deleted_at` IS NULL ORDER BY `chains`.`id` LIMIT 1
--- PASS: TestChainRepository_NotFoundAndInvalidBranches (0.00s)
=== RUN   TestChainRepository_GetByCAIP2_DirectAndMalformedBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/chain_repo_impl.go:76 [35;1mrecord not found
[0m[33m[0.017ms] [34;1m[rows:0][0m SELECT * FROM `chains` WHERE chain_id = "eip155-8453" AND `chains`.`deleted_at` IS NULL ORDER BY `chains`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/chain_repo_impl.go:76 [35;1mrecord not found
[0m[33m[0.021ms] [34;1m[rows:0][0m SELECT * FROM `chains` WHERE chain_id = "eip155:" AND `chains`.`deleted_at` IS NULL ORDER BY `chains`.`id` LIMIT 1
--- PASS: TestChainRepository_GetByCAIP2_DirectAndMalformedBranches (0.00s)
=== RUN   TestChainRepository_NormalizeOnCreateUpdateAndLookup
--- PASS: TestChainRepository_NormalizeOnCreateUpdateAndLookup (0.00s)
=== RUN   TestChainRepository_GetAllRPCs

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/chain_repo_impl.go:137 [35;1mnear "ILIKE": syntax error
[0m[33m[0.045ms] [34;1m[rows:0][0m SELECT count(*) FROM `chain_rpcs` WHERE chain_id = "f48c2332-31c5-4642-a22e-22f1e99a74af" AND is_active = true AND url ILIKE "%rpc.local%" AND `chain_rpcs`.`deleted_at` IS NULL
--- PASS: TestChainRepository_GetAllRPCs (0.00s)
=== RUN   TestChainRepository_Query_DBErrorBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/chain_repo_impl.go:105 [35;1mno such table: chains
[0m[33m[0.191ms] [34;1m[rows:0][0m SELECT * FROM `chains` WHERE `chains`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/chain_repo_impl.go:169 [35;1mno such table: chains
[0m[33m[0.010ms] [34;1m[rows:0][0m SELECT count(*) FROM `chains` WHERE is_active = true AND `chains`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/chain_repo_impl.go:137 [35;1mno such table: chain_rpcs
[0m[33m[0.007ms] [34;1m[rows:0][0m SELECT count(*) FROM `chain_rpcs` WHERE `chain_rpcs`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/chain_repo_impl.go:30 [35;1mno such table: chains
[0m[33m[0.010ms] [34;1m[rows:0][0m SELECT * FROM `chains` WHERE id = "91b2bd41-6f0e-4159-b999-17a5d14cdd80" AND `chains`.`deleted_at` IS NULL ORDER BY `chains`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/chain_repo_impl.go:53 [35;1mno such table: chains
[0m[33m[0.008ms] [34;1m[rows:0][0m SELECT * FROM `chains` WHERE chain_id IN ("8453") AND `chains`.`deleted_at` IS NULL LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/chain_repo_impl.go:85 [35;1mno such table: chains
[0m[33m[0.006ms] [34;1m[rows:0][0m SELECT * FROM `chains` WHERE chain_id = "8453" AND `chains`.`deleted_at` IS NULL LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/chain_repo_impl.go:243 [35;1mno such table: chains
[0m[33m[0.029ms] [34;1m[rows:0][0m UPDATE `chains` SET `deleted_at`="2026-02-18 18:01:08.448" WHERE id = "173c3626-c406-4db0-be5a-58247c27660a" AND `chains`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/chain_repo_impl.go:231 [35;1mno such table: chains
[0m[33m[0.040ms] [34;1m[rows:0][0m UPDATE `chains` SET `chain_id`="8453",`currency_symbol`="",`explorer_url`="",`image_url`="",`is_active`=false,`name`="Base",`rpc_url`="",`type`="EVM",`updated_at`="2026-02-18 18:01:08.448" WHERE id = "1606e667-cd8a-445f-8617-2487bc2100ba" AND `chains`.`deleted_at` IS NULL
--- PASS: TestChainRepository_Query_DBErrorBranches (0.00s)
=== RUN   TestChainRepository_GetActive_FindErrorAfterCount

2026/02/18 18:01:08 [34;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/chain_repo_impl_test.go:228
[0m[35m[warn] [0mremoving callback `test:chain_getactive_find_error` from /Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/chain_repo_impl_test.go:228
--- PASS: TestChainRepository_GetActive_FindErrorAfterCount (0.00s)
=== RUN   TestChainRepository_GetByCAIP2_FallbackQueryError

2026/02/18 18:01:08 [34;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/chain_repo_impl_test.go:250
[0m[35m[warn] [0mremoving callback `test:chain_getbycaip2_fallback_error` from /Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/chain_repo_impl_test.go:250
--- PASS: TestChainRepository_GetByCAIP2_FallbackQueryError (0.00s)
=== RUN   TestChainRepository_GetAllRPCs_WithoutOptionalFilters
--- PASS: TestChainRepository_GetAllRPCs_WithoutOptionalFilters (0.00s)
=== RUN   TestChainRepository_GetAllRPCs_FindErrorAfterCount

2026/02/18 18:01:08 [34;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/chain_repo_impl_test.go:297
[0m[35m[warn] [0mremoving callback `test:chain_getallrpcs_find_error_after_count` from /Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/chain_repo_impl_test.go:297
--- PASS: TestChainRepository_GetAllRPCs_FindErrorAfterCount (0.00s)
=== RUN   TestEmailVerificationRepository_CRUDLikeFlow

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/user_repo_impl.go:207 [35;1mrecord not found
[0m[33m[0.036ms] [34;1m[rows:0][0m SELECT `users`.`id`,`users`.`email`,`users`.`name`,`users`.`password_hash`,`users`.`role`,`users`.`kyc_status`,`users`.`kyc_verified_at`,`users`.`created_at`,`users`.`updated_at`,`users`.`deleted_at` FROM `users` JOIN email_verifications ev ON ev.user_id = users.id WHERE (ev.token = "token-1" AND ev.expires_at > "2026-02-18 18:01:08.451" AND ev.verified_at IS NULL AND ev.deleted_at IS NULL) AND `users`.`deleted_at` IS NULL ORDER BY `users`.`id` LIMIT 1
--- PASS: TestEmailVerificationRepository_CRUDLikeFlow (0.00s)
=== RUN   TestEmailVerificationRepository_DBErrorBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/user_repo_impl.go:193 [35;1mno such table: email_verifications
[0m[33m[0.248ms] [34;1m[rows:0][0m INSERT INTO `email_verifications` (`user_id`,`token`,`expires_at`,`verified_at`,`created_at`,`deleted_at`,`id`) VALUES ("41b6da94-ca10-4af3-9207-63641ad51ad3","token","2026-02-19 18:01:08.451",NULL,"2026-02-18 18:01:08.451",NULL,"019c7069-32e3-7dfa-96cf-7b26c682ba74") RETURNING `id`

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/user_repo_impl.go:207 [35;1mno such table: users
[0m[33m[0.031ms] [34;1m[rows:0][0m SELECT `users`.`id`,`users`.`email`,`users`.`name`,`users`.`password_hash`,`users`.`role`,`users`.`kyc_status`,`users`.`kyc_verified_at`,`users`.`created_at`,`users`.`updated_at`,`users`.`deleted_at` FROM `users` JOIN email_verifications ev ON ev.user_id = users.id WHERE (ev.token = "token" AND ev.expires_at > "2026-02-18 18:01:08.452" AND ev.verified_at IS NULL AND ev.deleted_at IS NULL) AND `users`.`deleted_at` IS NULL ORDER BY `users`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/user_repo_impl.go:238 [35;1mno such table: email_verifications
[0m[33m[0.030ms] [34;1m[rows:0][0m UPDATE `email_verifications` SET `verified_at`="2026-02-18 18:01:08.452" WHERE (token = "token" AND verified_at IS NULL) AND `email_verifications`.`deleted_at` IS NULL
--- PASS: TestEmailVerificationRepository_DBErrorBranches (0.00s)
=== RUN   TestLayerZeroConfigRepo_CRUDAndList

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/layerzero_config_repo_impl.go:28 [35;1mrecord not found
[0m[33m[0.016ms] [34;1m[rows:0][0m SELECT * FROM `layerzero_configs` WHERE id = "4aae3eb6-8dcf-4028-b264-62a0ce266f6b" AND `layerzero_configs`.`deleted_at` IS NULL ORDER BY `layerzero_configs`.`id` LIMIT 1
--- PASS: TestLayerZeroConfigRepo_CRUDAndList (0.00s)
=== RUN   TestLayerZeroConfigRepo_NotFoundBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/layerzero_config_repo_impl.go:28 [35;1mrecord not found
[0m[33m[0.049ms] [34;1m[rows:0][0m SELECT * FROM `layerzero_configs` WHERE id = "f47a8e54-1704-4ec0-9243-f2a2c9431096" AND `layerzero_configs`.`deleted_at` IS NULL ORDER BY `layerzero_configs`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/layerzero_config_repo_impl.go:43 [35;1mrecord not found
[0m[33m[0.030ms] [34;1m[rows:0][0m SELECT * FROM `layerzero_configs` WHERE (source_chain_id = "1dfe1fc9-d028-4bb7-8969-34cc90fdb9a5" AND dest_chain_id = "8b8abfca-fd06-4e95-9f63-a8c85d496bb8") AND `layerzero_configs`.`deleted_at` IS NULL ORDER BY updated_at DESC,`layerzero_configs`.`id` LIMIT 1
--- PASS: TestLayerZeroConfigRepo_NotFoundBranches (0.00s)
=== RUN   TestLayerZeroConfigRepo_DBErrorBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/layerzero_config_repo_impl.go:106 [35;1mno such table: layerzero_configs
[0m[33m[0.058ms] [34;1m[rows:0][0m INSERT INTO `layerzero_configs` (`source_chain_id`,`dest_chain_id`,`dst_e_id`,`peer_hex`,`options_hex`,`is_active`,`created_at`,`updated_at`,`deleted_at`,`id`) VALUES ("41dd206c-2548-415e-97ce-e8f85f0c4c36","e074ecc2-5ac9-4e90-80fc-49e3f23e441e",1,"0xpeer","0x",true,"2026-02-18 18:01:08.453","2026-02-18 18:01:08.453",NULL,"af99e29a-92c5-4ee8-88a8-446350be12d5") RETURNING `id`

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/layerzero_config_repo_impl.go:28 [35;1mno such table: layerzero_configs
[0m[33m[0.009ms] [34;1m[rows:0][0m SELECT * FROM `layerzero_configs` WHERE id = "c4f19ad7-b784-4bab-96be-b8c2dcc7d41a" AND `layerzero_configs`.`deleted_at` IS NULL ORDER BY `layerzero_configs`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/layerzero_config_repo_impl.go:43 [35;1mno such table: layerzero_configs
[0m[33m[0.008ms] [34;1m[rows:0][0m SELECT * FROM `layerzero_configs` WHERE (source_chain_id = "4e37e0aa-1df5-46df-babc-dd3422b72cc1" AND dest_chain_id = "9d65e558-0ea8-490c-919c-4f64c3d2f7fe") AND `layerzero_configs`.`deleted_at` IS NULL ORDER BY updated_at DESC,`layerzero_configs`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/layerzero_config_repo_impl.go:68 [35;1mno such table: layerzero_configs
[0m[33m[0.005ms] [34;1m[rows:0][0m SELECT count(*) FROM `layerzero_configs` WHERE `layerzero_configs`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/layerzero_config_repo_impl.go:117 [35;1mno such table: layerzero_configs
[0m[33m[0.025ms] [34;1m[rows:0][0m UPDATE `layerzero_configs` SET `dest_chain_id`="5d282492-3a33-4cf6-993d-7bc7b7b9f437",`dst_eid`=1,`is_active`=true,`options_hex`="0x",`peer_hex`="0xpeer",`source_chain_id`="e437757d-0e56-476e-9de3-a52f30899a74",`updated_at`="2026-02-18 18:01:08.453" WHERE id = "0af6d7b6-2bcb-4553-999c-307c61c6c727" AND `layerzero_configs`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/layerzero_config_repo_impl.go:136 [35;1mno such table: layerzero_configs
[0m[33m[0.032ms] [34;1m[rows:0][0m UPDATE `layerzero_configs` SET `deleted_at`="2026-02-18 18:01:08.453" WHERE id = "5a6a84af-569f-48a8-80ce-5f41d8f846d5" AND `layerzero_configs`.`deleted_at` IS NULL
--- PASS: TestLayerZeroConfigRepo_DBErrorBranches (0.00s)
=== RUN   TestRepository_List_FindErrorAfterCount_Branches
=== RUN   TestRepository_List_FindErrorAfterCount_Branches/fee_config_list_find_error_after_count

2026/02/18 18:01:08 [34;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/list_find_error_after_count_test.go:25
[0m[35m[warn] [0mremoving callback `test:find_error_after_count:fee_configs` from /Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/list_find_error_after_count_test.go:25
=== RUN   TestRepository_List_FindErrorAfterCount_Branches/bridge_config_list_find_error_after_count

2026/02/18 18:01:08 [34;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/list_find_error_after_count_test.go:25
[0m[35m[warn] [0mremoving callback `test:find_error_after_count:bridge_configs` from /Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/list_find_error_after_count_test.go:25
=== RUN   TestRepository_List_FindErrorAfterCount_Branches/route_policy_list_find_error_after_count

2026/02/18 18:01:08 [34;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/list_find_error_after_count_test.go:25
[0m[35m[warn] [0mremoving callback `test:find_error_after_count:route_policies` from /Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/list_find_error_after_count_test.go:25
=== RUN   TestRepository_List_FindErrorAfterCount_Branches/layerzero_config_list_find_error_after_count

2026/02/18 18:01:08 [34;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/list_find_error_after_count_test.go:25
[0m[35m[warn] [0mremoving callback `test:find_error_after_count:layerzero_configs` from /Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/list_find_error_after_count_test.go:25
=== RUN   TestRepository_List_FindErrorAfterCount_Branches/token_get_all_tokens_find_error_after_count

2026/02/18 18:01:08 [34;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/list_find_error_after_count_test.go:25
[0m[35m[warn] [0mremoving callback `test:find_error_after_count:tokens` from /Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/list_find_error_after_count_test.go:25
--- PASS: TestRepository_List_FindErrorAfterCount_Branches (0.00s)
    --- PASS: TestRepository_List_FindErrorAfterCount_Branches/fee_config_list_find_error_after_count (0.00s)
    --- PASS: TestRepository_List_FindErrorAfterCount_Branches/bridge_config_list_find_error_after_count (0.00s)
    --- PASS: TestRepository_List_FindErrorAfterCount_Branches/route_policy_list_find_error_after_count (0.00s)
    --- PASS: TestRepository_List_FindErrorAfterCount_Branches/layerzero_config_list_find_error_after_count (0.00s)
    --- PASS: TestRepository_List_FindErrorAfterCount_Branches/token_get_all_tokens_find_error_after_count (0.00s)
=== RUN   TestMerchantRepository_CreateGetUpdateStatusDelete

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/merchant_repo_impl.go:66 [35;1mrecord not found
[0m[33m[0.017ms] [34;1m[rows:0][0m SELECT * FROM `merchants` WHERE id = "a77bab0c-5f90-4712-bbc8-426c9f8e550a" AND `merchants`.`deleted_at` IS NULL ORDER BY `merchants`.`id` LIMIT 1
--- PASS: TestMerchantRepository_CreateGetUpdateStatusDelete (0.00s)
=== RUN   TestMerchantRepository_NotFoundBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/merchant_repo_impl.go:66 [35;1mrecord not found
[0m[33m[0.071ms] [34;1m[rows:0][0m SELECT * FROM `merchants` WHERE id = "b2d6d327-dae9-4a72-82d4-6139bd9b7f5a" AND `merchants`.`deleted_at` IS NULL ORDER BY `merchants`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/merchant_repo_impl.go:78 [35;1mrecord not found
[0m[33m[0.029ms] [34;1m[rows:0][0m SELECT * FROM `merchants` WHERE user_id = "b2d6d327-dae9-4a72-82d4-6139bd9b7f5a" AND `merchants`.`deleted_at` IS NULL ORDER BY `merchants`.`id` LIMIT 1
--- PASS: TestMerchantRepository_NotFoundBranches (0.00s)
=== RUN   TestMerchantRepository_DBErrorBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/merchant_repo_impl.go:66 [35;1mno such table: merchants
[0m[33m[0.088ms] [34;1m[rows:0][0m SELECT * FROM `merchants` WHERE id = "1b0dc7d6-822e-4344-8da1-7d357d4d5c0f" AND `merchants`.`deleted_at` IS NULL ORDER BY `merchants`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/merchant_repo_impl.go:78 [35;1mno such table: merchants
[0m[33m[0.009ms] [34;1m[rows:0][0m SELECT * FROM `merchants` WHERE user_id = "20e65fa7-cdb3-4684-8f15-d5bc592b35f0" AND `merchants`.`deleted_at` IS NULL ORDER BY `merchants`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/merchant_repo_impl.go:155 [35;1mno such table: merchants
[0m[33m[0.007ms] [34;1m[rows:0][0m SELECT * FROM `merchants` WHERE `merchants`.`deleted_at` IS NULL ORDER BY created_at DESC

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/merchant_repo_impl.go:60 [35;1mno such table: merchants
[0m[33m[0.034ms] [34;1m[rows:0][0m INSERT INTO `merchants` (`user_id`,`business_name`,`business_email`,`merchant_type`,`status`,`tax_id`,`business_address`,`documents`,`fee_discount_percent`,`verified_at`,`created_at`,`updated_at`,`deleted_at`,`id`) VALUES ("decf7374-5a63-4141-ba0d-91dc86b5f225","x","x@x","RETAIL","PENDING","","","{}","0",NULL,"2026-02-18 18:01:08.457","2026-02-18 18:01:08.457",NULL,"7804413e-a311-4f7d-9a4a-5358b5d6cc2c") RETURNING `id`

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/merchant_repo_impl.go:117 [35;1mno such table: merchants
[0m[33m[0.120ms] [34;1m[rows:0][0m UPDATE `merchants` SET `business_address`="",`business_email`="x@x",`business_name`="x",`documents`="{}",`fee_discount_percent`="",`merchant_type`="RETAIL",`status`="PENDING",`tax_id`="",`updated_at`="2026-02-18 18:01:08.457" WHERE id = "0f080b58-d518-4d01-9913-44e053f0fcb7" AND `merchants`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/merchant_repo_impl.go:141 [35;1mno such table: merchants
[0m[33m[0.045ms] [34;1m[rows:0][0m UPDATE `merchants` SET `status`="ACTIVE",`updated_at`="2026-02-18 18:01:08.457",`verified_at`="2026-02-18 18:01:08.457" WHERE id = "ee8b1904-3f02-4022-a230-92549a065b49" AND `merchants`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/merchant_repo_impl.go:169 [35;1mno such table: merchants
[0m[33m[0.015ms] [34;1m[rows:0][0m UPDATE `merchants` SET `deleted_at`="2026-02-18 18:01:08.457" WHERE id = "ed6a04ff-ce42-49d9-b45e-2ef61765ba00" AND `merchants`.`deleted_at` IS NULL
--- PASS: TestMerchantRepository_DBErrorBranches (0.00s)
=== RUN   TestPaymentBridgeRepository_CRUDAndList

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_bridge_repo_impl.go:28 [35;1mrecord not found
[0m[33m[0.014ms] [34;1m[rows:0][0m SELECT * FROM `payment_bridge` WHERE id = "4e265398-875d-425a-887e-c68cd890d09f" AND `payment_bridge`.`deleted_at` IS NULL ORDER BY `payment_bridge`.`id` LIMIT 1
--- PASS: TestPaymentBridgeRepository_CRUDAndList (0.00s)
=== RUN   TestPaymentBridgeRepository_NotFoundBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_bridge_repo_impl.go:28 [35;1mrecord not found
[0m[33m[0.028ms] [34;1m[rows:0][0m SELECT * FROM `payment_bridge` WHERE id = "4c92f2e8-71a5-45a3-b2c6-a1d0449ee19b" AND `payment_bridge`.`deleted_at` IS NULL ORDER BY `payment_bridge`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_bridge_repo_impl.go:39 [35;1mrecord not found
[0m[33m[0.015ms] [34;1m[rows:0][0m SELECT * FROM `payment_bridge` WHERE LOWER(name) = "missing" AND `payment_bridge`.`deleted_at` IS NULL ORDER BY `payment_bridge`.`id` LIMIT 1
--- PASS: TestPaymentBridgeRepository_NotFoundBranches (0.00s)
=== RUN   TestPaymentBridgeRepository_Create_AssignsIDWhenNil
--- PASS: TestPaymentBridgeRepository_Create_AssignsIDWhenNil (0.00s)
=== RUN   TestPaymentBridgeRepository_DBErrorBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_bridge_repo_impl.go:28 [35;1mno such table: payment_bridge
[0m[33m[0.022ms] [34;1m[rows:0][0m SELECT * FROM `payment_bridge` WHERE id = "96e54d80-15ca-40d5-a7ba-bef031daab6d" AND `payment_bridge`.`deleted_at` IS NULL ORDER BY `payment_bridge`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_bridge_repo_impl.go:39 [35;1mno such table: payment_bridge
[0m[33m[0.006ms] [34;1m[rows:0][0m SELECT * FROM `payment_bridge` WHERE LOWER(name) = "ccip" AND `payment_bridge`.`deleted_at` IS NULL ORDER BY `payment_bridge`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_bridge_repo_impl.go:53 [35;1mno such table: payment_bridge
[0m[33m[0.005ms] [34;1m[rows:0][0m SELECT count(*) FROM `payment_bridge` WHERE `payment_bridge`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_bridge_repo_impl.go:92 [35;1mno such table: payment_bridge
[0m[33m[0.018ms] [34;1m[rows:0][0m UPDATE `payment_bridge` SET `name`="x",`updated_at`="2026-02-18 18:01:08.458" WHERE id = "2cbc7952-f419-438c-84d4-bc1cbb6c80e8" AND `payment_bridge`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_bridge_repo_impl.go:107 [35;1mno such table: payment_bridge
[0m[33m[0.017ms] [34;1m[rows:0][0m UPDATE `payment_bridge` SET `deleted_at`="2026-02-18 18:01:08.458" WHERE id = "d1bd60ea-c2a8-4b62-a8b0-f0e98ba92008" AND `payment_bridge`.`deleted_at` IS NULL
--- PASS: TestPaymentBridgeRepository_DBErrorBranches (0.00s)
=== RUN   TestPaymentBridgeRepository_List_FindErrorAfterCount

2026/02/18 18:01:08 [34;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_bridge_repo_impl_test.go:115
[0m[35m[warn] [0mremoving callback `test:payment_bridge_list_find_error` from /Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_bridge_repo_impl_test.go:115
--- PASS: TestPaymentBridgeRepository_List_FindErrorAfterCount (0.00s)
=== RUN   TestPaymentEventRepository_CreateAndReads
--- PASS: TestPaymentEventRepository_CreateAndReads (0.00s)
=== RUN   TestPaymentEventRepository_NotFoundLatest

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_event_repo_impl.go:119 [35;1mrecord not found
[0m[33m[0.429ms] [34;1m[rows:0][0m SELECT * FROM `payment_events` WHERE payment_id = "22aaaa84-fe6d-4cc1-a051-dc9ab518b6bb" ORDER BY created_at DESC,`payment_events`.`id` LIMIT 1
--- PASS: TestPaymentEventRepository_NotFoundLatest (0.00s)
=== RUN   TestPaymentEventRepository_DBErrorBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_event_repo_impl.go:54 [35;1mno such table: payment_events
[0m[33m[0.387ms] [34;1m[rows:0][0m INSERT INTO `payment_events` (`payment_id`,`event_type`,`chain_id`,`chain`,`tx_hash`,`block_number`,`metadata`,`created_at`,`id`) VALUES ("e5bb58dc-0cac-4083-bf79-025522c31ed7","CREATED",NULL,"UNKNOWN","0x",0,"{}","2026-02-18 18:01:08.461","4b5a5665-a193-40a4-8957-dab8e8b11fbf") RETURNING `id`

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_event_repo_impl.go:91 [35;1mno such table: payment_events
[0m[33m[0.006ms] [34;1m[rows:0][0m SELECT * FROM `payment_events` WHERE payment_id = "c602817a-9c34-4321-b3f2-33637c22d522" ORDER BY created_at ASC

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_event_repo_impl.go:119 [35;1mno such table: payment_events
[0m[33m[0.006ms] [34;1m[rows:0][0m SELECT * FROM `payment_events` WHERE payment_id = "82e5fb74-e7ad-429e-b7d6-b4a2d9b93885" ORDER BY created_at DESC,`payment_events`.`id` LIMIT 1
--- PASS: TestPaymentEventRepository_DBErrorBranches (0.00s)
=== RUN   TestPaymentEventRepository_ResolveLegacyChainValue
--- PASS: TestPaymentEventRepository_ResolveLegacyChainValue (0.00s)
=== RUN   TestPaymentEventRepository_Create_ZeroCreatedAtAndNilChain
--- PASS: TestPaymentEventRepository_Create_ZeroCreatedAtAndNilChain (0.00s)
=== RUN   TestPaymentEventRepository_Create_WithinTxContext
--- PASS: TestPaymentEventRepository_Create_WithinTxContext (0.00s)
=== RUN   TestPaymentRepository_BasicFlow
--- PASS: TestPaymentRepository_BasicFlow (0.00s)
=== RUN   TestPaymentRepository_NotFoundBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_repo_impl.go:99 [35;1mrecord not found
[0m[33m[0.369ms] [34;1m[rows:0][0m SELECT * FROM `payments` WHERE id = "31359e0d-6393-4bbd-91d5-8bdea636d96f" AND `payments`.`deleted_at` IS NULL ORDER BY `payments`.`id` LIMIT 1
--- PASS: TestPaymentRepository_NotFoundBranches (0.00s)
=== RUN   TestPaymentRepository_List_DBErrorBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_repo_impl.go:113 [35;1mno such table: payments
[0m[33m[0.332ms] [34;1m[rows:0][0m SELECT count(*) FROM `payments` WHERE sender_id = "ccec8863-b187-411c-b103-b1595d9735d1" AND `payments`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_repo_impl.go:141 [35;1mno such table: payments
[0m[33m[0.007ms] [34;1m[rows:0][0m SELECT count(*) FROM `payments` WHERE merchant_id = "61ba5530-1802-4ee3-82fd-0b4323dbef43" AND `payments`.`deleted_at` IS NULL
--- PASS: TestPaymentRepository_List_DBErrorBranches (0.00s)
=== RUN   TestPaymentRepository_DBErrorBranches_SingleAndUpdates

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_repo_impl.go:99 [35;1mno such table: payments
[0m[33m[0.943ms] [34;1m[rows:0][0m SELECT * FROM `payments` WHERE id = "68fdfb44-b693-4508-8040-f3493f88e892" AND `payments`.`deleted_at` IS NULL ORDER BY `payments`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_repo_impl.go:198 [35;1mno such table: payments
[0m[33m[0.039ms] [34;1m[rows:0][0m UPDATE `payments` SET `status`="COMPLETED",`updated_at`="2026-02-18 18:01:08.466" WHERE id = "057bfc3b-1212-4f43-81b1-ef8480254750" AND `payments`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_repo_impl.go:216 [35;1mno such table: payments
[0m[33m[0.045ms] [34;1m[rows:0][0m UPDATE `payments` SET `dest_tx_hash`="0xhash",`updated_at`="2026-02-18 18:01:08.466" WHERE id = "d4b0410b-07bb-40c9-a7ae-6f581e5cb908" AND `payments`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_repo_impl.go:227 [35;1mno such table: payments
[0m[33m[0.044ms] [34;1m[rows:0][0m UPDATE `payments` SET `status`="REFUNDED",`updated_at`="2026-02-18 18:01:08.466" WHERE id = "95d7b423-6853-413b-aa40-75968da44ea6" AND `payments`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_repo_impl.go:86 [35;1mno such table: payments
[0m[33m[0.082ms] [34;1m[rows:0][0m INSERT INTO `payments` (`sender_id`,`merchant_id`,`bridge_id`,`source_chain_id`,`dest_chain_id`,`source_token_id`,`dest_token_id`,`source_amount`,`dest_amount`,`fee_amount`,`total_charged`,`sender_address`,`dest_address`,`status`,`source_tx_hash`,`dest_tx_hash`,`refund_tx_hash`,`cross_chain_message_id`,`failure_reason`,`revert_data`,`expires_at`,`created_at`,`updated_at`,`deleted_at`,`id`) VALUES ("3bc4a69e-e77c-4ae4-b23f-b3b00c94ced8",NULL,NULL,"9021b4a2-4a5b-4a2b-85d0-aeb177006225","0eec8649-08bf-4f87-b51f-703a5dab2f32","4723198e-0378-45a3-b0a0-82c5c372a01e","04e4ae4c-0d4e-4bcd-9764-d769161f1012","1",NULL,"0","1","","","PENDING",NULL,NULL,NULL,NULL,NULL,NULL,NULL,"2026-02-18 18:01:08.466","2026-02-18 18:01:08.466",NULL,"7f503384-f544-47cb-ac89-abddfbfb15c7") RETURNING `id`
--- PASS: TestPaymentRepository_DBErrorBranches_SingleAndUpdates (0.00s)
=== RUN   TestPaymentRepository_Create_WithTxAndDestAmountBranch
--- PASS: TestPaymentRepository_Create_WithTxAndDestAmountBranch (0.00s)
=== RUN   TestPaymentRepository_List_FindErrorBranches

2026/02/18 18:01:08 [34;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_repo_impl_test.go:217
[0m[35m[warn] [0mremoving callback `test:payment_repo_fail_find` from /Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_repo_impl_test.go:217
--- PASS: TestPaymentRepository_List_FindErrorBranches (0.00s)
=== RUN   TestPaymentRequestRepository_FullFlow
--- PASS: TestPaymentRequestRepository_FullFlow (0.00s)
=== RUN   TestPaymentRequestRepository_ExpiredAndBulkExpire
--- PASS: TestPaymentRequestRepository_ExpiredAndBulkExpire (0.00s)
=== RUN   TestPaymentRequestRepository_GetByID_NotFound

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_request_repo_impl.go:45 [35;1mrecord not found
[0m[33m[0.072ms] [34;1m[rows:0][0m SELECT * FROM `payment_requests` WHERE id = "e1b35ff8-429c-419d-b6f9-dc64c4ec580e" AND `payment_requests`.`deleted_at` IS NULL ORDER BY `payment_requests`.`id` LIMIT 1
--- PASS: TestPaymentRequestRepository_GetByID_NotFound (0.00s)
=== RUN   TestBackgroundJobRepository_FullFlow
--- PASS: TestBackgroundJobRepository_FullFlow (0.00s)
=== RUN   TestPaymentRequestRepository_Create_DBError

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_request_repo_impl.go:40 [35;1mno such table: payment_requests
[0m[33m[0.150ms] [34;1m[rows:0][0m INSERT INTO `payment_requests` (`merchant_id`,`chain_id`,`token_id`,`wallet_address`,`token_address`,`amount`,`decimals`,`description`,`status`,`expires_at`,`tx_hash`,`payer_address`,`completed_at`,`created_at`,`updated_at`,`deleted_at`,`id`) VALUES ("a3ace8ec-73d3-414a-81c4-edc2590aec49","f6a0ad41-fdf6-4c8b-b64f-777c2a2a408c","e4eac8f2-d20d-44f0-9185-e33aeb3737c6","0xwallet","0xtoken","10",6,"test","PENDING","2026-02-18 19:01:08.47","","",NULL,"2026-02-18 18:01:08.47","2026-02-18 18:01:08.47",NULL,"9f1ff379-66c0-4700-9528-b5a4de59b0fe") RETURNING `id`
--- PASS: TestPaymentRequestRepository_Create_DBError (0.00s)
=== RUN   TestBackgroundJobRepository_Create_MarshalError
--- PASS: TestBackgroundJobRepository_Create_MarshalError (0.00s)
=== RUN   TestPaymentRequestRepository_GetByMerchantID_DBError

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_request_repo_impl.go:55 [35;1mno such table: payment_requests
[0m[33m[0.063ms] [34;1m[rows:0][0m SELECT count(*) FROM `payment_requests` WHERE merchant_id = "9d2eea56-86ca-4950-9683-19f971a6f540" AND `payment_requests`.`deleted_at` IS NULL
--- PASS: TestPaymentRequestRepository_GetByMerchantID_DBError (0.00s)
=== RUN   TestPaymentRequestRepository_GetByMerchantID_FindErrorAfterCount

2026/02/18 18:01:08 [34;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_request_repo_impl_test.go:174
[0m[35m[warn] [0mremoving callback `test:payment_request_find_fail` from /Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_request_repo_impl_test.go:174
--- PASS: TestPaymentRequestRepository_GetByMerchantID_FindErrorAfterCount (0.00s)
=== RUN   TestPaymentRequestRepository_ExtraDBErrorBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_request_repo_impl.go:79 [35;1mno such table: payment_requests
[0m[33m[0.079ms] [34;1m[rows:0][0m UPDATE `payment_requests` SET `status`="PENDING",`updated_at`="2026-02-18 18:01:08.471" WHERE id = "7c239e54-1320-4c97-bba5-ea6c1f20ed63" AND `payment_requests`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_request_repo_impl.go:88 [35;1mno such table: payment_requests
[0m[33m[0.019ms] [34;1m[rows:0][0m UPDATE `payment_requests` SET `payer_address`="0xpayer",`tx_hash`="0xtx",`updated_at`="2026-02-18 18:01:08.471" WHERE id = "09001d97-6f5e-4a87-a2ab-6f6aaa3334b0" AND `payment_requests`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_request_repo_impl.go:100 [35;1mno such table: payment_requests
[0m[33m[0.016ms] [34;1m[rows:0][0m UPDATE `payment_requests` SET `completed_at`="2026-02-18 18:01:08.471",`status`="COMPLETED",`tx_hash`="0xtx",`updated_at`="2026-02-18 18:01:08.471" WHERE id = "f1949e84-e754-40ce-91f4-a309a7e72bf7" AND `payment_requests`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_request_repo_impl.go:113 [35;1mno such table: payment_requests
[0m[33m[0.008ms] [34;1m[rows:0][0m SELECT * FROM `payment_requests` WHERE (status = "PENDING" AND expires_at < "2026-02-18 18:01:08.471") AND `payment_requests`.`deleted_at` IS NULL LIMIT 10

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_request_repo_impl.go:131 [35;1mno such table: payment_requests
[0m[33m[0.017ms] [34;1m[rows:0][0m UPDATE `payment_requests` SET `status`="EXPIRED",`updated_at`="2026-02-18 18:01:08.471" WHERE id IN ("4ce7c728-2c04-4ead-b43c-0a2010f03f82") AND `payment_requests`.`deleted_at` IS NULL
--- PASS: TestPaymentRequestRepository_ExtraDBErrorBranches (0.00s)
=== RUN   TestBackgroundJobRepository_DBErrorBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_request_repo_impl.go:192 [35;1mno such table: background_jobs
[0m[33m[0.051ms] [34;1m[rows:0][0m SELECT * FROM `background_jobs` WHERE status = "PENDING" AND scheduled_at <= "2026-02-18 18:01:08.471" AND attempts < max_attempts ORDER BY scheduled_at ASC LIMIT 10

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_request_repo_impl.go:222 [35;1mno such table: background_jobs
[0m[33m[0.018ms] [34;1m[rows:0][0m UPDATE `background_jobs` SET `attempts`=attempts + 1,`started_at`="2026-02-18 18:01:08.471",`status`="PROCESSING",`updated_at`="2026-02-18 18:01:08.471" WHERE id = "f31b98cc-f13b-4bd4-a67f-d04b49f42005"

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_request_repo_impl.go:244 [35;1mno such table: background_jobs
[0m[33m[0.011ms] [34;1m[rows:0][0m UPDATE `background_jobs` SET `error_message`="boom",`status`="FAILED",`updated_at`="2026-02-18 18:01:08.471" WHERE id = "f31b98cc-f13b-4bd4-a67f-d04b49f42005"

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_request_repo_impl.go:234 [35;1mno such table: background_jobs
[0m[33m[0.010ms] [34;1m[rows:0][0m UPDATE `background_jobs` SET `completed_at`="2026-02-18 18:01:08.471",`status`="COMPLETED",`updated_at`="2026-02-18 18:01:08.471" WHERE id = "f31b98cc-f13b-4bd4-a67f-d04b49f42005"
--- PASS: TestBackgroundJobRepository_DBErrorBranches (0.00s)
=== RUN   TestNewUnitOfWork_CreatesImplementation
--- PASS: TestNewUnitOfWork_CreatesImplementation (0.00s)
=== RUN   TestChainRepository_Create_AndNamespaceMapping
--- PASS: TestChainRepository_Create_AndNamespaceMapping (0.00s)
=== RUN   TestTokenRepository_Create_Method
--- PASS: TestTokenRepository_Create_Method (0.00s)
=== RUN   TestEmailVerificationRepository_CRUDFlow

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/user_repo_impl.go:207 [35;1mrecord not found
[0m[33m[0.030ms] [34;1m[rows:0][0m SELECT `users`.`id`,`users`.`email`,`users`.`name`,`users`.`password_hash`,`users`.`role`,`users`.`kyc_status`,`users`.`kyc_verified_at`,`users`.`created_at`,`users`.`updated_at`,`users`.`deleted_at` FROM `users` JOIN email_verifications ev ON ev.user_id = users.id WHERE (ev.token = "verify-token-1" AND ev.expires_at > "2026-02-18 18:01:08.473" AND ev.verified_at IS NULL AND ev.deleted_at IS NULL) AND `users`.`deleted_at` IS NULL ORDER BY `users`.`id` LIMIT 1
--- PASS: TestEmailVerificationRepository_CRUDFlow (0.00s)
=== RUN   TestRepositoryCreate_ErrorPaths
=== RUN   TestRepositoryCreate_ErrorPaths/bridge_config_create_error

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/bridge_config_repo_impl.go:121 [35;1mno such table: bridge_configs
[0m[33m[0.080ms] [34;1m[rows:0][0m INSERT INTO `bridge_configs` (`bridge_id`,`source_chain_id`,`dest_chain_id`,`router_address`,`fee_percentage`,`config`,`is_active`,`created_at`,`updated_at`,`deleted_at`,`id`) VALUES ("b2ccf833-3d6e-40d1-b353-f4f1f35101fe","1138778a-a7b1-4a3b-90e6-139c7224d9cf","7314a134-1392-47b5-a937-b1d7670d876f","0x1","0.1","{}",true,"2026-02-18 18:01:08.473","2026-02-18 18:01:08.473",NULL,"584a301e-71c7-4505-87c3-ec4ec39e3f8a") RETURNING `id`
=== RUN   TestRepositoryCreate_ErrorPaths/chain_create_error

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/chain_repo_impl.go:209 [35;1mno such table: chains
[0m[33m[0.113ms] [34;1m[rows:0][0m INSERT INTO `chains` (`chain_id`,`name`,`type`,`rpc_url`,`explorer_url`,`currency_symbol`,`image_url`,`is_active`,`state_machine_id`,`created_at`,`updated_at`,`deleted_at`,`id`) VALUES ("8453","Base","EVM","https://rpc.example","https://scan.example","ETH","",true,"","2026-02-18 18:01:08.473","2026-02-18 18:01:08.473",NULL,"0834ff98-19c3-44de-a840-dabf90bacb41") RETURNING `id`
=== RUN   TestRepositoryCreate_ErrorPaths/fee_config_create_error

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/fee_config_repo_impl.go:99 [35;1mno such table: fee_configs
[0m[33m[0.308ms] [34;1m[rows:0][0m INSERT INTO `fee_configs` (`chain_id`,`token_id`,`platform_fee_percent`,`fixed_base_fee`,`min_fee`,`max_fee`,`created_at`,`updated_at`,`deleted_at`,`id`) VALUES ("9a8f0f7d-3fbd-49e9-8c77-826d0397ed93","3200b843-2468-43f9-9eee-776936c165e5","0.01","1","0.1",NULL,"2026-02-18 18:01:08.473","2026-02-18 18:01:08.473",NULL,"ba7fbc2f-b55b-46fb-9674-5229ff74868b") RETURNING `id`
=== RUN   TestRepositoryCreate_ErrorPaths/payment_bridge_create_error

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_bridge_repo_impl.go:86 [35;1mno such table: payment_bridge
[0m[33m[0.057ms] [34;1m[rows:0][0m INSERT INTO `payment_bridge` (`name`,`created_at`,`updated_at`,`deleted_at`,`id`) VALUES ("Hyperbridge","2026-02-18 18:01:08.474","2026-02-18 18:01:08.474",NULL,"bf9d0aa4-02ce-449c-b06c-f13889871c12") RETURNING `id`
=== RUN   TestRepositoryCreate_ErrorPaths/payment_event_create_error

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/payment_event_repo_impl.go:54 [35;1mno such table: payment_events
[0m[33m[0.397ms] [34;1m[rows:0][0m INSERT INTO `payment_events` (`payment_id`,`event_type`,`chain_id`,`chain`,`tx_hash`,`block_number`,`metadata`,`created_at`,`id`) VALUES ("808d3d00-2863-4131-bb52-8288aa480d79","CREATED",NULL,"UNKNOWN","",0,"{}","2026-02-18 18:01:08.474","56a1a9d7-dc4d-4904-9ba8-bbef26345c4b") RETURNING `id`
=== RUN   TestRepositoryCreate_ErrorPaths/user_create_error

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/user_repo_impl.go:40 [35;1mno such table: users
[0m[33m[0.082ms] [34;1m[rows:0][0m INSERT INTO `users` (`email`,`name`,`password_hash`,`role`,`kyc_status`,`kyc_verified_at`,`created_at`,`updated_at`,`deleted_at`,`id`) VALUES ("a@b.c","A","x","USER","NOT_STARTED",NULL,"2026-02-18 18:01:08.475","2026-02-18 18:01:08.475",NULL,"0d15bf9d-bd2d-4eae-a68e-9a03a1bc857d") RETURNING `id`
--- PASS: TestRepositoryCreate_ErrorPaths (0.00s)
    --- PASS: TestRepositoryCreate_ErrorPaths/bridge_config_create_error (0.00s)
    --- PASS: TestRepositoryCreate_ErrorPaths/chain_create_error (0.00s)
    --- PASS: TestRepositoryCreate_ErrorPaths/fee_config_create_error (0.00s)
    --- PASS: TestRepositoryCreate_ErrorPaths/payment_bridge_create_error (0.00s)
    --- PASS: TestRepositoryCreate_ErrorPaths/payment_event_create_error (0.00s)
    --- PASS: TestRepositoryCreate_ErrorPaths/user_create_error (0.00s)
=== RUN   TestRoutePolicyRepository_CRUDAndNotFound

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/route_policy_repo_impl.go:30 [35;1mrecord not found
[0m[33m[0.014ms] [34;1m[rows:0][0m SELECT * FROM `route_policies` WHERE id = "1facbe6a-be45-4510-adb7-4cfbbda2fde1" AND `route_policies`.`deleted_at` IS NULL ORDER BY `route_policies`.`id` LIMIT 1
--- PASS: TestRoutePolicyRepository_CRUDAndNotFound (0.00s)
=== RUN   TestRoutePolicyRepository_Create_DefaultsAndGeneratedID
--- PASS: TestRoutePolicyRepository_Create_DefaultsAndGeneratedID (0.00s)
=== RUN   TestLayerZeroConfigRepository_CRUDAndNotFound

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/layerzero_config_repo_impl.go:28 [35;1mrecord not found
[0m[33m[0.013ms] [34;1m[rows:0][0m SELECT * FROM `layerzero_configs` WHERE id = "72288020-e148-4d52-b465-fe15f0bd0c5a" AND `layerzero_configs`.`deleted_at` IS NULL ORDER BY `layerzero_configs`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/layerzero_config_repo_impl.go:43 [35;1mrecord not found
[0m[33m[0.019ms] [34;1m[rows:0][0m SELECT * FROM `layerzero_configs` WHERE (source_chain_id = "b007a863-81b5-41b9-8007-b59f096240ce" AND dest_chain_id = "e8037644-e4d9-4f97-aa45-0e9f06c5da93") AND `layerzero_configs`.`deleted_at` IS NULL ORDER BY updated_at DESC,`layerzero_configs`.`id` LIMIT 1
--- PASS: TestLayerZeroConfigRepository_CRUDAndNotFound (0.00s)
=== RUN   TestRouteAndLayerZeroRepository_DBErrorBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/route_policy_repo_impl.go:30 [35;1mno such table: route_policies
[0m[33m[0.024ms] [34;1m[rows:0][0m SELECT * FROM `route_policies` WHERE id = "5e5f669c-cb31-4e8e-b6c7-37579ea2e7f7" AND `route_policies`.`deleted_at` IS NULL ORDER BY `route_policies`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/route_policy_repo_impl.go:46 [35;1mno such table: route_policies
[0m[33m[0.006ms] [34;1m[rows:0][0m SELECT * FROM `route_policies` WHERE (source_chain_id = "1f66ac9d-c276-4a7b-a216-75c16fbeade9" AND dest_chain_id = "08948ac9-4800-49fe-ad45-92d04557d3b8") AND `route_policies`.`deleted_at` IS NULL ORDER BY updated_at DESC LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/route_policy_repo_impl.go:68 [35;1mno such table: route_policies
[0m[33m[0.005ms] [34;1m[rows:0][0m SELECT count(*) FROM `route_policies` WHERE `route_policies`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/route_policy_repo_impl.go:137 [35;1mno such table: route_policies
[0m[33m[0.017ms] [34;1m[rows:0][0m UPDATE `route_policies` SET `deleted_at`="2026-02-18 18:01:08.476" WHERE id = "57affcf6-203e-42eb-9945-fd74b0e2877f" AND `route_policies`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/layerzero_config_repo_impl.go:28 [35;1mno such table: layerzero_configs
[0m[33m[0.026ms] [34;1m[rows:0][0m SELECT * FROM `layerzero_configs` WHERE id = "25e341f7-a3cd-4d95-a906-77a9aa22c522" AND `layerzero_configs`.`deleted_at` IS NULL ORDER BY `layerzero_configs`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/layerzero_config_repo_impl.go:43 [35;1mno such table: layerzero_configs
[0m[33m[0.006ms] [34;1m[rows:0][0m SELECT * FROM `layerzero_configs` WHERE (source_chain_id = "ccf94a5d-ab60-4c39-b268-cf06011a7ee4" AND dest_chain_id = "1d01a384-e8fe-42ee-a1e1-4745d77b7d18") AND `layerzero_configs`.`deleted_at` IS NULL ORDER BY updated_at DESC,`layerzero_configs`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/layerzero_config_repo_impl.go:68 [35;1mno such table: layerzero_configs
[0m[33m[0.004ms] [34;1m[rows:0][0m SELECT count(*) FROM `layerzero_configs` WHERE `layerzero_configs`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/layerzero_config_repo_impl.go:136 [35;1mno such table: layerzero_configs
[0m[33m[0.014ms] [34;1m[rows:0][0m UPDATE `layerzero_configs` SET `deleted_at`="2026-02-18 18:01:08.476" WHERE id = "71b57e41-d382-4e94-a5e5-863e91de78de" AND `layerzero_configs`.`deleted_at` IS NULL
--- PASS: TestRouteAndLayerZeroRepository_DBErrorBranches (0.00s)
=== RUN   TestRoutePolicyRepo_FallbackOrderHelpers
=== RUN   TestRoutePolicyRepo_FallbackOrderHelpers/marshal_empty_defaults_to_bridge_type_0
=== RUN   TestRoutePolicyRepo_FallbackOrderHelpers/marshal_non-empty_order
=== RUN   TestRoutePolicyRepo_FallbackOrderHelpers/parse_empty_or_invalid_defaults_to_0
=== RUN   TestRoutePolicyRepo_FallbackOrderHelpers/parse_valid_order
--- PASS: TestRoutePolicyRepo_FallbackOrderHelpers (0.00s)
    --- PASS: TestRoutePolicyRepo_FallbackOrderHelpers/marshal_empty_defaults_to_bridge_type_0 (0.00s)
    --- PASS: TestRoutePolicyRepo_FallbackOrderHelpers/marshal_non-empty_order (0.00s)
    --- PASS: TestRoutePolicyRepo_FallbackOrderHelpers/parse_empty_or_invalid_defaults_to_0 (0.00s)
    --- PASS: TestRoutePolicyRepo_FallbackOrderHelpers/parse_valid_order (0.00s)
=== RUN   TestRoutePolicyRepo_UpdateAndListBranches
--- PASS: TestRoutePolicyRepo_UpdateAndListBranches (0.00s)
=== RUN   TestRoutePolicyRepo_Update_DBErrorBranch

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/route_policy_repo_impl.go:119 [35;1mno such table: route_policies
[0m[33m[0.035ms] [34;1m[rows:0][0m UPDATE `route_policies` SET `default_bridge_type`=1,`dest_chain_id`="c3c619ab-50b4-4974-af40-e16a84823381",`fallback_mode`="strict",`fallback_order`="[0]",`source_chain_id`="079b54bd-a283-4c73-bdfd-b7cd35832dbc",`updated_at`="2026-02-18 18:01:08.477" WHERE id = "7e045b0f-1224-428c-9473-f3b48dd0b410" AND `route_policies`.`deleted_at` IS NULL
--- PASS: TestRoutePolicyRepo_Update_DBErrorBranch (0.00s)
=== RUN   TestRoutePolicyRepo_DeleteAndGetByIDBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/route_policy_repo_impl.go:30 [35;1mrecord not found
[0m[33m[0.012ms] [34;1m[rows:0][0m SELECT * FROM `route_policies` WHERE id = "ba1ce1b1-833d-4946-97c8-75ddfeb8c771" AND `route_policies`.`deleted_at` IS NULL ORDER BY `route_policies`.`id` LIMIT 1
--- PASS: TestRoutePolicyRepo_DeleteAndGetByIDBranches (0.00s)
=== RUN   TestRoutePolicyRepo_List_DBErrorBranch

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/route_policy_repo_impl.go:68 [35;1mno such table: route_policies
[0m[33m[0.021ms] [34;1m[rows:0][0m SELECT count(*) FROM `route_policies` WHERE `route_policies`.`deleted_at` IS NULL
--- PASS: TestRoutePolicyRepo_List_DBErrorBranch (0.00s)
=== RUN   TestRoutePolicyRepo_Create_DefaultsAndDBErrorBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/route_policy_repo_impl.go:107 [35;1mno such table: route_policies
[0m[33m[0.036ms] [34;1m[rows:0][0m INSERT INTO `route_policies` (`source_chain_id`,`dest_chain_id`,`default_bridge_type`,`fallback_mode`,`fallback_order`,`created_at`,`updated_at`,`deleted_at`,`id`) VALUES ("c5d23519-b2d8-4ed5-9a3b-f50aba2563de","1872ba44-660a-4fd0-942e-2078d1fbd615",0,"strict","[0]","2026-02-18 18:01:08.478","2026-02-18 18:01:08.478",NULL,"019c7069-32fe-7055-abe3-d47a5001f994") RETURNING `id`
--- PASS: TestRoutePolicyRepo_Create_DefaultsAndDBErrorBranches (0.00s)
=== RUN   TestSmartContractRepository_CRUDAndFilters

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/smart_contract_repo_impl.go:78 [35;1mrecord not found
[0m[33m[0.019ms] [34;1m[rows:0][0m SELECT * FROM `smart_contracts` WHERE id = "468db89c-4897-4801-97d5-44503aef62b0" AND `smart_contracts`.`deleted_at` IS NULL ORDER BY `smart_contracts`.`id` LIMIT 1
--- PASS: TestSmartContractRepository_CRUDAndFilters (0.00s)
=== RUN   TestSmartContractRepository_NotFoundAndDecodeBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/smart_contract_repo_impl.go:89 [35;1mrecord not found
[0m[33m[0.204ms] [34;1m[rows:0][0m SELECT * FROM `smart_contracts` WHERE (chain_id = "b3e28567-a7ed-43c1-888a-9872934a61cd" AND address = "0xdoesnotexist") AND `smart_contracts`.`deleted_at` IS NULL ORDER BY `smart_contracts`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/smart_contract_repo_impl.go:103 [35;1mrecord not found
[0m[33m[0.025ms] [34;1m[rows:0][0m SELECT * FROM `smart_contracts` WHERE (chain_id = "b3e28567-a7ed-43c1-888a-9872934a61cd" AND type = "ROUTER" AND is_active = true) AND `smart_contracts`.`deleted_at` IS NULL ORDER BY updated_at DESC, created_at DESC, version DESC, id DESC,`smart_contracts`.`id` LIMIT 1
Warning: failed to unmarshal ABI for contract b8c26683-957a-478d-b4a2-420b53dc7859: invalid character 'i' looking for beginning of object key string

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/smart_contract_repo_impl.go:103 [35;1mrecord not found
[0m[33m[0.023ms] [34;1m[rows:0][0m SELECT * FROM `smart_contracts` WHERE (chain_id = "b3e28567-a7ed-43c1-888a-9872934a61cd" AND type = "GATEWAY" AND is_active = true) AND `smart_contracts`.`deleted_at` IS NULL ORDER BY updated_at DESC, created_at DESC, version DESC, id DESC,`smart_contracts`.`id` LIMIT 1
--- PASS: TestSmartContractRepository_NotFoundAndDecodeBranches (0.00s)
=== RUN   TestSmartContractRepository_CreateMarshalError
--- PASS: TestSmartContractRepository_CreateMarshalError (0.00s)
=== RUN   TestSmartContractRepository_Query_DBErrorAndFilterCompat
=== RUN   TestSmartContractRepository_Query_DBErrorAndFilterCompat/db_errors_when_table_missing

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/smart_contract_repo_impl.go:118 [35;1mno such table: smart_contracts
[0m[33m[0.189ms] [34;1m[rows:0][0m SELECT count(*) FROM `smart_contracts` WHERE chain_id = "53d03a13-22e2-4772-901a-33f8a9065ab4" AND `smart_contracts`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/smart_contract_repo_impl.go:145 [35;1mno such table: smart_contracts
[0m[33m[0.005ms] [34;1m[rows:0][0m SELECT count(*) FROM `smart_contracts` WHERE `smart_contracts`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/smart_contract_repo_impl.go:184 [35;1mno such table: smart_contracts
[0m[33m[0.006ms] [34;1m[rows:0][0m SELECT count(*) FROM `smart_contracts` WHERE chain_id = "53d03a13-22e2-4772-901a-33f8a9065ab4" AND type = "ROUTER" AND `smart_contracts`.`deleted_at` IS NULL
=== RUN   TestSmartContractRepository_Query_DBErrorAndFilterCompat/filter_compat_for_pool_and_DEX_POOL_type
--- PASS: TestSmartContractRepository_Query_DBErrorAndFilterCompat (0.00s)
    --- PASS: TestSmartContractRepository_Query_DBErrorAndFilterCompat/db_errors_when_table_missing (0.00s)
    --- PASS: TestSmartContractRepository_Query_DBErrorAndFilterCompat/filter_compat_for_pool_and_DEX_POOL_type (0.00s)
=== RUN   TestSmartContractRepository_DBErrorBranches_OnSingleLookups

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/smart_contract_repo_impl.go:78 [35;1mno such table: smart_contracts
[0m[33m[0.127ms] [34;1m[rows:0][0m SELECT * FROM `smart_contracts` WHERE id = "e4a537b1-cc31-4a03-8e7f-fbc9a2e00e15" AND `smart_contracts`.`deleted_at` IS NULL ORDER BY `smart_contracts`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/smart_contract_repo_impl.go:89 [35;1mno such table: smart_contracts
[0m[33m[0.010ms] [34;1m[rows:0][0m SELECT * FROM `smart_contracts` WHERE (chain_id = "dbb40305-976a-4767-a0a2-7bd1050b543e" AND address = "0xabc") AND `smart_contracts`.`deleted_at` IS NULL ORDER BY `smart_contracts`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/smart_contract_repo_impl.go:103 [35;1mno such table: smart_contracts
[0m[33m[0.007ms] [34;1m[rows:0][0m SELECT * FROM `smart_contracts` WHERE (chain_id = "9d27680f-99b9-4f5f-a8b5-6c43939e0669" AND type = "ROUTER" AND is_active = true) AND `smart_contracts`.`deleted_at` IS NULL ORDER BY updated_at DESC, created_at DESC, version DESC, id DESC,`smart_contracts`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/smart_contract_repo_impl.go:241 [35;1mno such table: smart_contracts
[0m[33m[0.017ms] [34;1m[rows:0][0m UPDATE `smart_contracts` SET `deleted_at`="2026-02-18 18:01:08.48" WHERE id = "8aee9451-3617-4620-974f-e1a12fa4a9a4" AND `smart_contracts`.`deleted_at` IS NULL
--- PASS: TestSmartContractRepository_DBErrorBranches_OnSingleLookups (0.00s)
=== RUN   TestSmartContractRepository_Create_DBErrorBranch

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/smart_contract_repo_impl.go:70 [35;1mno such table: smart_contracts
[0m[33m[0.150ms] [34;1m[rows:0][0m INSERT INTO `smart_contracts` (`name`,`chain_id`,`address`,`abi`,`type`,`version`,`deployer_address`,`token0_address`,`token1_address`,`fee_tier`,`hook_address`,`start_block`,`metadata`,`is_active`,`created_at`,`updated_at`,`deleted_at`,`id`,`destination_map`) VALUES ("Router","4155c5f9-87a7-435e-8d0b-f2405a3b00f1","0x1111111111111111111111111111111111111111","[{""name"":""fn""}]","ROUTER","1.0.0","","","",0,"",0,"{}",true,"2026-02-18 18:01:08.48","2026-02-18 18:01:08.48",NULL,"2073acb9-5e52-47a7-9495-6046393f558f","{}") RETURNING `id`,`destination_map`
--- PASS: TestSmartContractRepository_Create_DBErrorBranch (0.00s)
=== RUN   TestSmartContractRepository_Update_DBErrorBranch

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/smart_contract_repo_impl.go:230 [35;1mno such table: smart_contracts
[0m[33m[0.355ms] [34;1m[rows:0][0m UPDATE `smart_contracts` SET `abi`="null",`address`="0x1111111111111111111111111111111111111111",`chain_id`="cac9ed0f-9e8b-4058-bda3-d5d5f53f1109",`deployer_address`="",`fee_tier`=0,`hook_address`="",`is_active`=true,`metadata`="{}",`name`="Router",`start_block`=0,`token0_address`="",`token1_address`="",`type`="ROUTER",`version`="1.0.0",`updated_at`="2026-02-18 18:01:08.481" WHERE id = "03dada0d-ce78-429c-adbb-f01241f1c548" AND `smart_contracts`.`deleted_at` IS NULL
--- PASS: TestSmartContractRepository_Update_DBErrorBranch (0.00s)
=== RUN   TestSmartContractRepository_List_FindErrorAfterCount

2026/02/18 18:01:08 [34;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/smart_contract_repo_impl_test.go:330
[0m[35m[warn] [0mremoving callback `test:smart_contract_find_error_after_count` from /Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/smart_contract_repo_impl_test.go:330
--- PASS: TestSmartContractRepository_List_FindErrorAfterCount (0.00s)
=== RUN   TestSmartContractRepository_ToEntity_NullAndInvalidJSONBranches
=== RUN   TestSmartContractRepository_ToEntity_NullAndInvalidJSONBranches/null_abi_and_null_metadata_fallback
=== RUN   TestSmartContractRepository_ToEntity_NullAndInvalidJSONBranches/invalid_abi_json_keeps_entity_alive
Warning: failed to unmarshal ABI for contract 38480e3a-794b-4e9a-9203-85757c038931: invalid character 'n' looking for beginning of object key string
--- PASS: TestSmartContractRepository_ToEntity_NullAndInvalidJSONBranches (0.00s)
    --- PASS: TestSmartContractRepository_ToEntity_NullAndInvalidJSONBranches/null_abi_and_null_metadata_fallback (0.00s)
    --- PASS: TestSmartContractRepository_ToEntity_NullAndInvalidJSONBranches/invalid_abi_json_keeps_entity_alive (0.00s)
=== RUN   TestSmartContractRepository_GetFiltered_NoTypeAndNoChainFilter
--- PASS: TestSmartContractRepository_GetFiltered_NoTypeAndNoChainFilter (0.00s)
=== RUN   TestSmartContractRepository_GetFiltered_FindErrorAfterCount

2026/02/18 18:01:08 [34;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/smart_contract_repo_impl_test.go:433
[0m[35m[warn] [0mremoving callback `test:smart_contract_filtered_find_error_after_count` from /Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/smart_contract_repo_impl_test.go:433
--- PASS: TestSmartContractRepository_GetFiltered_FindErrorAfterCount (0.00s)
=== RUN   TestTeamRepository_CRUDAndLists

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/team_repo_impl.go:69 [35;1mnear "ILIKE": syntax error
[0m[33m[0.008ms] [34;1m[rows:0][0m SELECT * FROM `teams` WHERE (name ILIKE "%desig%" OR role ILIKE "%desig%") AND `teams`.`deleted_at` IS NULL ORDER BY display_order ASC, created_at ASC

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/team_repo_impl.go:37 [35;1mrecord not found
[0m[33m[0.029ms] [34;1m[rows:0][0m SELECT * FROM `teams` WHERE id = "d4fe0ee8-59bb-4011-a8ef-03b950409779" AND `teams`.`deleted_at` IS NULL ORDER BY `teams`.`id` LIMIT 1
--- PASS: TestTeamRepository_CRUDAndLists (0.00s)
=== RUN   TestTeamRepository_NotFoundBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/team_repo_impl.go:37 [35;1mrecord not found
[0m[33m[0.045ms] [34;1m[rows:0][0m SELECT * FROM `teams` WHERE id = "babd71d6-ce50-4fcd-b8b7-a9b5c8fcbbd4" AND `teams`.`deleted_at` IS NULL ORDER BY `teams`.`id` LIMIT 1
--- PASS: TestTeamRepository_NotFoundBranches (0.00s)
=== RUN   TestTeamRepository_ToEntity_DeletedAtBranch
--- PASS: TestTeamRepository_ToEntity_DeletedAtBranch (0.00s)
=== RUN   TestTeamRepository_DBErrorBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/team_repo_impl.go:26 [35;1mno such table: teams
[0m[33m[0.063ms] [34;1m[rows:0][0m INSERT INTO `teams` (`name`,`role`,`bio`,`image_url`,`github_url`,`twitter_url`,`linkedin_url`,`display_order`,`is_active`,`created_at`,`updated_at`,`deleted_at`,`id`) VALUES ("x","r","b","https://img","","","",0,true,"2026-02-18 18:01:08.483","2026-02-18 18:01:08.483",NULL,"0bec4be4-e67a-4f67-8375-25196d3f7be5") RETURNING `id`

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/team_repo_impl.go:37 [35;1mno such table: teams
[0m[33m[0.007ms] [34;1m[rows:0][0m SELECT * FROM `teams` WHERE id = "a20c531c-b91a-4b0c-ac48-9cddb10a045c" AND `teams`.`deleted_at` IS NULL ORDER BY `teams`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/team_repo_impl.go:51 [35;1mno such table: teams
[0m[33m[0.005ms] [34;1m[rows:0][0m SELECT * FROM `teams` WHERE is_active = true AND `teams`.`deleted_at` IS NULL ORDER BY display_order ASC, created_at ASC

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/team_repo_impl.go:69 [35;1mno such table: teams
[0m[33m[0.004ms] [34;1m[rows:0][0m SELECT * FROM `teams` WHERE `teams`.`deleted_at` IS NULL ORDER BY display_order ASC, created_at ASC

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/team_repo_impl.go:97 [35;1mno such table: teams
[0m[33m[0.019ms] [34;1m[rows:0][0m UPDATE `teams` SET `bio`="b",`display_order`=0,`github_url`="",`image_url`="https://img",`is_active`=true,`linkedin_url`="",`name`="x",`role`="r",`twitter_url`="",`updated_at`="2026-02-18 18:01:08.483" WHERE id = "815efec7-439e-4985-9884-9e36331df95e" AND `teams`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/team_repo_impl.go:108 [35;1mno such table: teams
[0m[33m[0.014ms] [34;1m[rows:0][0m UPDATE `teams` SET `deleted_at`="2026-02-18 18:01:08.483" WHERE id = "6a732653-6d4d-4ee9-8c06-01bdc8849aa3" AND `teams`.`deleted_at` IS NULL
--- PASS: TestTeamRepository_DBErrorBranches (0.00s)
=== RUN   TestTokenRepository_ToEntityAndToModel_InternalBranches
--- PASS: TestTokenRepository_ToEntityAndToModel_InternalBranches (0.00s)
=== RUN   TestTokenRepository_Create_ErrorBranch
--- PASS: TestTokenRepository_Create_ErrorBranch (0.00s)
=== RUN   TestTokenRepository_GetAllTokens_QueryBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/token_repo_impl.go:158 [35;1mnear "ILIKE": syntax error
[0m[33m[0.007ms] [34;1m[rows:0][0m SELECT count(*) FROM `tokens` WHERE (symbol ILIKE "%USD%" OR name ILIKE "%USD%" OR address ILIKE "%USD%") AND `tokens`.`deleted_at` IS NULL
--- PASS: TestTokenRepository_GetAllTokens_QueryBranches (0.00s)
=== RUN   TestTokenRepository_CRUDAndQueries

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/token_repo_impl.go:36 [35;1mrecord not found
[0m[33m[0.012ms] [34;1m[rows:0][0m SELECT * FROM `tokens` WHERE id = "ea0ad4c1-f903-4eae-9c1f-389e35108aac" AND `tokens`.`deleted_at` IS NULL ORDER BY `tokens`.`id` LIMIT 1
--- PASS: TestTokenRepository_CRUDAndQueries (0.00s)
=== RUN   TestTokenRepository_NotFoundBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/token_repo_impl.go:36 [35;1mrecord not found
[0m[33m[0.231ms] [34;1m[rows:0][0m SELECT * FROM `tokens` WHERE id = "44b5ce52-8715-47eb-9ad7-3b14950ec5d5" AND `tokens`.`deleted_at` IS NULL ORDER BY `tokens`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/token_repo_impl.go:48 [35;1mrecord not found
[0m[33m[0.033ms] [34;1m[rows:0][0m SELECT * FROM `tokens` WHERE (symbol = "NOPE" AND chain_id = "0c70bb22-1d6b-4790-9b98-cb525b93d857") AND `tokens`.`deleted_at` IS NULL ORDER BY `tokens`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/token_repo_impl.go:60 [35;1mrecord not found
[0m[33m[0.037ms] [34;1m[rows:0][0m SELECT * FROM `tokens` WHERE (address = "0xnope" AND chain_id = "0c70bb22-1d6b-4790-9b98-cb525b93d857") AND `tokens`.`deleted_at` IS NULL ORDER BY `tokens`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/token_repo_impl.go:104 [35;1mrecord not found
[0m[33m[0.025ms] [34;1m[rows:0][0m SELECT * FROM `tokens` WHERE (chain_id = "0c70bb22-1d6b-4790-9b98-cb525b93d857" AND is_native = true) AND `tokens`.`deleted_at` IS NULL ORDER BY `tokens`.`id` LIMIT 1
--- PASS: TestTokenRepository_NotFoundBranches (0.00s)
=== RUN   TestTokenRepository_DBErrorBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/token_repo_impl.go:36 [35;1mno such table: tokens
[0m[33m[0.163ms] [34;1m[rows:0][0m SELECT * FROM `tokens` WHERE id = "546ba221-a212-4e74-9aee-8dd4dd022d4a" AND `tokens`.`deleted_at` IS NULL ORDER BY `tokens`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/token_repo_impl.go:48 [35;1mno such table: tokens
[0m[33m[0.007ms] [34;1m[rows:0][0m SELECT * FROM `tokens` WHERE (symbol = "USDC" AND chain_id = "0649ada4-6d6f-4b19-b444-a337f75a2e4c") AND `tokens`.`deleted_at` IS NULL ORDER BY `tokens`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/token_repo_impl.go:60 [35;1mno such table: tokens
[0m[33m[0.005ms] [34;1m[rows:0][0m SELECT * FROM `tokens` WHERE (address = "0x1" AND chain_id = "eaea101a-d712-4faa-b6a8-7d9e02d082ff") AND `tokens`.`deleted_at` IS NULL ORDER BY `tokens`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/token_repo_impl.go:72 [35;1mno such table: tokens
[0m[33m[0.005ms] [34;1m[rows:0][0m SELECT * FROM `tokens` WHERE `tokens`.`deleted_at` IS NULL ORDER BY symbol

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/token_repo_impl.go:87 [35;1mno such table: tokens
[0m[33m[0.009ms] [34;1m[rows:0][0m SELECT * FROM `tokens` WHERE is_stablecoin = true AND `tokens`.`deleted_at` IS NULL ORDER BY symbol

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/token_repo_impl.go:104 [35;1mno such table: tokens
[0m[33m[0.006ms] [34;1m[rows:0][0m SELECT * FROM `tokens` WHERE (chain_id = "4c147e34-1976-40ff-92da-32f7b2a7afb0" AND is_native = true) AND `tokens`.`deleted_at` IS NULL ORDER BY `tokens`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/token_repo_impl.go:121 [35;1mno such table: tokens
[0m[33m[0.006ms] [34;1m[rows:0][0m SELECT count(*) FROM `tokens` WHERE (chain_id = "6f8e6e38-49e2-4882-b30c-97a67b8a0054" AND is_active = true) AND `tokens`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/token_repo_impl.go:158 [35;1mno such table: tokens
[0m[33m[0.013ms] [34;1m[rows:0][0m SELECT count(*) FROM `tokens` WHERE `tokens`.`deleted_at` IS NULL
--- PASS: TestTokenRepository_DBErrorBranches (0.00s)
=== RUN   TestTokenRepository_GetAllTokens_SearchPathSQLiteILikeError

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/token_repo_impl.go:158 [35;1mnear "ILIKE": syntax error
[0m[33m[0.142ms] [34;1m[rows:0][0m SELECT count(*) FROM `tokens` WHERE chain_id = "ac140e0d-64d7-4f24-917c-c3c6dda9d301" AND (symbol ILIKE "%USD%" OR name ILIKE "%USD%" OR address ILIKE "%USD%") AND `tokens`.`deleted_at` IS NULL
--- PASS: TestTokenRepository_GetAllTokens_SearchPathSQLiteILikeError (0.00s)
=== RUN   TestTokenRepository_GetTokensByChain_FindErrorAfterCount

2026/02/18 18:01:08 [34;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/token_repo_impl_test.go:162
[0m[35m[warn] [0mremoving callback `test:token_gettokensbychain_find_error` from /Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/token_repo_impl_test.go:162
--- PASS: TestTokenRepository_GetTokensByChain_FindErrorAfterCount (0.00s)
=== RUN   TestUnitOfWork_DoCommitAndRollback
--- PASS: TestUnitOfWork_DoCommitAndRollback (0.00s)
=== RUN   TestUnitOfWork_WithLockAndGetDB
--- PASS: TestUnitOfWork_WithLockAndGetDB (0.00s)
=== RUN   TestUnitOfWork_DoBeginFailure
--- PASS: TestUnitOfWork_DoBeginFailure (0.00s)
=== RUN   TestUnitOfWork_DoCommitFailure_WithHook
--- PASS: TestUnitOfWork_DoCommitFailure_WithHook (0.00s)
=== RUN   TestUserRepository_CRUDAndList

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/user_repo_impl.go:118 [35;1mnear "ILIKE": syntax error
[0m[33m[0.005ms] [34;1m[rows:0][0m SELECT * FROM `users` WHERE (name ILIKE "%Ali%" OR email ILIKE "%Ali%") AND `users`.`deleted_at` IS NULL ORDER BY created_at DESC

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/user_repo_impl.go:49 [35;1mrecord not found
[0m[33m[0.012ms] [34;1m[rows:0][0m SELECT * FROM `users` WHERE id = "c0d5e52d-fbd6-486d-ba21-5406ca12fcc8" AND `users`.`deleted_at` IS NULL ORDER BY `users`.`id` LIMIT 1
--- PASS: TestUserRepository_CRUDAndList (0.00s)
=== RUN   TestUserRepository_NotFoundBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/user_repo_impl.go:49 [35;1mrecord not found
[0m[33m[0.513ms] [34;1m[rows:0][0m SELECT * FROM `users` WHERE id = "01f9e3d8-7f30-4a54-8901-b0690c6154c5" AND `users`.`deleted_at` IS NULL ORDER BY `users`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/user_repo_impl.go:61 [35;1mrecord not found
[0m[33m[0.171ms] [34;1m[rows:0][0m SELECT * FROM `users` WHERE email = "missing@paychain.io" AND `users`.`deleted_at` IS NULL ORDER BY `users`.`id` LIMIT 1
--- PASS: TestUserRepository_NotFoundBranches (0.00s)
=== RUN   TestUserRepository_Update_WithKYCVerifiedAt_AndDBErrorBranch

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/user_repo_impl.go:83 [35;1mno such table: users
[0m[33m[0.048ms] [34;1m[rows:0][0m UPDATE `users` SET `kyc_status`="NOT_STARTED",`name`="x",`role`="USER",`updated_at`="2026-02-18 18:01:08.49" WHERE id = "bcf7d846-1a5a-4c81-a9db-a6a89799a8c7" AND `users`.`deleted_at` IS NULL
--- PASS: TestUserRepository_Update_WithKYCVerifiedAt_AndDBErrorBranch (0.00s)
=== RUN   TestUserRepository_DBErrorBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/user_repo_impl.go:49 [35;1mno such table: users
[0m[33m[0.032ms] [34;1m[rows:0][0m SELECT * FROM `users` WHERE id = "b8b8943b-dafd-4a20-8977-32ec082ad923" AND `users`.`deleted_at` IS NULL ORDER BY `users`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/user_repo_impl.go:61 [35;1mno such table: users
[0m[33m[0.004ms] [34;1m[rows:0][0m SELECT * FROM `users` WHERE email = "x@paychain.io" AND `users`.`deleted_at` IS NULL ORDER BY `users`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/user_repo_impl.go:95 [35;1mno such table: users
[0m[33m[0.012ms] [34;1m[rows:0][0m UPDATE `users` SET `password_hash`="hash",`updated_at`="2026-02-18 18:01:08.49" WHERE id = "d93b3b0b-a0fe-4da0-affb-f80bf98277d7" AND `users`.`deleted_at` IS NULL

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/user_repo_impl.go:132 [35;1mno such table: users
[0m[33m[0.010ms] [34;1m[rows:0][0m UPDATE `users` SET `deleted_at`="2026-02-18 18:01:08.49" WHERE id = "89ffad7d-7f9b-446d-a919-ca7001714500" AND `users`.`deleted_at` IS NULL
--- PASS: TestUserRepository_DBErrorBranches (0.00s)
=== RUN   TestWalletRepository_CRUDAndPrimary

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/wallet_repo_impl.go:48 [35;1mrecord not found
[0m[33m[0.012ms] [34;1m[rows:0][0m SELECT * FROM `wallets` WHERE id = "8c4e343a-e0e0-49f9-beeb-ea080e07b5e0" AND `wallets`.`deleted_at` IS NULL ORDER BY `wallets`.`id` LIMIT 1
--- PASS: TestWalletRepository_CRUDAndPrimary (0.00s)
=== RUN   TestWalletRepository_NotFoundBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/wallet_repo_impl.go:48 [35;1mrecord not found
[0m[33m[0.139ms] [34;1m[rows:0][0m SELECT * FROM `wallets` WHERE id = "a10d5bff-dbc6-4449-a696-e72e844ce8b6" AND `wallets`.`deleted_at` IS NULL ORDER BY `wallets`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/wallet_repo_impl.go:97 [35;1mrecord not found
[0m[33m[0.021ms] [34;1m[rows:0][0m SELECT * FROM `wallets` WHERE (chain_id = "d6cce2a4-61dd-4f1e-9a93-cd0b337cc369" AND address = "0xmissing") AND `wallets`.`deleted_at` IS NULL ORDER BY `wallets`.`id` LIMIT 1
--- PASS: TestWalletRepository_NotFoundBranches (0.00s)
=== RUN   TestWalletRepository_SetPrimary_DBErrorBranch

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/wallet_repo_impl.go:112 [35;1mno such table: wallets
[0m[33m[0.124ms] [34;1m[rows:0][0m UPDATE `wallets` SET `is_primary`=false,`updated_at`="2026-02-18 18:01:08.491" WHERE user_id = "9d5b2e5c-aed0-45c9-96b3-310f67f027a0" AND `wallets`.`deleted_at` IS NULL
--- PASS: TestWalletRepository_SetPrimary_DBErrorBranch (0.00s)
=== RUN   TestWalletRepository_SetPrimary_SecondUpdateErrorBranch

2026/02/18 18:01:08 [34;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/wallet_repo_impl_test.go:119
[0m[35m[warn] [0mremoving callback `test:setprimary_fail_on_true` from /Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/wallet_repo_impl_test.go:119
--- PASS: TestWalletRepository_SetPrimary_SecondUpdateErrorBranch (0.00s)
=== RUN   TestWalletRepository_OtherDBErrorBranches

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/wallet_repo_impl.go:42 [35;1mno such table: wallets
[0m[33m[0.119ms] [34;1m[rows:0][0m INSERT INTO `wallets` (`user_id`,`merchant_id`,`chain_id`,`address`,`is_primary`,`created_at`,`updated_at`,`deleted_at`,`id`) VALUES ("9a9d5d41-bc1d-4cc5-a9e0-75f96a02cdcb",NULL,"e697630a-e820-412a-9c79-3cc16cff6d67","0xabc",false,"2026-02-18 18:01:08.492","2026-02-18 18:01:08.492",NULL,"b4b3f3df-dadc-4798-9afa-c330b9bcf1f6") RETURNING `id`

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/wallet_repo_impl.go:48 [35;1mno such table: wallets
[0m[33m[0.007ms] [34;1m[rows:0][0m SELECT * FROM `wallets` WHERE id = "a4d3edec-dfbb-4da4-bd95-adaa10823472" AND `wallets`.`deleted_at` IS NULL ORDER BY `wallets`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/wallet_repo_impl.go:97 [35;1mno such table: wallets
[0m[33m[0.006ms] [34;1m[rows:0][0m SELECT * FROM `wallets` WHERE (chain_id = "23c309d0-f6dc-4cfe-a356-5ed698a217c6" AND address = "0xabc") AND `wallets`.`deleted_at` IS NULL ORDER BY `wallets`.`id` LIMIT 1

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/wallet_repo_impl.go:63 [35;1mno such table: wallets
[0m[33m[0.005ms] [34;1m[rows:0][0m SELECT * FROM `wallets` WHERE user_id = "91d04dfd-cbdb-4253-80d6-6e49bc8a62be" AND `wallets`.`deleted_at` IS NULL ORDER BY is_primary DESC, created_at DESC

2026/02/18 18:01:08 [31;1m/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/infrastructure/repositories/wallet_repo_impl.go:133 [35;1mno such table: wallets
[0m[33m[0.024ms] [34;1m[rows:0][0m UPDATE `wallets` SET `deleted_at`="2026-02-18 18:01:08.492" WHERE id = "ce76b57d-feac-4990-9ed9-1c048b450906" AND `wallets`.`deleted_at` IS NULL
--- PASS: TestWalletRepository_OtherDBErrorBranches (0.00s)
PASS
ok  	pay-chain.backend/internal/infrastructure/repositories	(cached)
=== RUN   TestAdminHandler_ListAndUpdateStatus
--- PASS: TestAdminHandler_ListAndUpdateStatus (0.00s)
=== RUN   TestAdminHandler_BasicValidationBranches
--- PASS: TestAdminHandler_BasicValidationBranches (0.00s)
=== RUN   TestSmartContractHandler_ValidationBranches
--- PASS: TestSmartContractHandler_ValidationBranches (0.00s)
=== RUN   TestAdminHandler_ErrorBranchesAndStats
--- PASS: TestAdminHandler_ErrorBranchesAndStats (0.00s)
=== RUN   TestTeamHandler_ErrorBranches
--- PASS: TestTeamHandler_ErrorBranches (0.00s)
=== RUN   TestApiKeyHandler_CreateListRevoke
--- PASS: TestApiKeyHandler_CreateListRevoke (0.00s)
=== RUN   TestApiKeyHandler_ValidationPaths
--- PASS: TestApiKeyHandler_ValidationPaths (0.00s)
=== RUN   TestApiKeyHandler_ErrorPaths
--- PASS: TestApiKeyHandler_ErrorPaths (0.00s)
=== RUN   TestAuthHandler_RegisterLoginVerifyAndMe
2026/02/18 18:06:01 [AuthHandler] GetMe called for path: /auth/me
2026/02/18 18:06:01 [AuthHandler] GetMe fetching user for ID: 4fbbb78f-6b56-4fc5-91b0-3063ef4f7a61
2026/02/18 18:06:01 [AuthHandler] GetMe success for user: User (user@x.com)
--- PASS: TestAuthHandler_RegisterLoginVerifyAndMe (0.00s)
=== RUN   TestAuthHandler_RefreshChangePasswordLogoutAndSessionExpiry
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Request received. Content-Length: 0
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Token loaded from Redis session
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Request received. Content-Length: 0
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Token loaded from Redis session
--- PASS: TestAuthHandler_RefreshChangePasswordLogoutAndSessionExpiry (0.00s)
=== RUN   TestAuthHandler_Login_Refresh_ChangePassword_GapBranches
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Request received. Content-Length: 16
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Failed to bind JSON: unexpected EOF
2026/02/18 18:06:01 [AuthHandler] RefreshToken: No cookie found: http: named cookie not present
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Error - No refresh token provided in body/cookie/session
--- PASS: TestAuthHandler_Login_Refresh_ChangePassword_GapBranches (0.00s)
=== RUN   TestAuthHandler_GetMe_ErrorBranches
2026/02/18 18:06:01 [AuthHandler] GetMe called for path: /auth/me/type
2026/02/18 18:06:01 [AuthHandler] GetMe failed: userID in context is not a UUID (got string)
2026/02/18 18:06:01 [AuthHandler] GetMe called for path: /auth/me/notfound
2026/02/18 18:06:01 [AuthHandler] GetMe fetching user for ID: a6395c3e-08a8-497e-b109-46eb9dbf3813
2026/02/18 18:06:01 [AuthHandler] GetMe failed to fetch user: resource not found
2026/02/18 18:06:01 [AuthHandler] GetMe called for path: /auth/me/internal
2026/02/18 18:06:01 [AuthHandler] GetMe fetching user for ID: c4953310-bcd9-4891-89b2-570f1f4a719b
2026/02/18 18:06:01 [AuthHandler] GetMe failed to fetch user: db down
--- PASS: TestAuthHandler_GetMe_ErrorBranches (0.00s)
=== RUN   TestAuthHandler_RefreshToken_LegacyFallbackBranches
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Request received. Content-Length: 21
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Token found in JSON body
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Request received. Content-Length: 0
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Token found in cookie
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Request received. Content-Length: 21
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Token found in JSON body
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Request received. Content-Length: 22
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Token found in JSON body
--- PASS: TestAuthHandler_RefreshToken_LegacyFallbackBranches (0.00s)
=== RUN   TestAuthHandler_VerifyEmail_GenericError
--- PASS: TestAuthHandler_VerifyEmail_GenericError (0.00s)
=== RUN   TestAuthHandler_Register_GenericError
--- PASS: TestAuthHandler_Register_GenericError (0.00s)
=== RUN   TestAuthHandler_GetSessionExpiry_NoSession
--- PASS: TestAuthHandler_GetSessionExpiry_NoSession (0.00s)
=== RUN   TestAuthHandler_GetSessionExpiry_InvalidProxy
--- PASS: TestAuthHandler_GetSessionExpiry_InvalidProxy (0.00s)
=== RUN   TestAuthHandler_GetSessionExpiry_CookieFallbackAndInvalidSession
--- PASS: TestAuthHandler_GetSessionExpiry_CookieFallbackAndInvalidSession (0.00s)
=== RUN   TestAuthHandler_RegisterLoginVerify_Validation
--- PASS: TestAuthHandler_RegisterLoginVerify_Validation (0.00s)
=== RUN   TestAuthHandler_RefreshToken_NoToken
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Request received. Content-Length: 0
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Error - No refresh token provided in body/cookie/session
--- PASS: TestAuthHandler_RefreshToken_NoToken (0.00s)
=== RUN   TestAuthHandler_GetMe_And_ChangePassword_Validation
2026/02/18 18:06:01 [AuthHandler] GetMe called for path: /auth/me
2026/02/18 18:06:01 [AuthHandler] GetMe failed: userId not found in context (Middleware key: userId)
--- PASS: TestAuthHandler_GetMe_And_ChangePassword_Validation (0.00s)
=== RUN   TestAuthHandler_RefreshToken_UsesLegacyCookieSessionID
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Request received. Content-Length: 29
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Token found in JSON body
--- PASS: TestAuthHandler_RefreshToken_UsesLegacyCookieSessionID (0.00s)
=== RUN   TestAuthHandler_RefreshToken_StrictMode_UntrustedProxySkipsSessionLookup
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Request received. Content-Length: 0
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Error - No refresh token provided in body/cookie/session
--- PASS: TestAuthHandler_RefreshToken_StrictMode_UntrustedProxySkipsSessionLookup (0.00s)
=== RUN   TestTokenHandler_ListSupportedTokens_SearchQueryBranch
--- PASS: TestTokenHandler_ListSupportedTokens_SearchQueryBranch (0.00s)
=== RUN   TestAuthHandler_RefreshToken_LegacyBodyWithoutTokenAndNoCookie
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Request received. Content-Length: 19
2026/02/18 18:06:01 [AuthHandler] RefreshToken: No cookie found: http: named cookie not present
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Error - No refresh token provided in body/cookie/session
--- PASS: TestAuthHandler_RefreshToken_LegacyBodyWithoutTokenAndNoCookie (0.00s)
=== RUN   TestAuthHandler_RefreshToken_HeaderSessionMiss_FallbackToBody
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Request received. Content-Length: 28
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Token found in JSON body
--- PASS: TestAuthHandler_RefreshToken_HeaderSessionMiss_FallbackToBody (0.00s)
=== RUN   TestChainHandler_ListChains_SuccessAndError
--- PASS: TestChainHandler_ListChains_SuccessAndError (0.00s)
=== RUN   TestChainHandler_ListChains_EmptyItemsBranch
--- PASS: TestChainHandler_ListChains_EmptyItemsBranch (0.00s)
=== RUN   TestChainHandler_CreateUpdateDelete
UpdateChain validation error: unexpected EOF
--- PASS: TestChainHandler_CreateUpdateDelete (0.00s)
=== RUN   TestChainHandler_ErrorPaths
--- PASS: TestChainHandler_ErrorPaths (0.00s)
=== RUN   TestTokenHandler_ErrorPaths
--- PASS: TestTokenHandler_ErrorPaths (0.00s)
=== RUN   TestTokenHandler_CreateAndUpdate_ExtraBranches
--- PASS: TestTokenHandler_CreateAndUpdate_ExtraBranches (0.00s)
=== RUN   TestChainHandler_CRUDAndList
--- PASS: TestChainHandler_CRUDAndList (0.00s)
=== RUN   TestChainHandler_InvalidInputs
--- PASS: TestChainHandler_InvalidInputs (0.00s)
=== RUN   TestTokenHandler_CoreFlows
--- PASS: TestTokenHandler_CoreFlows (0.00s)
=== RUN   TestTokenHandler_InvalidInputs
--- PASS: TestTokenHandler_InvalidInputs (0.00s)
=== RUN   TestTokenHandler_CreateAndUpdate_LegacyChainFallback
--- PASS: TestTokenHandler_CreateAndUpdate_LegacyChainFallback (0.00s)
=== RUN   TestCrosschainConfigHandler_ValidationPaths
--- PASS: TestCrosschainConfigHandler_ValidationPaths (0.00s)
=== RUN   TestOnchainAdapterHandler_ValidationPaths
--- PASS: TestOnchainAdapterHandler_ValidationPaths (0.00s)
=== RUN   TestContractConfigAuditHandler_ValidationPaths
--- PASS: TestContractConfigAuditHandler_ValidationPaths (0.00s)
=== RUN   TestContractConfigAuditHandler_CheckAndByContract
--- PASS: TestContractConfigAuditHandler_CheckAndByContract (0.00s)
=== RUN   TestCrosschainConfigHandler_BulkSuccessFlows
--- PASS: TestCrosschainConfigHandler_BulkSuccessFlows (0.00s)
=== RUN   TestCrosschainConfigHandler_BulkRoutes_ErrorItems
--- PASS: TestCrosschainConfigHandler_BulkRoutes_ErrorItems (0.00s)
=== RUN   TestCrosschainConfigHandler_RecheckAutoFixPreflight_UsecaseErrors
--- PASS: TestCrosschainConfigHandler_RecheckAutoFixPreflight_UsecaseErrors (0.00s)
=== RUN   TestCrosschainConfigHandler_SuccessFlows_Gap
--- PASS: TestCrosschainConfigHandler_SuccessFlows_Gap (0.00s)
=== RUN   TestCrosschainConfigHandler_OverviewAndValidation
--- PASS: TestCrosschainConfigHandler_OverviewAndValidation (0.00s)
=== RUN   TestCrosschainPolicyHandler_CreateRoutePolicy_ValidationMatrix
--- PASS: TestCrosschainPolicyHandler_CreateRoutePolicy_ValidationMatrix (0.00s)
=== RUN   TestCrosschainPolicyHandler_CRUDSuccessPaths
--- PASS: TestCrosschainPolicyHandler_CRUDSuccessPaths (0.00s)
=== RUN   TestCrosschainPolicyHandler_CreateRoutePolicy_DefaultFallbackValues
--- PASS: TestCrosschainPolicyHandler_CreateRoutePolicy_DefaultFallbackValues (0.00s)
=== RUN   TestCrosschainPolicyHandler_CreateLayerZeroConfig_NormalizationDefaults
--- PASS: TestCrosschainPolicyHandler_CreateLayerZeroConfig_NormalizationDefaults (0.00s)
=== RUN   TestCrosschainPolicyHandler_CreateUpdate_ExtraBranches
--- PASS: TestCrosschainPolicyHandler_CreateUpdate_ExtraBranches (0.00s)
=== RUN   TestCrosschainPolicyHandler_ErrorMatrix
--- PASS: TestCrosschainPolicyHandler_ErrorMatrix (0.00s)
=== RUN   TestCrosschainPolicyHandler_GapValidationBranches
=== RUN   TestCrosschainPolicyHandler_GapValidationBranches/list_route_invalid_dest_query
=== RUN   TestCrosschainPolicyHandler_GapValidationBranches/update_route_invalid_json_bind
=== RUN   TestCrosschainPolicyHandler_GapValidationBranches/update_route_invalid_source_chain
=== RUN   TestCrosschainPolicyHandler_GapValidationBranches/update_route_invalid_dest_chain
=== RUN   TestCrosschainPolicyHandler_GapValidationBranches/list_layerzero_invalid_dest_query
=== RUN   TestCrosschainPolicyHandler_GapValidationBranches/create_layerzero_invalid_source_chain
=== RUN   TestCrosschainPolicyHandler_GapValidationBranches/create_layerzero_invalid_dest_chain
=== RUN   TestCrosschainPolicyHandler_GapValidationBranches/update_layerzero_invalid_json_bind
=== RUN   TestCrosschainPolicyHandler_GapValidationBranches/update_layerzero_source_equals_dest
--- PASS: TestCrosschainPolicyHandler_GapValidationBranches (0.00s)
    --- PASS: TestCrosschainPolicyHandler_GapValidationBranches/list_route_invalid_dest_query (0.00s)
    --- PASS: TestCrosschainPolicyHandler_GapValidationBranches/update_route_invalid_json_bind (0.00s)
    --- PASS: TestCrosschainPolicyHandler_GapValidationBranches/update_route_invalid_source_chain (0.00s)
    --- PASS: TestCrosschainPolicyHandler_GapValidationBranches/update_route_invalid_dest_chain (0.00s)
    --- PASS: TestCrosschainPolicyHandler_GapValidationBranches/list_layerzero_invalid_dest_query (0.00s)
    --- PASS: TestCrosschainPolicyHandler_GapValidationBranches/create_layerzero_invalid_source_chain (0.00s)
    --- PASS: TestCrosschainPolicyHandler_GapValidationBranches/create_layerzero_invalid_dest_chain (0.00s)
    --- PASS: TestCrosschainPolicyHandler_GapValidationBranches/update_layerzero_invalid_json_bind (0.00s)
    --- PASS: TestCrosschainPolicyHandler_GapValidationBranches/update_layerzero_source_equals_dest (0.00s)
=== RUN   TestCrosschainPolicyHandler_ListAndDeleteSuccess
--- PASS: TestCrosschainPolicyHandler_ListAndDeleteSuccess (0.00s)
=== RUN   TestCrosschainPolicyHandler_UpdateLayerZeroConfig_NormalizationAndOptionalActive
--- PASS: TestCrosschainPolicyHandler_UpdateLayerZeroConfig_NormalizationAndOptionalActive (0.00s)
=== RUN   TestCrosschainPolicyHelpers
--- PASS: TestCrosschainPolicyHelpers (0.00s)
=== RUN   TestCrosschainPolicyHandler_ListRoutePoliciesInvalidQuery
--- PASS: TestCrosschainPolicyHandler_ListRoutePoliciesInvalidQuery (0.00s)
=== RUN   TestCrosschainPolicyHandler_InvalidParamAndBodyBranches
--- PASS: TestCrosschainPolicyHandler_InvalidParamAndBodyBranches (0.00s)
=== RUN   TestMerchantHandler_GapBranches
=== RUN   TestMerchantHandler_GapBranches/apply_unauthorized_with_valid_payload
=== RUN   TestMerchantHandler_GapBranches/apply/get_status_usecase_error_branch
--- PASS: TestMerchantHandler_GapBranches (0.00s)
    --- PASS: TestMerchantHandler_GapBranches/apply_unauthorized_with_valid_payload (0.00s)
    --- PASS: TestMerchantHandler_GapBranches/apply/get_status_usecase_error_branch (0.00s)
=== RUN   TestWalletHandler_SetPrimary_GapBranches
--- PASS: TestWalletHandler_SetPrimary_GapBranches (0.00s)
=== RUN   TestPaymentConfigHandler_UpdateBridgeConfig_GapBranches
--- PASS: TestPaymentConfigHandler_UpdateBridgeConfig_GapBranches (0.00s)
=== RUN   TestChainHandler_UpdateChain_InvalidBodyBranch
UpdateChain validation error: unexpected EOF
--- PASS: TestChainHandler_UpdateChain_InvalidBodyBranch (0.00s)
=== RUN   TestPaymentHandler_GetPayment_GenericErrorBranch
--- PASS: TestPaymentHandler_GetPayment_GenericErrorBranch (0.00s)
=== RUN   TestPaymentRequestHandler_GenericErrorAndPaginationBranches
--- PASS: TestPaymentRequestHandler_GenericErrorAndPaginationBranches (0.00s)
=== RUN   TestSmartContractHandler_GetDelete_GenericErrorBranches
--- PASS: TestSmartContractHandler_GetDelete_GenericErrorBranches (0.00s)
=== RUN   TestAuthHandler_ValidationAndUnauthorizedPaths
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Request received. Content-Length: 0
2026/02/18 18:06:01 [AuthHandler] RefreshToken: Error - No refresh token provided in body/cookie/session
2026/02/18 18:06:01 [AuthHandler] GetMe called for path: /me
2026/02/18 18:06:01 [AuthHandler] GetMe failed: userId not found in context (Middleware key: userId)
--- PASS: TestAuthHandler_ValidationAndUnauthorizedPaths (0.00s)
=== RUN   TestPaymentAndWalletHandlers_ValidationPaths
--- PASS: TestPaymentAndWalletHandlers_ValidationPaths (0.00s)
=== RUN   TestMerchantPaymentRequestApiKeyHandlers_ValidationPaths
--- PASS: TestMerchantPaymentRequestApiKeyHandlers_ValidationPaths (0.00s)
=== RUN   TestMerchantHandler_ApplyAndGetStatus_Success
--- PASS: TestMerchantHandler_ApplyAndGetStatus_Success (0.00s)
=== RUN   TestMerchantHandler_Apply_InvalidTypeMapping
--- PASS: TestMerchantHandler_Apply_InvalidTypeMapping (0.00s)
=== RUN   TestMerchantHandler_GetStatus_ApprovedMessage
--- PASS: TestMerchantHandler_GetStatus_ApprovedMessage (0.00s)
=== RUN   TestMerchantHandler_GetStatus_InternalErrorBranch
--- PASS: TestMerchantHandler_GetStatus_InternalErrorBranch (0.00s)
=== RUN   TestOnchainAdapterHandler_ValidationBranches
--- PASS: TestOnchainAdapterHandler_ValidationBranches (0.00s)
=== RUN   TestPaymentAppAndWebhookHandler_InvalidJSON
--- PASS: TestPaymentAppAndWebhookHandler_InvalidJSON (0.00s)
=== RUN   TestOnchainAdapterHandler_ErrorPathsAfterValidation
--- PASS: TestOnchainAdapterHandler_ErrorPathsAfterValidation (0.00s)
=== RUN   TestOnchainAdapterHandler_SuccessPaths
--- PASS: TestOnchainAdapterHandler_SuccessPaths (0.00s)
=== RUN   TestPaymentAppHandler_CreatePaymentApp
=== RUN   TestPaymentAppHandler_CreatePaymentApp/bad_request
=== RUN   TestPaymentAppHandler_CreatePaymentApp/usecase_error
=== RUN   TestPaymentAppHandler_CreatePaymentApp/success
--- PASS: TestPaymentAppHandler_CreatePaymentApp (0.00s)
    --- PASS: TestPaymentAppHandler_CreatePaymentApp/bad_request (0.00s)
    --- PASS: TestPaymentAppHandler_CreatePaymentApp/usecase_error (0.00s)
    --- PASS: TestPaymentAppHandler_CreatePaymentApp/success (0.00s)
=== RUN   TestPaymentConfigHandler_BridgeConfigCRUD
--- PASS: TestPaymentConfigHandler_BridgeConfigCRUD (0.00s)
=== RUN   TestPaymentConfigHandler_CreateBridgeConfig_DefaultFieldsAndValidation
--- PASS: TestPaymentConfigHandler_CreateBridgeConfig_DefaultFieldsAndValidation (0.00s)
=== RUN   TestPaymentConfigHandler_FeeConfigCRUDAndTokenNotFound
--- PASS: TestPaymentConfigHandler_FeeConfigCRUDAndTokenNotFound (0.00s)
=== RUN   TestPaymentConfigHandler_PaymentBridgeErrorBranches
--- PASS: TestPaymentConfigHandler_PaymentBridgeErrorBranches (0.00s)
=== RUN   TestPaymentConfigHandler_BridgeAndFeeErrorBranches
--- PASS: TestPaymentConfigHandler_BridgeAndFeeErrorBranches (0.00s)
=== RUN   TestPaymentConfigHandler_UpdatePaymentBridge_GetByIDAndBindError
=== RUN   TestPaymentConfigHandler_UpdatePaymentBridge_GetByIDAndBindError/get_by_id_failed
=== RUN   TestPaymentConfigHandler_UpdatePaymentBridge_GetByIDAndBindError/bind_json_failed
--- PASS: TestPaymentConfigHandler_UpdatePaymentBridge_GetByIDAndBindError (0.00s)
    --- PASS: TestPaymentConfigHandler_UpdatePaymentBridge_GetByIDAndBindError/get_by_id_failed (0.00s)
    --- PASS: TestPaymentConfigHandler_UpdatePaymentBridge_GetByIDAndBindError/bind_json_failed (0.00s)
=== RUN   TestPaymentConfigHandler_ListAndCreateFeeConfig_InvalidTokenIDBranches
--- PASS: TestPaymentConfigHandler_ListAndCreateFeeConfig_InvalidTokenIDBranches (0.00s)
=== RUN   TestPaymentConfigHandler_PaymentBridgeCRUD
--- PASS: TestPaymentConfigHandler_PaymentBridgeCRUD (0.00s)
=== RUN   TestPaymentConfigHandler_HelperFunctions
--- PASS: TestPaymentConfigHandler_HelperFunctions (0.00s)
=== RUN   TestPaymentConfigHandler_UpdateFeeConfig_ErrorBranches
=== RUN   TestPaymentConfigHandler_UpdateFeeConfig_ErrorBranches/get_existing_failed
=== RUN   TestPaymentConfigHandler_UpdateFeeConfig_ErrorBranches/bind_json_failed
=== RUN   TestPaymentConfigHandler_UpdateFeeConfig_ErrorBranches/invalid_chain_id
=== RUN   TestPaymentConfigHandler_UpdateFeeConfig_ErrorBranches/invalid_token_id_format
=== RUN   TestPaymentConfigHandler_UpdateFeeConfig_ErrorBranches/token_not_found
--- PASS: TestPaymentConfigHandler_UpdateFeeConfig_ErrorBranches (0.00s)
    --- PASS: TestPaymentConfigHandler_UpdateFeeConfig_ErrorBranches/get_existing_failed (0.00s)
    --- PASS: TestPaymentConfigHandler_UpdateFeeConfig_ErrorBranches/bind_json_failed (0.00s)
    --- PASS: TestPaymentConfigHandler_UpdateFeeConfig_ErrorBranches/invalid_chain_id (0.00s)
    --- PASS: TestPaymentConfigHandler_UpdateFeeConfig_ErrorBranches/invalid_token_id_format (0.00s)
    --- PASS: TestPaymentConfigHandler_UpdateFeeConfig_ErrorBranches/token_not_found (0.00s)
=== RUN   TestPaymentConfigHandler_ParseHelpers
--- PASS: TestPaymentConfigHandler_ParseHelpers (0.00s)
=== RUN   TestPaymentConfigHandler_InvalidBranches
--- PASS: TestPaymentConfigHandler_InvalidBranches (0.00s)
=== RUN   TestPaymentHandler_ListPayments_PaginationNormalization
--- PASS: TestPaymentHandler_ListPayments_PaginationNormalization (0.00s)
=== RUN   TestPaymentHandler_SuccessAndErrorMappings
--- PASS: TestPaymentHandler_SuccessAndErrorMappings (0.00s)
=== RUN   TestPaymentHandler_ValidationAndAuthBranches
--- PASS: TestPaymentHandler_ValidationAndAuthBranches (0.00s)
=== RUN   TestPaymentRequestHandler_ExtraBranches
--- PASS: TestPaymentRequestHandler_ExtraBranches (0.00s)
=== RUN   TestPaymentRequestHandler_SuccessAndErrorMappings
--- PASS: TestPaymentRequestHandler_SuccessAndErrorMappings (0.00s)
=== RUN   TestRouteErrorHandler_GetRouteError_Success
=== PAUSE TestRouteErrorHandler_GetRouteError_Success
=== RUN   TestRouteErrorHandler_GetRouteError_MissingSourceChainID
=== PAUSE TestRouteErrorHandler_GetRouteError_MissingSourceChainID
=== RUN   TestRouteErrorHandler_GetRouteError_UsecaseError
=== PAUSE TestRouteErrorHandler_GetRouteError_UsecaseError
=== RUN   TestRpcHandler_ListRPCs
=== RUN   TestRpcHandler_ListRPCs/invalid_chainId
=== RUN   TestRpcHandler_ListRPCs/invalid_isActive
=== RUN   TestRpcHandler_ListRPCs/repo_error
=== RUN   TestRpcHandler_ListRPCs/success
--- PASS: TestRpcHandler_ListRPCs (0.00s)
    --- PASS: TestRpcHandler_ListRPCs/invalid_chainId (0.00s)
    --- PASS: TestRpcHandler_ListRPCs/invalid_isActive (0.00s)
    --- PASS: TestRpcHandler_ListRPCs/repo_error (0.00s)
    --- PASS: TestRpcHandler_ListRPCs/success (0.00s)
=== RUN   TestSmartContractHandler_Create_InvalidChainIDBranch
--- PASS: TestSmartContractHandler_Create_InvalidChainIDBranch (0.00s)
=== RUN   TestSmartContractHandler_ListAndLookup_AdditionalErrorBranches
--- PASS: TestSmartContractHandler_ListAndLookup_AdditionalErrorBranches (0.00s)
=== RUN   TestSmartContractHandler_ListSmartContracts_UUIDChainFilterAndEmptyType
--- PASS: TestSmartContractHandler_ListSmartContracts_UUIDChainFilterAndEmptyType (0.00s)
=== RUN   TestSmartContractHandler_UpdateAdditionalBranches
--- PASS: TestSmartContractHandler_UpdateAdditionalBranches (0.00s)
=== RUN   TestSmartContractHandler_UpdateAllMutableFields
--- PASS: TestSmartContractHandler_UpdateAllMutableFields (0.00s)
=== RUN   TestSmartContractHandler_Create_WithOptionalFieldsAndUUIDChain
--- PASS: TestSmartContractHandler_Create_WithOptionalFieldsAndUUIDChain (0.00s)
=== RUN   TestSmartContractHandler_CRUDAndLookup
--- PASS: TestSmartContractHandler_CRUDAndLookup (0.00s)
=== RUN   TestSmartContractHandler_ValidationAndErrorBranches
--- PASS: TestSmartContractHandler_ValidationAndErrorBranches (0.00s)
=== RUN   TestTeamHandler_FullFlow
--- PASS: TestTeamHandler_FullFlow (0.00s)
=== RUN   TestTeamHandler_ValidationAndNotFound
--- PASS: TestTeamHandler_ValidationAndNotFound (0.00s)
=== RUN   TestWalletHandler_ConnectWallet_ErrorMapping_Gap
--- PASS: TestWalletHandler_ConnectWallet_ErrorMapping_Gap (0.00s)
=== RUN   TestWalletHandler_SuccessFlow
--- PASS: TestWalletHandler_SuccessFlow (0.00s)
=== RUN   TestWalletHandler_ErrorMapping
--- PASS: TestWalletHandler_ErrorMapping (0.00s)
=== RUN   TestWalletHandler_ConnectWallet_ErrorPaths
--- PASS: TestWalletHandler_ConnectWallet_ErrorPaths (0.00s)
=== RUN   TestWalletHandler_ListAndDisconnect_ErrorBranches
--- PASS: TestWalletHandler_ListAndDisconnect_ErrorBranches (0.00s)
=== RUN   TestWebhookHandler_HandleIndexerWebhook
=== RUN   TestWebhookHandler_HandleIndexerWebhook/bad_request
=== RUN   TestWebhookHandler_HandleIndexerWebhook/usecase_error
=== RUN   TestWebhookHandler_HandleIndexerWebhook/success
--- PASS: TestWebhookHandler_HandleIndexerWebhook (0.00s)
    --- PASS: TestWebhookHandler_HandleIndexerWebhook/bad_request (0.00s)
    --- PASS: TestWebhookHandler_HandleIndexerWebhook/usecase_error (0.00s)
    --- PASS: TestWebhookHandler_HandleIndexerWebhook/success (0.00s)
=== CONT  TestRouteErrorHandler_GetRouteError_Success
=== CONT  TestRouteErrorHandler_GetRouteError_UsecaseError
--- PASS: TestRouteErrorHandler_GetRouteError_UsecaseError (0.00s)
--- PASS: TestRouteErrorHandler_GetRouteError_Success (0.00s)
=== CONT  TestRouteErrorHandler_GetRouteError_MissingSourceChainID
--- PASS: TestRouteErrorHandler_GetRouteError_MissingSourceChainID (0.00s)
PASS
ok  	pay-chain.backend/internal/interfaces/http/handlers	(cached)
=== RUN   TestAuthAndDualMiddleware_InternalCoveragePaths
=== RUN   TestAuthAndDualMiddleware_InternalCoveragePaths/auth_middleware_trusted_session_and_expired_bearer
2026/02/18 18:07:12 [AuthMiddleware] Authenticated user trusted@paychain.io with role USER for /ok
2026/02/18 18:07:12 [AuthMiddleware] Token validation failed for /expired: token has expired
=== RUN   TestAuthAndDualMiddleware_InternalCoveragePaths/dual_auth_trusted_session_body_restore_and_optional_signature_branch
2026/02/18 18:07:12 [DualAuth] JWT Signature validation failed (session flow): unauthorized
--- PASS: TestAuthAndDualMiddleware_InternalCoveragePaths (0.00s)
    --- PASS: TestAuthAndDualMiddleware_InternalCoveragePaths/auth_middleware_trusted_session_and_expired_bearer (0.00s)
    --- PASS: TestAuthAndDualMiddleware_InternalCoveragePaths/dual_auth_trusted_session_body_restore_and_optional_signature_branch (0.00s)
=== RUN   TestAuthAndDualMiddleware_InternalCoveragePaths_StrictBranchAssertions
=== RUN   TestAuthAndDualMiddleware_InternalCoveragePaths_StrictBranchAssertions/auth_trusted_session_and_expired_bearer
2026/02/18 18:07:12 [AuthMiddleware] Authenticated user trusted2@paychain.io with role USER for /ok
2026/02/18 18:07:12 [AuthMiddleware] Token validation failed for /expired: token has expired
=== RUN   TestAuthAndDualMiddleware_InternalCoveragePaths_StrictBranchAssertions/dual_auth_session_with_optional_signature_verification
2026/02/18 18:07:12 [DualAuth] JWT Signature validation failed (session flow): unauthorized
--- PASS: TestAuthAndDualMiddleware_InternalCoveragePaths_StrictBranchAssertions (0.00s)
    --- PASS: TestAuthAndDualMiddleware_InternalCoveragePaths_StrictBranchAssertions/auth_trusted_session_and_expired_bearer (0.00s)
    --- PASS: TestAuthAndDualMiddleware_InternalCoveragePaths_StrictBranchAssertions/dual_auth_session_with_optional_signature_verification (0.00s)
=== RUN   TestContextGetters
--- PASS: TestContextGetters (0.00s)
=== RUN   TestRequireRolePaths
=== RUN   TestRequireRolePaths/unauthorized_when_no_role
=== RUN   TestRequireRolePaths/forbidden_when_role_not_allowed
=== RUN   TestRequireRolePaths/success_with_allowed_role
--- PASS: TestRequireRolePaths (0.00s)
    --- PASS: TestRequireRolePaths/unauthorized_when_no_role (0.00s)
    --- PASS: TestRequireRolePaths/forbidden_when_role_not_allowed (0.00s)
    --- PASS: TestRequireRolePaths/success_with_allowed_role (0.00s)
=== RUN   TestIsTrustedProxyRequest
--- PASS: TestIsTrustedProxyRequest (0.00s)
=== RUN   TestAuthMiddleware_SessionAndBearerBranchMatrix
2026/02/18 18:07:12 [AuthMiddleware] Authenticated user matrix@paychain.io with role USER for /me
2026/02/18 18:07:12 [AuthMiddleware] Request to /me failed: No valid session or token found
--- PASS: TestAuthMiddleware_SessionAndBearerBranchMatrix (0.00s)
=== RUN   TestAuthMiddleware_SessionHeader_WithNilStore_NoPanic
2026/02/18 18:07:12 [AuthMiddleware] Request to /me failed: No valid session or token found
--- PASS: TestAuthMiddleware_SessionHeader_WithNilStore_NoPanic (0.00s)
=== RUN   TestAuthMiddleware_SessionTokenPrecedenceOverBearer
2026/02/18 18:07:12 [AuthMiddleware] Authenticated user session@paychain.io with role USER for /me
--- PASS: TestAuthMiddleware_SessionTokenPrecedenceOverBearer (0.00s)
=== RUN   TestAuthMiddleware_SessionInvalidToken_NoBearerFallback
2026/02/18 18:07:12 [AuthMiddleware] Token validation failed for /me: invalid token
--- PASS: TestAuthMiddleware_SessionInvalidToken_NoBearerFallback (0.00s)
=== RUN   TestAuthMiddleware_SessionBranches
2026/02/18 18:07:12 [AuthMiddleware] Request to /me failed: No valid session or token found
2026/02/18 18:07:12 [AuthMiddleware] Request to /me failed: No valid session or token found
2026/02/18 18:07:12 [AuthMiddleware] Request to /me failed: No valid session or token found
2026/02/18 18:07:12 [AuthMiddleware] Token validation failed for /me: invalid token
--- PASS: TestAuthMiddleware_SessionBranches (0.00s)
=== RUN   TestAuthMiddleware_ExpiredToken_FromSessionFlow
2026/02/18 18:07:12 [AuthMiddleware] Token validation failed for /me: token has expired
--- PASS: TestAuthMiddleware_ExpiredToken_FromSessionFlow (0.00s)
=== RUN   TestAuthMiddleware_StrictMode_UntrustedSessionAndBearerBlocked
2026/02/18 18:07:12 [AuthMiddleware] Request to /me failed: No valid session or token found
--- PASS: TestAuthMiddleware_StrictMode_UntrustedSessionAndBearerBlocked (0.00s)
=== RUN   TestAuthMiddleware_StrictMode_TrustedSessionSuccess_AndExpiredBearerBranch
2026/02/18 18:07:12 [AuthMiddleware] Authenticated user session-success@x.com with role USER for /me
2026/02/18 18:07:12 [AuthMiddleware] Token validation failed for /me: token has expired
--- PASS: TestAuthMiddleware_StrictMode_TrustedSessionSuccess_AndExpiredBearerBranch (0.00s)
=== RUN   TestAuthMiddleware_BearerFlow
=== RUN   TestAuthMiddleware_BearerFlow/missing_token
2026/02/18 18:07:12 [AuthMiddleware] Request to /me failed: No valid session or token found
=== RUN   TestAuthMiddleware_BearerFlow/invalid_token
2026/02/18 18:07:12 [AuthMiddleware] Token validation failed for /me: invalid token
=== RUN   TestAuthMiddleware_BearerFlow/valid_token
2026/02/18 18:07:12 [AuthMiddleware] Authenticated user u@paychain.io with role USER for /me
--- PASS: TestAuthMiddleware_BearerFlow (0.00s)
    --- PASS: TestAuthMiddleware_BearerFlow/missing_token (0.00s)
    --- PASS: TestAuthMiddleware_BearerFlow/invalid_token (0.00s)
    --- PASS: TestAuthMiddleware_BearerFlow/valid_token (0.00s)
=== RUN   TestAuthMiddleware_StrictModeBlocksBearerFallback
2026/02/18 18:07:12 [AuthMiddleware] Request to /me failed: No valid session or token found
--- PASS: TestAuthMiddleware_StrictModeBlocksBearerFallback (0.00s)
=== RUN   TestAuthMiddleware_StrictModeSessionFlowAndExpiredToken
2026/02/18 18:07:12 [AuthMiddleware] Authenticated user u@paychain.io with role USER for /me
2026/02/18 18:07:12 [AuthMiddleware] Token validation failed for /me: token has expired
--- PASS: TestAuthMiddleware_StrictModeSessionFlowAndExpiredToken (0.00s)
=== RUN   TestLoadSessionFromStore_WrapperExecutes
--- PASS: TestLoadSessionFromStore_WrapperExecutes (0.00s)
=== RUN   TestIdempotencyMiddleware_NoHeaderPassthrough
--- PASS: TestIdempotencyMiddleware_NoHeaderPassthrough (0.00s)
=== RUN   TestIdempotencyMiddleware_RedisErrorPassthrough
redis: 2026/02/18 18:07:13 pool.go:426: redis: connection pool: failed to dial after 5 attempts: dial tcp 127.0.0.1:0: connect: can't assign requested address
redis: 2026/02/18 18:07:14 pool.go:426: redis: connection pool: failed to dial after 5 attempts: dial tcp 127.0.0.1:0: connect: can't assign requested address
redis: 2026/02/18 18:07:14 pool.go:426: redis: connection pool: failed to dial after 5 attempts: dial tcp 127.0.0.1:0: connect: can't assign requested address
redis: 2026/02/18 18:07:15 pool.go:426: redis: connection pool: failed to dial after 5 attempts: dial tcp 127.0.0.1:0: connect: can't assign requested address
--- PASS: TestIdempotencyMiddleware_RedisErrorPassthrough (2.09s)
=== RUN   TestIdempotencyMiddleware_ProcessingConflict
--- PASS: TestIdempotencyMiddleware_ProcessingConflict (0.00s)
=== RUN   TestIdempotencyMiddleware_CachedHitReturnsBody
--- PASS: TestIdempotencyMiddleware_CachedHitReturnsBody (0.00s)
=== RUN   TestIdempotencyMiddleware_StoresAndReplaysSuccess
--- PASS: TestIdempotencyMiddleware_StoresAndReplaysSuccess (0.00s)
=== RUN   TestIdempotencyMiddleware_DeletesKeyOnFailure
--- PASS: TestIdempotencyMiddleware_DeletesKeyOnFailure (0.00s)
=== RUN   TestIdempotencyMiddleware_WithHookedRedis
=== RUN   TestIdempotencyMiddleware_WithHookedRedis/processing_conflict
=== RUN   TestIdempotencyMiddleware_WithHookedRedis/cached_response
=== RUN   TestIdempotencyMiddleware_WithHookedRedis/setnx_conflict_and_fail_path_cleanup
=== RUN   TestIdempotencyMiddleware_WithHookedRedis/redis_read_error_passthrough
=== RUN   TestIdempotencyMiddleware_WithHookedRedis/setnx_error_returns_conflict
--- PASS: TestIdempotencyMiddleware_WithHookedRedis (0.00s)
    --- PASS: TestIdempotencyMiddleware_WithHookedRedis/processing_conflict (0.00s)
    --- PASS: TestIdempotencyMiddleware_WithHookedRedis/cached_response (0.00s)
    --- PASS: TestIdempotencyMiddleware_WithHookedRedis/setnx_conflict_and_fail_path_cleanup (0.00s)
    --- PASS: TestIdempotencyMiddleware_WithHookedRedis/redis_read_error_passthrough (0.00s)
    --- PASS: TestIdempotencyMiddleware_WithHookedRedis/setnx_error_returns_conflict (0.00s)
=== RUN   TestResponseWriter_Write
--- PASS: TestResponseWriter_Write (0.00s)
=== RUN   TestRequestIDMiddleware_GeneratesAndUsesHeader
=== RUN   TestRequestIDMiddleware_GeneratesAndUsesHeader/generates_request_id_when_header_missing
=== RUN   TestRequestIDMiddleware_GeneratesAndUsesHeader/uses_provided_request_id_header
--- PASS: TestRequestIDMiddleware_GeneratesAndUsesHeader (0.00s)
    --- PASS: TestRequestIDMiddleware_GeneratesAndUsesHeader/generates_request_id_when_header_missing (0.00s)
    --- PASS: TestRequestIDMiddleware_GeneratesAndUsesHeader/uses_provided_request_id_header (0.00s)
=== RUN   TestLoggerMiddleware_Executes
{"level":"info","timestamp":"2026-02-18T18:07:15.079+0700","caller":"middleware/logger.go:30","msg":"HTTP Request","method":"GET","path":"/x?foo=bar","status":201,"latency":0.000000875,"client_ip":"192.0.2.1"}
--- PASS: TestLoggerMiddleware_Executes (0.00s)
=== RUN   TestAuthMiddleware_SessionHookAndExpiredBearer
2026/02/18 18:07:15 [AuthMiddleware] Authenticated user session-hook@paychain.io with role USER for /me
2026/02/18 18:07:15 [AuthMiddleware] Token validation failed for /me: token has expired
--- PASS: TestAuthMiddleware_SessionHookAndExpiredBearer (0.00s)
=== RUN   TestDualAuthMiddleware_SessionHookAndOptionalSignatureBranch
2026/02/18 18:07:15 [DualAuth] JWT Signature validation failed (session flow): unauthorized
--- PASS: TestDualAuthMiddleware_SessionHookAndOptionalSignatureBranch (0.00s)
=== RUN   TestDualAuthMiddleware_ExtraBranches
--- PASS: TestDualAuthMiddleware_ExtraBranches (0.00s)
=== RUN   TestDualAuthMiddleware_SessionHeader_WithNilStore_NoPanic
--- PASS: TestDualAuthMiddleware_SessionHeader_WithNilStore_NoPanic (0.00s)
=== RUN   TestDualAuthMiddleware_SessionTokenPrecedenceOverBearer
--- PASS: TestDualAuthMiddleware_SessionTokenPrecedenceOverBearer (0.00s)
=== RUN   TestDualAuthMiddleware_SessionInvalidToken_NoBearerFallback
2026/02/18 18:07:15 [DualAuth] JWT validation failed: invalid token
--- PASS: TestDualAuthMiddleware_SessionInvalidToken_NoBearerFallback (0.00s)
=== RUN   TestDualAuthMiddleware_ExpiredToken_FromSessionFlow
2026/02/18 18:07:15 [DualAuth] JWT validation failed: token has expired
--- PASS: TestDualAuthMiddleware_ExpiredToken_FromSessionFlow (0.00s)
=== RUN   TestDualAuthMiddleware_StrictMode_BlocksBearerFallback
--- PASS: TestDualAuthMiddleware_StrictMode_BlocksBearerFallback (0.00s)
=== RUN   TestDualAuthMiddleware_TrustedSession_WithBodyAndOptionalSignatureValidation
--- PASS: TestDualAuthMiddleware_TrustedSession_WithBodyAndOptionalSignatureValidation (0.00s)
=== RUN   TestDualAuthMiddleware_TrustedSession_WithOptionalSignatureValidationSuccess
--- PASS: TestDualAuthMiddleware_TrustedSession_WithOptionalSignatureValidationSuccess (0.00s)
=== RUN   TestDualAuthMiddleware_ApiKey
--- PASS: TestDualAuthMiddleware_ApiKey (0.00s)
=== RUN   TestDualAuthMiddleware_JWT
    dual_auth_test.go:171: 
        	Error Trace:	/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/interfaces/http/middleware/dual_auth_test.go:171
        	Error:      	"{\"error\":\"Authentication required (JWT or API Key)\"}" does not contain "Signature and timestamp are required"
        	Test:       	TestDualAuthMiddleware_JWT
--- FAIL: TestDualAuthMiddleware_JWT (0.00s)
=== RUN   TestDualAuthMiddleware_JWTWithSignature
    dual_auth_test.go:224: 
        	Error Trace:	/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/interfaces/http/middleware/dual_auth_test.go:224
        	Error:      	Not equal: 
        	            	expected: 200
        	            	actual  : 401
        	Test:       	TestDualAuthMiddleware_JWTWithSignature
    dual_auth_test.go:225: 
        	Error Trace:	/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/interfaces/http/middleware/dual_auth_test.go:225
        	Error:      	"{\"error\":\"Authentication required (JWT or API Key)\"}" does not contain "73f02586-9942-4d8d-84f0-3e1243c57eb7"
        	Test:       	TestDualAuthMiddleware_JWTWithSignature
--- FAIL: TestDualAuthMiddleware_JWTWithSignature (0.00s)
=== RUN   TestDualAuthMiddleware_RequestBodyReadError
--- PASS: TestDualAuthMiddleware_RequestBodyReadError (0.00s)
=== RUN   TestDualAuthMiddleware_ApiKeyInvalid
2026/02/18 18:07:15 [DualAuth] API Key validation failed: unauthorized
--- PASS: TestDualAuthMiddleware_ApiKeyInvalid (0.00s)
=== RUN   TestDualAuthMiddleware_JWTInvalidToken_AndNoAuth
    dual_auth_test.go:287: 
        	Error Trace:	/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/interfaces/http/middleware/dual_auth_test.go:287
        	Error:      	"{\"error\":\"Authentication required (JWT or API Key)\"}" does not contain "Invalid token"
        	Test:       	TestDualAuthMiddleware_JWTInvalidToken_AndNoAuth
--- FAIL: TestDualAuthMiddleware_JWTInvalidToken_AndNoAuth (0.00s)
=== RUN   TestDualAuthMiddleware_StrictSessionModeWithoutTrustedSession
--- PASS: TestDualAuthMiddleware_StrictSessionModeWithoutTrustedSession (0.00s)
=== RUN   TestDualAuthMiddleware_JWTExpired
2026/02/18 18:07:15 [DualAuth] JWT validation failed: token has expired
--- PASS: TestDualAuthMiddleware_JWTExpired (0.00s)
=== RUN   TestDualAuthMiddleware_JWTInvalidSignature
2026/02/18 18:07:15 [DualAuth] JWT Signature validation failed: unauthorized
--- PASS: TestDualAuthMiddleware_JWTInvalidSignature (0.00s)
=== RUN   TestDualAuthMiddleware_TrustedSessionFlow_AndOptionalSignature
2026/02/18 18:07:15 [DualAuth] JWT Signature validation failed (session flow): unauthorized
--- PASS: TestDualAuthMiddleware_TrustedSessionFlow_AndOptionalSignature (0.00s)
FAIL
FAIL	pay-chain.backend/internal/interfaces/http/middleware	2.692s
=== RUN   TestSuccess
--- PASS: TestSuccess (0.00s)
=== RUN   TestError_AppError
--- PASS: TestError_AppError (0.00s)
=== RUN   TestError_GenericError
--- PASS: TestError_GenericError (0.00s)
=== RUN   TestErrorWithError
--- PASS: TestErrorWithError (0.00s)
PASS
ok  	pay-chain.backend/internal/interfaces/http/response	(cached)
=== RUN   TestApiKeyHelpers_GenerateRandomHex_Error
--- PASS: TestApiKeyHelpers_GenerateRandomHex_Error (0.00s)
=== RUN   TestApiKeyHelpers_Encrypt_ReadNonceError
--- PASS: TestApiKeyHelpers_Encrypt_ReadNonceError (0.00s)
=== RUN   TestApiKeyHelpers_Decrypt_MalformedCiphertext
--- PASS: TestApiKeyHelpers_Decrypt_MalformedCiphertext (0.00s)
=== RUN   TestApiKeyHelpers_DecryptBranches
--- PASS: TestApiKeyHelpers_DecryptBranches (0.00s)
=== RUN   TestApiKeyUsecase_CreateApiKey_RandomFailureBranches
=== RUN   TestApiKeyUsecase_CreateApiKey_RandomFailureBranches/first_random_call_failed
=== RUN   TestApiKeyUsecase_CreateApiKey_RandomFailureBranches/second_random_call_failed
--- PASS: TestApiKeyUsecase_CreateApiKey_RandomFailureBranches (0.00s)
    --- PASS: TestApiKeyUsecase_CreateApiKey_RandomFailureBranches/first_random_call_failed (0.00s)
    --- PASS: TestApiKeyUsecase_CreateApiKey_RandomFailureBranches/second_random_call_failed (0.00s)
=== RUN   TestApiKeyUsecase_ValidateApiKey_DecryptInvalidCipherKeyBranch
--- PASS: TestApiKeyUsecase_ValidateApiKey_DecryptInvalidCipherKeyBranch (0.00s)
=== RUN   TestApiKeyUsecase_EncryptDecrypt_ErrorBranches
=== RUN   TestApiKeyUsecase_EncryptDecrypt_ErrorBranches/encrypt_nonce_read_error
=== RUN   TestApiKeyUsecase_EncryptDecrypt_ErrorBranches/decrypt_malformed_ciphertext
=== RUN   TestApiKeyUsecase_EncryptDecrypt_ErrorBranches/decrypt_auth_open_error
=== RUN   TestApiKeyUsecase_EncryptDecrypt_ErrorBranches/decrypt_success
=== RUN   TestApiKeyUsecase_EncryptDecrypt_ErrorBranches/encrypt_invalid_key_size
=== RUN   TestApiKeyUsecase_EncryptDecrypt_ErrorBranches/encrypt_gcm_construction_error
=== RUN   TestApiKeyUsecase_EncryptDecrypt_ErrorBranches/decrypt_invalid_hex
=== RUN   TestApiKeyUsecase_EncryptDecrypt_ErrorBranches/decrypt_invalid_key_size
=== RUN   TestApiKeyUsecase_EncryptDecrypt_ErrorBranches/decrypt_gcm_construction_error
--- PASS: TestApiKeyUsecase_EncryptDecrypt_ErrorBranches (0.00s)
    --- PASS: TestApiKeyUsecase_EncryptDecrypt_ErrorBranches/encrypt_nonce_read_error (0.00s)
    --- PASS: TestApiKeyUsecase_EncryptDecrypt_ErrorBranches/decrypt_malformed_ciphertext (0.00s)
    --- PASS: TestApiKeyUsecase_EncryptDecrypt_ErrorBranches/decrypt_auth_open_error (0.00s)
    --- PASS: TestApiKeyUsecase_EncryptDecrypt_ErrorBranches/decrypt_success (0.00s)
    --- PASS: TestApiKeyUsecase_EncryptDecrypt_ErrorBranches/encrypt_invalid_key_size (0.00s)
    --- PASS: TestApiKeyUsecase_EncryptDecrypt_ErrorBranches/encrypt_gcm_construction_error (0.00s)
    --- PASS: TestApiKeyUsecase_EncryptDecrypt_ErrorBranches/decrypt_invalid_hex (0.00s)
    --- PASS: TestApiKeyUsecase_EncryptDecrypt_ErrorBranches/decrypt_invalid_key_size (0.00s)
    --- PASS: TestApiKeyUsecase_EncryptDecrypt_ErrorBranches/decrypt_gcm_construction_error (0.00s)
=== RUN   TestAuthUsecase_Hook_RegisterHashAndTokenErrors
=== RUN   TestAuthUsecase_Hook_RegisterHashAndTokenErrors/hash_password_error
=== RUN   TestAuthUsecase_Hook_RegisterHashAndTokenErrors/generate_verification_token_error
--- PASS: TestAuthUsecase_Hook_RegisterHashAndTokenErrors (0.26s)
    --- PASS: TestAuthUsecase_Hook_RegisterHashAndTokenErrors/hash_password_error (0.00s)
    --- PASS: TestAuthUsecase_Hook_RegisterHashAndTokenErrors/generate_verification_token_error (0.26s)
=== RUN   TestAuthUsecase_Hook_LoginBranches
=== RUN   TestAuthUsecase_Hook_LoginBranches/generate_token_pair_error
=== RUN   TestAuthUsecase_Hook_LoginBranches/session_json_marshal_error
=== RUN   TestAuthUsecase_Hook_LoginBranches/session_success_branch_without_redis_server
--- PASS: TestAuthUsecase_Hook_LoginBranches (1.08s)
    --- PASS: TestAuthUsecase_Hook_LoginBranches/generate_token_pair_error (0.31s)
    --- PASS: TestAuthUsecase_Hook_LoginBranches/session_json_marshal_error (0.25s)
    --- PASS: TestAuthUsecase_Hook_LoginBranches/session_success_branch_without_redis_server (0.26s)
=== RUN   TestSelectorComputation
=== RUN   TestSelectorComputation/CreatePaymentSelector_matches_expected_value
=== RUN   TestSelectorComputation/PayRequestSelector_matches_expected_value
=== RUN   TestSelectorComputation/CreatePaymentWithSlippageSelector_is_computed
=== RUN   TestSelectorComputation/computeSelectorHex_produces_correct_format
--- PASS: TestSelectorComputation (0.00s)
    --- PASS: TestSelectorComputation/CreatePaymentSelector_matches_expected_value (0.00s)
    --- PASS: TestSelectorComputation/PayRequestSelector_matches_expected_value (0.00s)
    --- PASS: TestSelectorComputation/CreatePaymentWithSlippageSelector_is_computed (0.00s)
    --- PASS: TestSelectorComputation/computeSelectorHex_produces_correct_format (0.00s)
=== RUN   TestCallUint8View_ErrorAndSuccessBranches
--- PASS: TestCallUint8View_ErrorAndSuccessBranches (0.00s)
=== RUN   TestContractConfigAudit_CallViewHelpers_WithInjectedClient
--- PASS: TestContractConfigAudit_CallViewHelpers_WithInjectedClient (0.00s)
=== RUN   TestContractConfigAudit_CallViewHelpers_ErrorBranches_WithInjectedClient
--- PASS: TestContractConfigAudit_CallViewHelpers_ErrorBranches_WithInjectedClient (0.00s)
=== RUN   TestCallViewHelpers_Success
--- PASS: TestCallViewHelpers_Success (0.00s)
=== RUN   TestCallViewHelpers_ParseAndDecodeError
--- PASS: TestCallViewHelpers_ParseAndDecodeError (0.00s)
=== RUN   TestCallViewHelpers_PackAndClientErrorBranches
--- PASS: TestCallViewHelpers_PackAndClientErrorBranches (0.00s)
=== RUN   TestCallViewHelpers_TypeAssertionBranches
--- PASS: TestCallViewHelpers_TypeAssertionBranches (0.00s)
=== RUN   TestCallUint64View_DecodeErrorBranch
--- PASS: TestCallUint64View_DecodeErrorBranch (0.00s)
=== RUN   TestCallViewHelpers_AddressAndBytesSuccess
--- PASS: TestCallViewHelpers_AddressAndBytesSuccess (0.00s)
=== RUN   TestCallViewHelpers_AddressAndBytes_ErrorBranches
--- PASS: TestCallViewHelpers_AddressAndBytes_ErrorBranches (0.00s)
=== RUN   TestContractConfigAuditUsecase_CheckByContractID_EvmDestinationSortingAndOnchainBranch
--- PASS: TestContractConfigAuditUsecase_CheckByContractID_EvmDestinationSortingAndOnchainBranch (0.00s)
=== RUN   TestRunEVMOnchainChecks_CoreAndReadFailureBranches
--- PASS: TestRunEVMOnchainChecks_CoreAndReadFailureBranches (0.00s)
=== RUN   TestRunEVMOnchainChecks_HyperbridgeBranches
=== RUN   TestRunEVMOnchainChecks_HyperbridgeBranches/adapter_zero
=== RUN   TestRunEVMOnchainChecks_HyperbridgeBranches/configured_false
=== RUN   TestRunEVMOnchainChecks_HyperbridgeBranches/fallback_configured_from_bytes
--- PASS: TestRunEVMOnchainChecks_HyperbridgeBranches (0.00s)
    --- PASS: TestRunEVMOnchainChecks_HyperbridgeBranches/adapter_zero (0.00s)
    --- PASS: TestRunEVMOnchainChecks_HyperbridgeBranches/configured_false (0.00s)
    --- PASS: TestRunEVMOnchainChecks_HyperbridgeBranches/fallback_configured_from_bytes (0.00s)
=== RUN   TestRunEVMOnchainChecks_CCIPBranches
=== RUN   TestRunEVMOnchainChecks_CCIPBranches/adapter_zero
=== RUN   TestRunEVMOnchainChecks_CCIPBranches/selector_and_destination_missing
--- PASS: TestRunEVMOnchainChecks_CCIPBranches (0.00s)
    --- PASS: TestRunEVMOnchainChecks_CCIPBranches/adapter_zero (0.00s)
    --- PASS: TestRunEVMOnchainChecks_CCIPBranches/selector_and_destination_missing (0.00s)
=== RUN   TestRunEVMOnchainChecks_GatewayOrRouterMissingBranches
=== RUN   TestRunEVMOnchainChecks_GatewayOrRouterMissingBranches/gateway_missing_only
=== RUN   TestRunEVMOnchainChecks_GatewayOrRouterMissingBranches/router_missing_only
--- PASS: TestRunEVMOnchainChecks_GatewayOrRouterMissingBranches (0.00s)
    --- PASS: TestRunEVMOnchainChecks_GatewayOrRouterMissingBranches/gateway_missing_only (0.00s)
    --- PASS: TestRunEVMOnchainChecks_GatewayOrRouterMissingBranches/router_missing_only (0.00s)
=== RUN   TestRunEVMOnchainChecks_AdapterAndBridgeBranches
=== RUN   TestRunEVMOnchainChecks_AdapterAndBridgeBranches/adapter_not_registered
=== RUN   TestRunEVMOnchainChecks_AdapterAndBridgeBranches/hyperbridge_fallback_not_configured_due_empty_bytes
=== RUN   TestRunEVMOnchainChecks_AdapterAndBridgeBranches/hyperbridge_fallback_read_failed
=== RUN   TestRunEVMOnchainChecks_AdapterAndBridgeBranches/hyperbridge_configured
=== RUN   TestRunEVMOnchainChecks_AdapterAndBridgeBranches/ccip_selector+destination_configured
--- PASS: TestRunEVMOnchainChecks_AdapterAndBridgeBranches (0.00s)
    --- PASS: TestRunEVMOnchainChecks_AdapterAndBridgeBranches/adapter_not_registered (0.00s)
    --- PASS: TestRunEVMOnchainChecks_AdapterAndBridgeBranches/hyperbridge_fallback_not_configured_due_empty_bytes (0.00s)
    --- PASS: TestRunEVMOnchainChecks_AdapterAndBridgeBranches/hyperbridge_fallback_read_failed (0.00s)
    --- PASS: TestRunEVMOnchainChecks_AdapterAndBridgeBranches/hyperbridge_configured (0.00s)
    --- PASS: TestRunEVMOnchainChecks_AdapterAndBridgeBranches/ccip_selector+destination_configured (0.00s)
=== RUN   TestContractConfigAudit_HelperGapBranches
=== RUN   TestContractConfigAudit_HelperGapBranches/extract_function_names_non-map_and_empty_name
=== RUN   TestContractConfigAudit_HelperGapBranches/callBoolView_pack_error
=== RUN   TestContractConfigAudit_HelperGapBranches/callBoolView_type_assertion_error
=== RUN   TestContractConfigAudit_HelperGapBranches/callAddressView_client_error
=== RUN   TestContractConfigAudit_HelperGapBranches/callBytesView_client_error
--- PASS: TestContractConfigAudit_HelperGapBranches (0.00s)
    --- PASS: TestContractConfigAudit_HelperGapBranches/extract_function_names_non-map_and_empty_name (0.00s)
    --- PASS: TestContractConfigAudit_HelperGapBranches/callBoolView_pack_error (0.00s)
    --- PASS: TestContractConfigAudit_HelperGapBranches/callBoolView_type_assertion_error (0.00s)
    --- PASS: TestContractConfigAudit_HelperGapBranches/callAddressView_client_error (0.00s)
    --- PASS: TestContractConfigAudit_HelperGapBranches/callBytesView_client_error (0.00s)
=== RUN   TestParseABI_Invalid
--- PASS: TestParseABI_Invalid (0.00s)
=== RUN   TestCallViewHelpers_InvalidABI
--- PASS: TestCallViewHelpers_InvalidABI (0.00s)
=== RUN   TestRequiredFunctions
=== RUN   TestRequiredFunctions/gateway
=== RUN   TestRequiredFunctions/router
=== RUN   TestRequiredFunctions/vault
=== RUN   TestRequiredFunctions/token_registry
=== RUN   TestRequiredFunctions/token_swapper
=== RUN   TestRequiredFunctions/ccip_adapter
=== RUN   TestRequiredFunctions/hyperbridge_adapter
=== RUN   TestRequiredFunctions/layerzero_adapter
=== RUN   TestRequiredFunctions/unknown
--- PASS: TestRequiredFunctions (0.00s)
    --- PASS: TestRequiredFunctions/gateway (0.00s)
    --- PASS: TestRequiredFunctions/router (0.00s)
    --- PASS: TestRequiredFunctions/vault (0.00s)
    --- PASS: TestRequiredFunctions/token_registry (0.00s)
    --- PASS: TestRequiredFunctions/token_swapper (0.00s)
    --- PASS: TestRequiredFunctions/ccip_adapter (0.00s)
    --- PASS: TestRequiredFunctions/hyperbridge_adapter (0.00s)
    --- PASS: TestRequiredFunctions/layerzero_adapter (0.00s)
    --- PASS: TestRequiredFunctions/unknown (0.00s)
=== RUN   TestExtractFunctionNames
--- PASS: TestExtractFunctionNames (0.00s)
=== RUN   TestGenerateFieldsFromFunctions
--- PASS: TestGenerateFieldsFromFunctions (0.00s)
=== RUN   TestFindActiveContractByType
--- PASS: TestFindActiveContractByType (0.00s)
=== RUN   TestMergeSummaryAndDeriveOverallStatus
--- PASS: TestMergeSummaryAndDeriveOverallStatus (0.00s)
=== RUN   TestBuildContractReport
--- PASS: TestBuildContractReport (0.00s)
=== RUN   TestRunEVMOnchainChecks_RPCMissing
--- PASS: TestRunEVMOnchainChecks_RPCMissing (0.00s)
=== RUN   TestRunEVMOnchainChecks_RPCConnectFailed
--- PASS: TestRunEVMOnchainChecks_RPCConnectFailed (0.00s)
=== RUN   TestRunEVMOnchainChecks_GatewayRouterMissing
--- PASS: TestRunEVMOnchainChecks_GatewayRouterMissing (0.00s)
=== RUN   TestRunEVMOnchainChecks_DefaultBridgeReadFailed
--- PASS: TestRunEVMOnchainChecks_DefaultBridgeReadFailed (0.00s)
=== RUN   TestRunEVMOnchainChecks_HyperbridgeConfiguredPath
--- PASS: TestRunEVMOnchainChecks_HyperbridgeConfiguredPath (0.00s)
=== RUN   TestRunEVMOnchainChecks_CcipConfiguredPath
--- PASS: TestRunEVMOnchainChecks_CcipConfiguredPath (0.00s)
=== RUN   TestCrosschainConfigUsecase_AutoFix_MoreBranches
=== RUN   TestCrosschainConfigUsecase_AutoFix_MoreBranches/status_error
=== RUN   TestCrosschainConfigUsecase_AutoFix_MoreBranches/missing_adapter_and_invalid_source_chain_input
=== RUN   TestCrosschainConfigUsecase_AutoFix_MoreBranches/ccip_bridge_with_existing_adapter_only_two_skipped_steps
=== RUN   TestCrosschainConfigUsecase_AutoFix_MoreBranches/hyperbridge_destination_contract_derive_failure
=== RUN   TestCrosschainConfigUsecase_AutoFix_MoreBranches/ccip_missing_adapter_contract_in_db
=== RUN   TestCrosschainConfigUsecase_AutoFix_MoreBranches/layerzero_missing_adapter_contract_in_db
=== RUN   TestCrosschainConfigUsecase_AutoFix_MoreBranches/hyperbridge_set_config_error
--- PASS: TestCrosschainConfigUsecase_AutoFix_MoreBranches (0.00s)
    --- PASS: TestCrosschainConfigUsecase_AutoFix_MoreBranches/status_error (0.00s)
    --- PASS: TestCrosschainConfigUsecase_AutoFix_MoreBranches/missing_adapter_and_invalid_source_chain_input (0.00s)
    --- PASS: TestCrosschainConfigUsecase_AutoFix_MoreBranches/ccip_bridge_with_existing_adapter_only_two_skipped_steps (0.00s)
    --- PASS: TestCrosschainConfigUsecase_AutoFix_MoreBranches/hyperbridge_destination_contract_derive_failure (0.00s)
    --- PASS: TestCrosschainConfigUsecase_AutoFix_MoreBranches/ccip_missing_adapter_contract_in_db (0.00s)
    --- PASS: TestCrosschainConfigUsecase_AutoFix_MoreBranches/layerzero_missing_adapter_contract_in_db (0.00s)
    --- PASS: TestCrosschainConfigUsecase_AutoFix_MoreBranches/hyperbridge_set_config_error (0.00s)
=== RUN   TestCrosschainConfigUsecase_CheckFeeQuoteHealth_Matrix
--- PASS: TestCrosschainConfigUsecase_CheckFeeQuoteHealth_Matrix (0.00s)
=== RUN   TestCrosschainConfigUsecase_GapBranches
=== RUN   TestCrosschainConfigUsecase_GapBranches/overview_with_explicit_dest_and_invalid_inputs
=== RUN   TestCrosschainConfigUsecase_GapBranches/recheck_route_invalid_source_and_chain_fetch_failures
=== RUN   TestCrosschainConfigUsecase_GapBranches/preflight_route_error_and_per-bridge_route_config_errors
=== RUN   TestCrosschainConfigUsecase_GapBranches/preflight_ready_row_and_policy_executable
=== RUN   TestCrosschainConfigUsecase_GapBranches/check_fee_quote_health_client_create_error
--- PASS: TestCrosschainConfigUsecase_GapBranches (0.00s)
    --- PASS: TestCrosschainConfigUsecase_GapBranches/overview_with_explicit_dest_and_invalid_inputs (0.00s)
    --- PASS: TestCrosschainConfigUsecase_GapBranches/recheck_route_invalid_source_and_chain_fetch_failures (0.00s)
    --- PASS: TestCrosschainConfigUsecase_GapBranches/preflight_route_error_and_per-bridge_route_config_errors (0.00s)
    --- PASS: TestCrosschainConfigUsecase_GapBranches/preflight_ready_row_and_policy_executable (0.00s)
    --- PASS: TestCrosschainConfigUsecase_GapBranches/check_fee_quote_health_client_create_error (0.00s)
=== RUN   TestCrosschainConfigUsecase_DeriveDestinationContractHex
--- PASS: TestCrosschainConfigUsecase_DeriveDestinationContractHex (0.00s)
=== RUN   TestCrosschainConfigUsecase_DeriveDestinationContractHex_NotFound
--- PASS: TestCrosschainConfigUsecase_DeriveDestinationContractHex_NotFound (0.00s)
=== RUN   TestCrosschainConfigUsecase_DeriveDestinationContractHex_InvalidDestInput
--- PASS: TestCrosschainConfigUsecase_DeriveDestinationContractHex_InvalidDestInput (0.00s)
=== RUN   TestCrosschainConfigUsecase_DeriveDestinationContractHex_InvalidContractAddress
--- PASS: TestCrosschainConfigUsecase_DeriveDestinationContractHex_InvalidContractAddress (0.00s)
=== RUN   TestCrosschainConfigUsecase_CheckFeeQuoteHealth_Guards
--- PASS: TestCrosschainConfigUsecase_CheckFeeQuoteHealth_Guards (0.00s)
=== RUN   TestCrosschainConfigUsecase_EvaluateFeeQuoteHealth_Override
--- PASS: TestCrosschainConfigUsecase_EvaluateFeeQuoteHealth_Override (0.00s)
=== RUN   TestCrosschainConfigUsecase_BuildPreflightRow_Ready
--- PASS: TestCrosschainConfigUsecase_BuildPreflightRow_Ready (0.00s)
=== RUN   TestCrosschainConfigUsecase_InternalHappyAndAutoFixBranch
--- PASS: TestCrosschainConfigUsecase_InternalHappyAndAutoFixBranch (0.01s)
=== RUN   TestBridgeName
--- PASS: TestBridgeName (0.00s)
=== RUN   TestAddressToPaddedBytesHex
--- PASS: TestAddressToPaddedBytesHex (0.00s)
=== RUN   TestDeriveEvmStateMachineHex
--- PASS: TestDeriveEvmStateMachineHex (0.00s)
=== RUN   TestCrosschainConfigUsecase_Overview_GetByIDErrorBranches
--- PASS: TestCrosschainConfigUsecase_Overview_GetByIDErrorBranches (0.00s)
=== RUN   TestCrosschainConfigUsecase_Overview_RecheckErrorRowBranch
--- PASS: TestCrosschainConfigUsecase_Overview_RecheckErrorRowBranch (0.00s)
=== RUN   TestCrosschainConfigUsecase_Overview_Paths
--- PASS: TestCrosschainConfigUsecase_Overview_Paths (0.00s)
=== RUN   TestCrosschainConfigUsecase_Preflight_WithAdapterStub
--- PASS: TestCrosschainConfigUsecase_Preflight_WithAdapterStub (0.00s)
=== RUN   TestCrosschainConfigUsecase_AutoFix_WithAdapterStub
--- PASS: TestCrosschainConfigUsecase_AutoFix_WithAdapterStub (0.00s)
=== RUN   TestCrosschainConfigUsecase_AutoFix_BranchMatrix
=== RUN   TestCrosschainConfigUsecase_AutoFix_BranchMatrix/register_adapter_fail
=== RUN   TestCrosschainConfigUsecase_AutoFix_BranchMatrix/set_default_fail
=== RUN   TestCrosschainConfigUsecase_AutoFix_BranchMatrix/bridge_type_two_skip_route_config
--- PASS: TestCrosschainConfigUsecase_AutoFix_BranchMatrix (0.00s)
    --- PASS: TestCrosschainConfigUsecase_AutoFix_BranchMatrix/register_adapter_fail (0.00s)
    --- PASS: TestCrosschainConfigUsecase_AutoFix_BranchMatrix/set_default_fail (0.00s)
    --- PASS: TestCrosschainConfigUsecase_AutoFix_BranchMatrix/bridge_type_two_skip_route_config (0.00s)
=== RUN   TestCrosschainConfigUsecase_Preflight_ErrorBranches
=== RUN   TestCrosschainConfigUsecase_Preflight_ErrorBranches/invalid_destination_input
=== RUN   TestCrosschainConfigUsecase_Preflight_ErrorBranches/source_chain_load_by_id_error
=== RUN   TestCrosschainConfigUsecase_Preflight_ErrorBranches/destination_chain_load_by_id_error
=== RUN   TestCrosschainConfigUsecase_Preflight_ErrorBranches/adapter_status_fails_on_second_call
--- PASS: TestCrosschainConfigUsecase_Preflight_ErrorBranches (0.00s)
    --- PASS: TestCrosschainConfigUsecase_Preflight_ErrorBranches/invalid_destination_input (0.00s)
    --- PASS: TestCrosschainConfigUsecase_Preflight_ErrorBranches/source_chain_load_by_id_error (0.00s)
    --- PASS: TestCrosschainConfigUsecase_Preflight_ErrorBranches/destination_chain_load_by_id_error (0.00s)
    --- PASS: TestCrosschainConfigUsecase_Preflight_ErrorBranches/adapter_status_fails_on_second_call (0.00s)
=== RUN   TestCrosschainConfigUsecase_RecheckRoute_IssueMatrix
=== RUN   TestCrosschainConfigUsecase_RecheckRoute_IssueMatrix/default_hyperbridge_but_not_configured
=== RUN   TestCrosschainConfigUsecase_RecheckRoute_IssueMatrix/default_ccip_but_not_configured
=== RUN   TestCrosschainConfigUsecase_RecheckRoute_IssueMatrix/default_layerzero_but_not_configured
=== RUN   TestCrosschainConfigUsecase_RecheckRoute_IssueMatrix/adapter_not_registered
--- PASS: TestCrosschainConfigUsecase_RecheckRoute_IssueMatrix (0.00s)
    --- PASS: TestCrosschainConfigUsecase_RecheckRoute_IssueMatrix/default_hyperbridge_but_not_configured (0.00s)
    --- PASS: TestCrosschainConfigUsecase_RecheckRoute_IssueMatrix/default_ccip_but_not_configured (0.00s)
    --- PASS: TestCrosschainConfigUsecase_RecheckRoute_IssueMatrix/default_layerzero_but_not_configured (0.00s)
    --- PASS: TestCrosschainConfigUsecase_RecheckRoute_IssueMatrix/adapter_not_registered (0.00s)
=== RUN   TestCrosschainConfigUsecase_Preflight_FeeQuoteFailedBranch
--- PASS: TestCrosschainConfigUsecase_Preflight_FeeQuoteFailedBranch (0.00s)
=== RUN   TestCrosschainConfigUsecase_Preflight_DefaultLayerZeroPolicyExecutable
--- PASS: TestCrosschainConfigUsecase_Preflight_DefaultLayerZeroPolicyExecutable (0.00s)
=== RUN   TestCrosschainConfigUsecase_Preflight_DefaultCCIPPolicyExecutable
--- PASS: TestCrosschainConfigUsecase_Preflight_DefaultCCIPPolicyExecutable (0.00s)
=== RUN   TestCrosschainConfigUsecase_Preflight_DefaultHyperbridgePolicyExecutable
--- PASS: TestCrosschainConfigUsecase_Preflight_DefaultHyperbridgePolicyExecutable (0.00s)
=== RUN   TestCrosschainConfigUsecase_Preflight_DefaultReadySetsPolicyExecutable
--- PASS: TestCrosschainConfigUsecase_Preflight_DefaultReadySetsPolicyExecutable (0.00s)
=== RUN   TestFormatDecodedRouteErrorForPreflight
=== PAUSE TestFormatDecodedRouteErrorForPreflight
=== RUN   TestEVMAdminOpsService_RegisterAndDefault
--- PASS: TestEVMAdminOpsService_RegisterAndDefault (0.00s)
=== RUN   TestEVMAdminOpsService_SetHyperbridgeConfig
=== RUN   TestEVMAdminOpsService_SetHyperbridgeConfig/adapter_not_registered
=== RUN   TestEVMAdminOpsService_SetHyperbridgeConfig/payload_required
=== RUN   TestEVMAdminOpsService_SetHyperbridgeConfig/success_and_tx_failure
--- PASS: TestEVMAdminOpsService_SetHyperbridgeConfig (0.00s)
    --- PASS: TestEVMAdminOpsService_SetHyperbridgeConfig/adapter_not_registered (0.00s)
    --- PASS: TestEVMAdminOpsService_SetHyperbridgeConfig/payload_required (0.00s)
    --- PASS: TestEVMAdminOpsService_SetHyperbridgeConfig/success_and_tx_failure (0.00s)
=== RUN   TestEVMAdminOpsService_SetCCIPAndLayerZeroConfig
=== RUN   TestEVMAdminOpsService_SetCCIPAndLayerZeroConfig/ccip_success
=== RUN   TestEVMAdminOpsService_SetCCIPAndLayerZeroConfig/layerzero_invalid_peer_and_success
=== RUN   TestEVMAdminOpsService_SetCCIPAndLayerZeroConfig/ccip_adapter_missing_and_payload_required
=== RUN   TestEVMAdminOpsService_SetCCIPAndLayerZeroConfig/layerzero_adapter_lookup_error_and_partial_payload_error
=== RUN   TestEVMAdminOpsService_SetCCIPAndLayerZeroConfig/layerzero_options_only_success
=== RUN   TestEVMAdminOpsService_SetCCIPAndLayerZeroConfig/ccip_selector_tx_error
=== RUN   TestEVMAdminOpsService_SetCCIPAndLayerZeroConfig/ccip_destination_tx_error
=== RUN   TestEVMAdminOpsService_SetCCIPAndLayerZeroConfig/layerzero_adapter_missing
=== RUN   TestEVMAdminOpsService_SetCCIPAndLayerZeroConfig/layerzero_setRoute_tx_error
=== RUN   TestEVMAdminOpsService_SetCCIPAndLayerZeroConfig/layerzero_options_tx_error
=== RUN   TestEVMAdminOpsService_SetCCIPAndLayerZeroConfig/layerzero_payload_required
--- PASS: TestEVMAdminOpsService_SetCCIPAndLayerZeroConfig (0.00s)
    --- PASS: TestEVMAdminOpsService_SetCCIPAndLayerZeroConfig/ccip_success (0.00s)
    --- PASS: TestEVMAdminOpsService_SetCCIPAndLayerZeroConfig/layerzero_invalid_peer_and_success (0.00s)
    --- PASS: TestEVMAdminOpsService_SetCCIPAndLayerZeroConfig/ccip_adapter_missing_and_payload_required (0.00s)
    --- PASS: TestEVMAdminOpsService_SetCCIPAndLayerZeroConfig/layerzero_adapter_lookup_error_and_partial_payload_error (0.00s)
    --- PASS: TestEVMAdminOpsService_SetCCIPAndLayerZeroConfig/layerzero_options_only_success (0.00s)
    --- PASS: TestEVMAdminOpsService_SetCCIPAndLayerZeroConfig/ccip_selector_tx_error (0.00s)
    --- PASS: TestEVMAdminOpsService_SetCCIPAndLayerZeroConfig/ccip_destination_tx_error (0.00s)
    --- PASS: TestEVMAdminOpsService_SetCCIPAndLayerZeroConfig/layerzero_adapter_missing (0.00s)
    --- PASS: TestEVMAdminOpsService_SetCCIPAndLayerZeroConfig/layerzero_setRoute_tx_error (0.00s)
    --- PASS: TestEVMAdminOpsService_SetCCIPAndLayerZeroConfig/layerzero_options_tx_error (0.00s)
    --- PASS: TestEVMAdminOpsService_SetCCIPAndLayerZeroConfig/layerzero_payload_required (0.00s)
=== RUN   TestEVMAdminOpsService_SetHyperbridgeConfig_MoreBranches
=== RUN   TestEVMAdminOpsService_SetHyperbridgeConfig_MoreBranches/setStateMachine_tx_error
=== RUN   TestEVMAdminOpsService_SetHyperbridgeConfig_MoreBranches/destination_only_success
--- PASS: TestEVMAdminOpsService_SetHyperbridgeConfig_MoreBranches (0.00s)
    --- PASS: TestEVMAdminOpsService_SetHyperbridgeConfig_MoreBranches/setStateMachine_tx_error (0.00s)
    --- PASS: TestEVMAdminOpsService_SetHyperbridgeConfig_MoreBranches/destination_only_success (0.00s)
=== RUN   TestOnchainAdapterUsecase_CallHelpers_CallViewErrorBranches
--- PASS: TestOnchainAdapterUsecase_CallHelpers_CallViewErrorBranches (0.00s)
=== RUN   TestOnchainAdapterUsecase_CallHelpers_DecodeErrorMatrix
--- PASS: TestOnchainAdapterUsecase_CallHelpers_DecodeErrorMatrix (0.00s)
=== RUN   TestOnchainAdapterUsecase_CallHelpers_PackError
--- PASS: TestOnchainAdapterUsecase_CallHelpers_PackError (0.00s)
=== RUN   TestOnchainAdapterUsecase_CallHelpers_PackErrorByEmptyABI
--- PASS: TestOnchainAdapterUsecase_CallHelpers_PackErrorByEmptyABI (0.00s)
=== RUN   TestOnchainAdapterUsecase_CallHelpers_Success
--- PASS: TestOnchainAdapterUsecase_CallHelpers_Success (0.00s)
=== RUN   TestOnchainAdapterUsecase_CallHelpers_DecodeError
--- PASS: TestOnchainAdapterUsecase_CallHelpers_DecodeError (0.00s)
=== RUN   TestOnchainAdapterUsecase_CallHelpers_InvalidReturnTypeBranches
--- PASS: TestOnchainAdapterUsecase_CallHelpers_InvalidReturnTypeBranches (0.00s)
=== RUN   TestOnchainAdapterUsecase_CallHelpers_UnpackErrorBranches
--- PASS: TestOnchainAdapterUsecase_CallHelpers_UnpackErrorBranches (0.01s)
=== RUN   TestCallTypedView_MoreSuccessTypes
=== RUN   TestCallTypedView_MoreSuccessTypes/uint8_success
=== RUN   TestCallTypedView_MoreSuccessTypes/address_success
=== RUN   TestCallTypedView_MoreSuccessTypes/bytes_success
--- PASS: TestCallTypedView_MoreSuccessTypes (0.00s)
    --- PASS: TestCallTypedView_MoreSuccessTypes/uint8_success (0.00s)
    --- PASS: TestCallTypedView_MoreSuccessTypes/address_success (0.00s)
    --- PASS: TestCallTypedView_MoreSuccessTypes/bytes_success (0.00s)
=== RUN   TestCallTypedView_TypeMismatchError
--- PASS: TestCallTypedView_TypeMismatchError (0.00s)
=== RUN   TestOnchainAdapterUsecase_ResolveEVMContextCore_SourceChainGetByIDError
--- PASS: TestOnchainAdapterUsecase_ResolveEVMContextCore_SourceChainGetByIDError (0.00s)
=== RUN   TestOnchainAdapterUsecase_CallTypedView_InvalidReturnTypeDirect
--- PASS: TestOnchainAdapterUsecase_CallTypedView_InvalidReturnTypeDirect (0.00s)
=== RUN   TestOnchainAdapterUsecase_CallTypedView_PackAndDecodeError
=== RUN   TestOnchainAdapterUsecase_CallTypedView_PackAndDecodeError/pack_error
=== RUN   TestOnchainAdapterUsecase_CallTypedView_PackAndDecodeError/decode_error
=== RUN   TestOnchainAdapterUsecase_CallTypedView_PackAndDecodeError/unpack_error_with_non-empty_payload
=== RUN   TestOnchainAdapterUsecase_CallTypedView_PackAndDecodeError/call_error
--- PASS: TestOnchainAdapterUsecase_CallTypedView_PackAndDecodeError (0.00s)
    --- PASS: TestOnchainAdapterUsecase_CallTypedView_PackAndDecodeError/pack_error (0.00s)
    --- PASS: TestOnchainAdapterUsecase_CallTypedView_PackAndDecodeError/decode_error (0.00s)
    --- PASS: TestOnchainAdapterUsecase_CallTypedView_PackAndDecodeError/unpack_error_with_non-empty_payload (0.00s)
    --- PASS: TestOnchainAdapterUsecase_CallTypedView_PackAndDecodeError/call_error (0.00s)
=== RUN   TestOnchainAdapterUsecase_CallTypedView_Success
--- PASS: TestOnchainAdapterUsecase_CallTypedView_Success (0.00s)
=== RUN   TestOnchainAdapterUsecase_CallTypedView_EmptyOutputsBranch
--- PASS: TestOnchainAdapterUsecase_CallTypedView_EmptyOutputsBranch (0.00s)
=== RUN   TestOnchainAdapterUsecase_ParseHexToBytes32_WithoutPrefix
--- PASS: TestOnchainAdapterUsecase_ParseHexToBytes32_WithoutPrefix (0.00s)
=== RUN   TestOnchainAdapterUsecase_ExecuteOnchainTx_Errors
=== RUN   TestOnchainAdapterUsecase_ExecuteOnchainTx_Errors/dial_error
=== RUN   TestOnchainAdapterUsecase_ExecuteOnchainTx_Errors/invalid_owner_private_key
=== RUN   TestOnchainAdapterUsecase_ExecuteOnchainTx_Errors/chain_id_rpc_error
--- PASS: TestOnchainAdapterUsecase_ExecuteOnchainTx_Errors (0.00s)
    --- PASS: TestOnchainAdapterUsecase_ExecuteOnchainTx_Errors/dial_error (0.00s)
    --- PASS: TestOnchainAdapterUsecase_ExecuteOnchainTx_Errors/invalid_owner_private_key (0.00s)
    --- PASS: TestOnchainAdapterUsecase_ExecuteOnchainTx_Errors/chain_id_rpc_error (0.00s)
=== RUN   TestOnchainAdapterUsecase_GetStatus_WithInjectedClient
--- PASS: TestOnchainAdapterUsecase_GetStatus_WithInjectedClient (0.00s)
=== RUN   TestOnchainAdapterUsecase_GetStatus_DefaultBridgeError
--- PASS: TestOnchainAdapterUsecase_GetStatus_DefaultBridgeError (0.00s)
=== RUN   TestResolveRPCURL
--- PASS: TestResolveRPCURL (0.00s)
=== RUN   TestParseHexToBytes32
--- PASS: TestParseHexToBytes32 (0.00s)
=== RUN   TestMustParseABI
--- PASS: TestMustParseABI (0.00s)
=== RUN   TestOnchainAdapterUsecase_RegisterAdapter_InvalidAddress
--- PASS: TestOnchainAdapterUsecase_RegisterAdapter_InvalidAddress (0.00s)
=== RUN   TestOnchainAdapterUsecase_SendTx_OwnerKeyMissing
--- PASS: TestOnchainAdapterUsecase_SendTx_OwnerKeyMissing (0.00s)
=== RUN   TestOnchainAdapterUsecase_New
--- PASS: TestOnchainAdapterUsecase_New (0.00s)
=== RUN   TestOnchainAdapterUsecase_SendTx_Branches
=== RUN   TestOnchainAdapterUsecase_SendTx_Branches/source_chain_not_found
=== RUN   TestOnchainAdapterUsecase_SendTx_Branches/no_active_rpc
=== RUN   TestOnchainAdapterUsecase_SendTx_Branches/invalid_owner_private_key
=== RUN   TestOnchainAdapterUsecase_SendTx_Branches/chain_id_rpc_error
=== RUN   TestOnchainAdapterUsecase_SendTx_Branches/transact_method_missing
=== RUN   TestOnchainAdapterUsecase_SendTx_Branches/transact_hook_success
=== RUN   TestOnchainAdapterUsecase_SendTx_Branches/executeOnchainTx_hook_branches
--- PASS: TestOnchainAdapterUsecase_SendTx_Branches (0.00s)
    --- PASS: TestOnchainAdapterUsecase_SendTx_Branches/source_chain_not_found (0.00s)
    --- PASS: TestOnchainAdapterUsecase_SendTx_Branches/no_active_rpc (0.00s)
    --- PASS: TestOnchainAdapterUsecase_SendTx_Branches/invalid_owner_private_key (0.00s)
    --- PASS: TestOnchainAdapterUsecase_SendTx_Branches/chain_id_rpc_error (0.00s)
    --- PASS: TestOnchainAdapterUsecase_SendTx_Branches/transact_method_missing (0.00s)
    --- PASS: TestOnchainAdapterUsecase_SendTx_Branches/transact_hook_success (0.00s)
    --- PASS: TestOnchainAdapterUsecase_SendTx_Branches/executeOnchainTx_hook_branches (0.00s)
=== RUN   TestOnchainAdapterUsecase_AdminGetAdapterClosureBranches
=== RUN   TestOnchainAdapterUsecase_AdminGetAdapterClosureBranches/client_factory_missing
=== RUN   TestOnchainAdapterUsecase_AdminGetAdapterClosureBranches/source_chain_not_found
=== RUN   TestOnchainAdapterUsecase_AdminGetAdapterClosureBranches/no_active_rpc
=== RUN   TestOnchainAdapterUsecase_AdminGetAdapterClosureBranches/get_evm_client_failed
=== RUN   TestOnchainAdapterUsecase_AdminGetAdapterClosureBranches/callGetAdapter_decode_failed
=== RUN   TestOnchainAdapterUsecase_AdminGetAdapterClosureBranches/success
--- PASS: TestOnchainAdapterUsecase_AdminGetAdapterClosureBranches (0.00s)
    --- PASS: TestOnchainAdapterUsecase_AdminGetAdapterClosureBranches/client_factory_missing (0.00s)
    --- PASS: TestOnchainAdapterUsecase_AdminGetAdapterClosureBranches/source_chain_not_found (0.00s)
    --- PASS: TestOnchainAdapterUsecase_AdminGetAdapterClosureBranches/no_active_rpc (0.00s)
    --- PASS: TestOnchainAdapterUsecase_AdminGetAdapterClosureBranches/get_evm_client_failed (0.00s)
    --- PASS: TestOnchainAdapterUsecase_AdminGetAdapterClosureBranches/callGetAdapter_decode_failed (0.00s)
    --- PASS: TestOnchainAdapterUsecase_AdminGetAdapterClosureBranches/success (0.00s)
=== RUN   TestPaymentRequestUsecase_BuildTransactionData_Branches
=== RUN   TestPaymentRequestUsecase_BuildTransactionData_Branches/unknown_chain_type_keeps_hex_and_base58_empty
=== RUN   TestPaymentRequestUsecase_BuildTransactionData_Branches/solana_chain_with_contract_fills_base58_and_program_fields
--- PASS: TestPaymentRequestUsecase_BuildTransactionData_Branches (0.00s)
    --- PASS: TestPaymentRequestUsecase_BuildTransactionData_Branches/unknown_chain_type_keeps_hex_and_base58_empty (0.00s)
    --- PASS: TestPaymentRequestUsecase_BuildTransactionData_Branches/solana_chain_with_contract_fills_base58_and_program_fields (0.00s)
=== RUN   TestPaymentRequestUsecase_BuildSvmTransactionBase58
--- PASS: TestPaymentRequestUsecase_BuildSvmTransactionBase58 (0.00s)
=== RUN   TestPaymentUsecase_GetBridgeFeeQuote_ErrorBranches
=== RUN   TestPaymentUsecase_GetBridgeFeeQuote_ErrorBranches/invalid_source
=== RUN   TestPaymentUsecase_GetBridgeFeeQuote_ErrorBranches/invalid_destination
=== RUN   TestPaymentUsecase_GetBridgeFeeQuote_ErrorBranches/router_missing
=== RUN   TestPaymentUsecase_GetBridgeFeeQuote_ErrorBranches/no_rpc_available
=== RUN   TestPaymentUsecase_GetBridgeFeeQuote_ErrorBranches/all_rpc_failed
=== RUN   TestPaymentUsecase_GetBridgeFeeQuote_ErrorBranches/source_chain_lookup_by_id_failed
=== RUN   TestPaymentUsecase_GetBridgeFeeQuote_ErrorBranches/all_bridge_quote_invalid
--- PASS: TestPaymentUsecase_GetBridgeFeeQuote_ErrorBranches (0.00s)
    --- PASS: TestPaymentUsecase_GetBridgeFeeQuote_ErrorBranches/invalid_source (0.00s)
    --- PASS: TestPaymentUsecase_GetBridgeFeeQuote_ErrorBranches/invalid_destination (0.00s)
    --- PASS: TestPaymentUsecase_GetBridgeFeeQuote_ErrorBranches/router_missing (0.00s)
    --- PASS: TestPaymentUsecase_GetBridgeFeeQuote_ErrorBranches/no_rpc_available (0.00s)
    --- PASS: TestPaymentUsecase_GetBridgeFeeQuote_ErrorBranches/all_rpc_failed (0.00s)
    --- PASS: TestPaymentUsecase_GetBridgeFeeQuote_ErrorBranches/source_chain_lookup_by_id_failed (0.00s)
    --- PASS: TestPaymentUsecase_GetBridgeFeeQuote_ErrorBranches/all_bridge_quote_invalid (0.00s)
=== RUN   TestPaymentUsecase_CalculateFees_ConfigAndFallback
=== RUN   TestPaymentUsecase_CalculateFees_ConfigAndFallback/apply_min_fee_after_discount
=== RUN   TestPaymentUsecase_CalculateFees_ConfigAndFallback/cross-chain_quote_failure_uses_flat_bridge_fee_fallback
=== RUN   TestPaymentUsecase_CalculateFees_ConfigAndFallback/max_fee_clamp_is_applied
=== RUN   TestPaymentUsecase_CalculateFees_ConfigAndFallback/invalid_config_numbers_fallback_to_defaults
=== RUN   TestPaymentUsecase_CalculateFees_ConfigAndFallback/cross-chain_quote_success_uses_quoted_bridge_fee
--- PASS: TestPaymentUsecase_CalculateFees_ConfigAndFallback (0.00s)
    --- PASS: TestPaymentUsecase_CalculateFees_ConfigAndFallback/apply_min_fee_after_discount (0.00s)
    --- PASS: TestPaymentUsecase_CalculateFees_ConfigAndFallback/cross-chain_quote_failure_uses_flat_bridge_fee_fallback (0.00s)
    --- PASS: TestPaymentUsecase_CalculateFees_ConfigAndFallback/max_fee_clamp_is_applied (0.00s)
    --- PASS: TestPaymentUsecase_CalculateFees_ConfigAndFallback/invalid_config_numbers_fallback_to_defaults (0.00s)
    --- PASS: TestPaymentUsecase_CalculateFees_ConfigAndFallback/cross-chain_quote_success_uses_quoted_bridge_fee (0.00s)
=== RUN   TestPaymentUsecase_CreatePayment_ValidationAndResolutionErrors
--- PASS: TestPaymentUsecase_CreatePayment_ValidationAndResolutionErrors (0.00s)
=== RUN   TestPaymentUsecase_CreatePayment_TokenAndAmountErrors
Warning: Active Gateway contract not found for chain eip155:8453: resource not found
Warning: Active Gateway contract not found for chain eip155:8453: resource not found
Warning: Active Gateway contract not found for chain eip155:8453: resource not found
Warning: Active Gateway contract not found for chain eip155:8453: resource not found
--- PASS: TestPaymentUsecase_CreatePayment_TokenAndAmountErrors (0.00s)
=== RUN   TestPaymentUsecase_CreatePayment_UOWAndEventBranches
Warning: Active Gateway contract not found for chain eip155:8453: resource not found
Warning: Active Gateway contract not found for chain eip155:8453: resource not found
Warning: failed to create payment event for payment 019c706e-c724-79a8-8377-e5507b7a0504: event insert failed
--- PASS: TestPaymentUsecase_CreatePayment_UOWAndEventBranches (0.00s)
=== RUN   TestPaymentUsecase_CreatePayment_ChainLookupAndPersistenceBranches
=== RUN   TestPaymentUsecase_CreatePayment_ChainLookupAndPersistenceBranches/invalid_dest_chain_resolve
=== RUN   TestPaymentUsecase_CreatePayment_ChainLookupAndPersistenceBranches/error_fetching_source_chain_by_id
=== RUN   TestPaymentUsecase_CreatePayment_ChainLookupAndPersistenceBranches/error_fetching_dest_chain_by_id
=== RUN   TestPaymentUsecase_CreatePayment_ChainLookupAndPersistenceBranches/payment_repo_create_error_inside_uow
Warning: Active Gateway contract not found for chain eip155:8453: resource not found
=== RUN   TestPaymentUsecase_CreatePayment_ChainLookupAndPersistenceBranches/build_transaction_data_error_after_persistence
--- PASS: TestPaymentUsecase_CreatePayment_ChainLookupAndPersistenceBranches (0.00s)
    --- PASS: TestPaymentUsecase_CreatePayment_ChainLookupAndPersistenceBranches/invalid_dest_chain_resolve (0.00s)
    --- PASS: TestPaymentUsecase_CreatePayment_ChainLookupAndPersistenceBranches/error_fetching_source_chain_by_id (0.00s)
    --- PASS: TestPaymentUsecase_CreatePayment_ChainLookupAndPersistenceBranches/error_fetching_dest_chain_by_id (0.00s)
    --- PASS: TestPaymentUsecase_CreatePayment_ChainLookupAndPersistenceBranches/payment_repo_create_error_inside_uow (0.00s)
    --- PASS: TestPaymentUsecase_CreatePayment_ChainLookupAndPersistenceBranches/build_transaction_data_error_after_persistence (0.00s)
=== RUN   TestPaymentUsecase_Helpers
--- PASS: TestPaymentUsecase_Helpers (0.00s)
=== RUN   TestPaymentUsecase_BuildTransactionPayloadHelpers
--- PASS: TestPaymentUsecase_BuildTransactionPayloadHelpers (0.00s)
=== RUN   TestPaymentUsecase_BuildHex_HookErrorBranches
=== RUN   TestPaymentUsecase_BuildHex_HookErrorBranches/approve_hex_new_type_error
=== RUN   TestPaymentUsecase_BuildHex_HookErrorBranches/approve_hex_pack_error
=== RUN   TestPaymentUsecase_BuildHex_HookErrorBranches/approve_hex_second_new_type_error
=== RUN   TestPaymentUsecase_BuildHex_HookErrorBranches/evm_payment_hex_new_type_error
=== RUN   TestPaymentUsecase_BuildHex_HookErrorBranches/evm_payment_hex_second_and_third_new_type_errors
=== RUN   TestPaymentUsecase_BuildHex_HookErrorBranches/evm_payment_hex_receiver_pack_fail_fallback_and_final_pack_fail
--- PASS: TestPaymentUsecase_BuildHex_HookErrorBranches (0.00s)
    --- PASS: TestPaymentUsecase_BuildHex_HookErrorBranches/approve_hex_new_type_error (0.00s)
    --- PASS: TestPaymentUsecase_BuildHex_HookErrorBranches/approve_hex_pack_error (0.00s)
    --- PASS: TestPaymentUsecase_BuildHex_HookErrorBranches/approve_hex_second_new_type_error (0.00s)
    --- PASS: TestPaymentUsecase_BuildHex_HookErrorBranches/evm_payment_hex_new_type_error (0.00s)
    --- PASS: TestPaymentUsecase_BuildHex_HookErrorBranches/evm_payment_hex_second_and_third_new_type_errors (0.00s)
    --- PASS: TestPaymentUsecase_BuildHex_HookErrorBranches/evm_payment_hex_receiver_pack_fail_fallback_and_final_pack_fail (0.00s)
=== RUN   TestBuildBridgeOrderFromPolicy_Strict
--- PASS: TestBuildBridgeOrderFromPolicy_Strict (0.00s)
=== RUN   TestBuildBridgeOrderFromPolicy_AutoFallbackDedupAndFilter
--- PASS: TestBuildBridgeOrderFromPolicy_AutoFallbackDedupAndFilter (0.00s)
=== RUN   TestBuildBridgeOrderFromPolicy_DefaultFallbackCases
--- PASS: TestBuildBridgeOrderFromPolicy_DefaultFallbackCases (0.00s)
=== RUN   TestPaymentUsecase_ResolveVaultAddress_EmptyGatewayBranch
--- PASS: TestPaymentUsecase_ResolveVaultAddress_EmptyGatewayBranch (0.00s)
=== RUN   TestPaymentUsecase_CalculateOnchainApprovalAmount_MoreErrorBranches
=== RUN   TestPaymentUsecase_CalculateOnchainApprovalAmount_MoreErrorBranches/fixed_fee_call_error
=== RUN   TestPaymentUsecase_CalculateOnchainApprovalAmount_MoreErrorBranches/fee_bps_call_error
--- PASS: TestPaymentUsecase_CalculateOnchainApprovalAmount_MoreErrorBranches (0.00s)
    --- PASS: TestPaymentUsecase_CalculateOnchainApprovalAmount_MoreErrorBranches/fixed_fee_call_error (0.00s)
    --- PASS: TestPaymentUsecase_CalculateOnchainApprovalAmount_MoreErrorBranches/fee_bps_call_error (0.00s)
=== RUN   TestPaymentUsecase_GetBridgeFeeQuote_FirstConnectedRPCCallError
--- PASS: TestPaymentUsecase_GetBridgeFeeQuote_FirstConnectedRPCCallError (0.00s)
=== RUN   TestPaymentUsecase_CalculateOnchainApprovalAmount_QuoteSuccess
--- PASS: TestPaymentUsecase_CalculateOnchainApprovalAmount_QuoteSuccess (0.00s)
=== RUN   TestPaymentUsecase_CalculateOnchainApprovalAmount_FallbackFeePath
--- PASS: TestPaymentUsecase_CalculateOnchainApprovalAmount_FallbackFeePath (0.00s)
=== RUN   TestPaymentUsecase_ResolveVaultAddressForApproval_FromGatewayView
--- PASS: TestPaymentUsecase_ResolveVaultAddressForApproval_FromGatewayView (0.00s)
=== RUN   TestPaymentUsecase_ResolveVaultAddressForApproval_FallbackBranches
=== RUN   TestPaymentUsecase_ResolveVaultAddressForApproval_FallbackBranches/chain_repo_miss
=== RUN   TestPaymentUsecase_ResolveVaultAddressForApproval_FallbackBranches/fallback_to_active_rpc_list_with_bad_url
=== RUN   TestPaymentUsecase_ResolveVaultAddressForApproval_FallbackBranches/short_call_output
--- PASS: TestPaymentUsecase_ResolveVaultAddressForApproval_FallbackBranches (0.00s)
    --- PASS: TestPaymentUsecase_ResolveVaultAddressForApproval_FallbackBranches/chain_repo_miss (0.00s)
    --- PASS: TestPaymentUsecase_ResolveVaultAddressForApproval_FallbackBranches/fallback_to_active_rpc_list_with_bad_url (0.00s)
    --- PASS: TestPaymentUsecase_ResolveVaultAddressForApproval_FallbackBranches/short_call_output (0.00s)
=== RUN   TestPaymentUsecase_CalculateOnchainApprovalAmount_ErrorBranches
=== RUN   TestPaymentUsecase_CalculateOnchainApprovalAmount_ErrorBranches/invalid_payment_input
=== RUN   TestPaymentUsecase_CalculateOnchainApprovalAmount_ErrorBranches/invalid_source_amount
=== RUN   TestPaymentUsecase_CalculateOnchainApprovalAmount_ErrorBranches/source_chain_missing
=== RUN   TestPaymentUsecase_CalculateOnchainApprovalAmount_ErrorBranches/no_active_rpc
=== RUN   TestPaymentUsecase_CalculateOnchainApprovalAmount_ErrorBranches/invalid_fixed_fee_decode
=== RUN   TestPaymentUsecase_CalculateOnchainApprovalAmount_ErrorBranches/invalid_fee_bps_decode
=== RUN   TestPaymentUsecase_CalculateOnchainApprovalAmount_ErrorBranches/fallback_on_invalid_total_charged_keeps_amount
--- PASS: TestPaymentUsecase_CalculateOnchainApprovalAmount_ErrorBranches (0.00s)
    --- PASS: TestPaymentUsecase_CalculateOnchainApprovalAmount_ErrorBranches/invalid_payment_input (0.00s)
    --- PASS: TestPaymentUsecase_CalculateOnchainApprovalAmount_ErrorBranches/invalid_source_amount (0.00s)
    --- PASS: TestPaymentUsecase_CalculateOnchainApprovalAmount_ErrorBranches/source_chain_missing (0.00s)
    --- PASS: TestPaymentUsecase_CalculateOnchainApprovalAmount_ErrorBranches/no_active_rpc (0.00s)
    --- PASS: TestPaymentUsecase_CalculateOnchainApprovalAmount_ErrorBranches/invalid_fixed_fee_decode (0.00s)
    --- PASS: TestPaymentUsecase_CalculateOnchainApprovalAmount_ErrorBranches/invalid_fee_bps_decode (0.00s)
    --- PASS: TestPaymentUsecase_CalculateOnchainApprovalAmount_ErrorBranches/fallback_on_invalid_total_charged_keeps_amount (0.00s)
=== RUN   TestPaymentUsecase_CalculateOnchainApprovalAmount_MockClientBranches
=== RUN   TestPaymentUsecase_CalculateOnchainApprovalAmount_MockClientBranches/quote_lower_than_totalCharged_uses_totalCharged
=== RUN   TestPaymentUsecase_CalculateOnchainApprovalAmount_MockClientBranches/fixed_fee_call_error
=== RUN   TestPaymentUsecase_CalculateOnchainApprovalAmount_MockClientBranches/fee_bps_call_error
=== RUN   TestPaymentUsecase_CalculateOnchainApprovalAmount_MockClientBranches/fallback_success_percentage_path
=== RUN   TestPaymentUsecase_CalculateOnchainApprovalAmount_MockClientBranches/quote_call_error_then_fallback_succeeds
=== RUN   TestPaymentUsecase_CalculateOnchainApprovalAmount_MockClientBranches/totalCharged_parse_fallback_and_RPC_list_resolution
=== RUN   TestPaymentUsecase_CalculateOnchainApprovalAmount_MockClientBranches/decode_FIXED_BASE_FEE_failed
=== RUN   TestPaymentUsecase_CalculateOnchainApprovalAmount_MockClientBranches/decode_FEE_RATE_BPS_failed
--- PASS: TestPaymentUsecase_CalculateOnchainApprovalAmount_MockClientBranches (0.00s)
    --- PASS: TestPaymentUsecase_CalculateOnchainApprovalAmount_MockClientBranches/quote_lower_than_totalCharged_uses_totalCharged (0.00s)
    --- PASS: TestPaymentUsecase_CalculateOnchainApprovalAmount_MockClientBranches/fixed_fee_call_error (0.00s)
    --- PASS: TestPaymentUsecase_CalculateOnchainApprovalAmount_MockClientBranches/fee_bps_call_error (0.00s)
    --- PASS: TestPaymentUsecase_CalculateOnchainApprovalAmount_MockClientBranches/fallback_success_percentage_path (0.00s)
    --- PASS: TestPaymentUsecase_CalculateOnchainApprovalAmount_MockClientBranches/quote_call_error_then_fallback_succeeds (0.00s)
    --- PASS: TestPaymentUsecase_CalculateOnchainApprovalAmount_MockClientBranches/totalCharged_parse_fallback_and_RPC_list_resolution (0.00s)
    --- PASS: TestPaymentUsecase_CalculateOnchainApprovalAmount_MockClientBranches/decode_FIXED_BASE_FEE_failed (0.00s)
    --- PASS: TestPaymentUsecase_CalculateOnchainApprovalAmount_MockClientBranches/decode_FEE_RATE_BPS_failed (0.00s)
=== RUN   TestDecodeSafeQuoteResult
=== RUN   TestDecodeSafeQuoteResult/Success_case
=== RUN   TestDecodeSafeQuoteResult/Failure_case_with_reason
=== RUN   TestDecodeSafeQuoteResult/Invalid_data
--- PASS: TestDecodeSafeQuoteResult (0.00s)
    --- PASS: TestDecodeSafeQuoteResult/Success_case (0.00s)
    --- PASS: TestDecodeSafeQuoteResult/Failure_case_with_reason (0.00s)
    --- PASS: TestDecodeSafeQuoteResult/Invalid_data (0.00s)
=== RUN   TestPaymentUsecase_QuoteBridgeFeeByType_SuccessAndEmpty
=== RUN   TestPaymentUsecase_QuoteBridgeFeeByType_SuccessAndEmpty/success_safe_quote
=== RUN   TestPaymentUsecase_QuoteBridgeFeeByType_SuccessAndEmpty/success_fallback_legacy_quote
=== RUN   TestPaymentUsecase_QuoteBridgeFeeByType_SuccessAndEmpty/empty_result
--- PASS: TestPaymentUsecase_QuoteBridgeFeeByType_SuccessAndEmpty (0.00s)
    --- PASS: TestPaymentUsecase_QuoteBridgeFeeByType_SuccessAndEmpty/success_safe_quote (0.00s)
    --- PASS: TestPaymentUsecase_QuoteBridgeFeeByType_SuccessAndEmpty/success_fallback_legacy_quote (0.00s)
    --- PASS: TestPaymentUsecase_QuoteBridgeFeeByType_SuccessAndEmpty/empty_result (0.00s)
=== RUN   TestPaymentUsecase_QuoteBridgeFeeByType_CallErrorRPCResponse
--- PASS: TestPaymentUsecase_QuoteBridgeFeeByType_CallErrorRPCResponse (0.00s)
=== RUN   TestPaymentUsecase_QuoteBridgeFeeByType_CallErrorRPCResponse_DecodedRevert
--- PASS: TestPaymentUsecase_QuoteBridgeFeeByType_CallErrorRPCResponse_DecodedRevert (0.00s)
=== RUN   TestPaymentUsecase_QuoteBridgeFeeByType_PackErrorAndExplicitEmptyResult
=== RUN   TestPaymentUsecase_QuoteBridgeFeeByType_PackErrorAndExplicitEmptyResult/nil_amount_panics_in_abi_pack_path
=== RUN   TestPaymentUsecase_QuoteBridgeFeeByType_PackErrorAndExplicitEmptyResult/empty_result_from_callview_hook
=== RUN   TestPaymentUsecase_QuoteBridgeFeeByType_PackErrorAndExplicitEmptyResult/abi_type_construction_error
=== RUN   TestPaymentUsecase_QuoteBridgeFeeByType_PackErrorAndExplicitEmptyResult/abi_string_type_construction_error
=== RUN   TestPaymentUsecase_QuoteBridgeFeeByType_PackErrorAndExplicitEmptyResult/abi_uint8_type_construction_error
=== RUN   TestPaymentUsecase_QuoteBridgeFeeByType_PackErrorAndExplicitEmptyResult/pack_error
--- PASS: TestPaymentUsecase_QuoteBridgeFeeByType_PackErrorAndExplicitEmptyResult (0.00s)
    --- PASS: TestPaymentUsecase_QuoteBridgeFeeByType_PackErrorAndExplicitEmptyResult/nil_amount_panics_in_abi_pack_path (0.00s)
    --- PASS: TestPaymentUsecase_QuoteBridgeFeeByType_PackErrorAndExplicitEmptyResult/empty_result_from_callview_hook (0.00s)
    --- PASS: TestPaymentUsecase_QuoteBridgeFeeByType_PackErrorAndExplicitEmptyResult/abi_type_construction_error (0.00s)
    --- PASS: TestPaymentUsecase_QuoteBridgeFeeByType_PackErrorAndExplicitEmptyResult/abi_string_type_construction_error (0.00s)
    --- PASS: TestPaymentUsecase_QuoteBridgeFeeByType_PackErrorAndExplicitEmptyResult/abi_uint8_type_construction_error (0.00s)
    --- PASS: TestPaymentUsecase_QuoteBridgeFeeByType_PackErrorAndExplicitEmptyResult/pack_error (0.00s)
=== RUN   TestPaymentUsecase_GetBridgeFeeQuote_UsesFallbackOrder
--- PASS: TestPaymentUsecase_GetBridgeFeeQuote_UsesFallbackOrder (0.00s)
=== RUN   TestPaymentUsecase_ResolveVaultAddressForApproval_MoreBranches
=== RUN   TestPaymentUsecase_ResolveVaultAddressForApproval_MoreBranches/contract_repo_returns_nil,nil_then_chain_nil
=== RUN   TestPaymentUsecase_ResolveVaultAddressForApproval_MoreBranches/no_active_rpc_but_fallback_any_rpc_url_works_path
=== RUN   TestPaymentUsecase_ResolveVaultAddressForApproval_MoreBranches/active_rpc_mock_client_returns_padded_vault_address
=== RUN   TestPaymentUsecase_ResolveVaultAddressForApproval_MoreBranches/gateway_empty_short-circuit_when_no_vault_configured
=== RUN   TestPaymentUsecase_ResolveVaultAddressForApproval_MoreBranches/call_view_error_returns_empty
=== RUN   TestPaymentUsecase_ResolveVaultAddressForApproval_MoreBranches/no_rpc_available_returns_empty
--- PASS: TestPaymentUsecase_ResolveVaultAddressForApproval_MoreBranches (0.00s)
    --- PASS: TestPaymentUsecase_ResolveVaultAddressForApproval_MoreBranches/contract_repo_returns_nil,nil_then_chain_nil (0.00s)
    --- PASS: TestPaymentUsecase_ResolveVaultAddressForApproval_MoreBranches/no_active_rpc_but_fallback_any_rpc_url_works_path (0.00s)
    --- PASS: TestPaymentUsecase_ResolveVaultAddressForApproval_MoreBranches/active_rpc_mock_client_returns_padded_vault_address (0.00s)
    --- PASS: TestPaymentUsecase_ResolveVaultAddressForApproval_MoreBranches/gateway_empty_short-circuit_when_no_vault_configured (0.00s)
    --- PASS: TestPaymentUsecase_ResolveVaultAddressForApproval_MoreBranches/call_view_error_returns_empty (0.00s)
    --- PASS: TestPaymentUsecase_ResolveVaultAddressForApproval_MoreBranches/no_rpc_available_returns_empty (0.00s)
=== RUN   TestPaymentUsecase_DecideBridge_Priority
=== RUN   TestPaymentUsecase_DecideBridge_Priority/route_policy_has_highest_priority
=== RUN   TestPaymentUsecase_DecideBridge_Priority/bridge_config_used_when_policy_missing
=== RUN   TestPaymentUsecase_DecideBridge_Priority/fallback_deterministic_selection
--- PASS: TestPaymentUsecase_DecideBridge_Priority (0.00s)
    --- PASS: TestPaymentUsecase_DecideBridge_Priority/route_policy_has_highest_priority (0.00s)
    --- PASS: TestPaymentUsecase_DecideBridge_Priority/bridge_config_used_when_policy_missing (0.00s)
    --- PASS: TestPaymentUsecase_DecideBridge_Priority/fallback_deterministic_selection (0.00s)
=== RUN   TestPaymentUsecase_ResolveBridgeOrder_WithPolicy
--- PASS: TestPaymentUsecase_ResolveBridgeOrder_WithPolicy (0.00s)
=== RUN   TestPaymentUsecase_ResolveToken_Branches
=== RUN   TestPaymentUsecase_ResolveToken_Branches/native_token_success
=== RUN   TestPaymentUsecase_ResolveToken_Branches/native_token_not_found
=== RUN   TestPaymentUsecase_ResolveToken_Branches/erc20_address_success
=== RUN   TestPaymentUsecase_ResolveToken_Branches/erc20_address_not_found
--- PASS: TestPaymentUsecase_ResolveToken_Branches (0.00s)
    --- PASS: TestPaymentUsecase_ResolveToken_Branches/native_token_success (0.00s)
    --- PASS: TestPaymentUsecase_ResolveToken_Branches/native_token_not_found (0.00s)
    --- PASS: TestPaymentUsecase_ResolveToken_Branches/erc20_address_success (0.00s)
    --- PASS: TestPaymentUsecase_ResolveToken_Branches/erc20_address_not_found (0.00s)
=== RUN   TestPaymentUsecase_SelectBridge_Branches
=== RUN   TestPaymentUsecase_SelectBridge_Branches/evm_to_evm_selects_ccip
=== RUN   TestPaymentUsecase_SelectBridge_Branches/solana_to_evm_selects_hyperlane
=== RUN   TestPaymentUsecase_SelectBridge_Branches/evm_to_solana_selects_hyperlane
=== RUN   TestPaymentUsecase_SelectBridge_Branches/non-evm_non-solana_falls_back_to_hyperbridge
--- PASS: TestPaymentUsecase_SelectBridge_Branches (0.00s)
    --- PASS: TestPaymentUsecase_SelectBridge_Branches/evm_to_evm_selects_ccip (0.00s)
    --- PASS: TestPaymentUsecase_SelectBridge_Branches/solana_to_evm_selects_hyperlane (0.00s)
    --- PASS: TestPaymentUsecase_SelectBridge_Branches/evm_to_solana_selects_hyperlane (0.00s)
    --- PASS: TestPaymentUsecase_SelectBridge_Branches/non-evm_non-solana_falls_back_to_hyperbridge (0.00s)
=== RUN   TestPaymentUsecase_BuildEvmPaymentHex_SlippageSelector
--- PASS: TestPaymentUsecase_BuildEvmPaymentHex_SlippageSelector (0.00s)
=== RUN   TestPaymentUsecase_BuildTransactionData_Branches
=== RUN   TestPaymentUsecase_BuildTransactionData_Branches/contract_nil
=== RUN   TestPaymentUsecase_BuildTransactionData_Branches/evm_same_chain_no_approval
=== RUN   TestPaymentUsecase_BuildTransactionData_Branches/evm_approval_required_but_vault_missing
=== RUN   TestPaymentUsecase_BuildTransactionData_Branches/solana_chain
=== RUN   TestPaymentUsecase_BuildTransactionData_Branches/evm_cross_chain_fee_quote_failed
=== RUN   TestPaymentUsecase_BuildTransactionData_Branches/evm_cross_chain_invalid_source_amount
=== RUN   TestPaymentUsecase_BuildTransactionData_Branches/evm_chain_with_unknown_network_still_returns_payload
=== RUN   TestPaymentUsecase_BuildTransactionData_Branches/unknown_chain_type_returns_nil_payload
=== RUN   TestPaymentUsecase_BuildTransactionData_Branches/evm_same-chain_with_source/dest_resolved_from_repo
=== RUN   TestPaymentUsecase_BuildTransactionData_Branches/evm_approval_path_includes_approve_+_createPayment_txs
--- PASS: TestPaymentUsecase_BuildTransactionData_Branches (0.00s)
    --- PASS: TestPaymentUsecase_BuildTransactionData_Branches/contract_nil (0.00s)
    --- PASS: TestPaymentUsecase_BuildTransactionData_Branches/evm_same_chain_no_approval (0.00s)
    --- PASS: TestPaymentUsecase_BuildTransactionData_Branches/evm_approval_required_but_vault_missing (0.00s)
    --- PASS: TestPaymentUsecase_BuildTransactionData_Branches/solana_chain (0.00s)
    --- PASS: TestPaymentUsecase_BuildTransactionData_Branches/evm_cross_chain_fee_quote_failed (0.00s)
    --- PASS: TestPaymentUsecase_BuildTransactionData_Branches/evm_cross_chain_invalid_source_amount (0.00s)
    --- PASS: TestPaymentUsecase_BuildTransactionData_Branches/evm_chain_with_unknown_network_still_returns_payload (0.00s)
    --- PASS: TestPaymentUsecase_BuildTransactionData_Branches/unknown_chain_type_returns_nil_payload (0.00s)
    --- PASS: TestPaymentUsecase_BuildTransactionData_Branches/evm_same-chain_with_source/dest_resolved_from_repo (0.00s)
    --- PASS: TestPaymentUsecase_BuildTransactionData_Branches/evm_approval_path_includes_approve_+_createPayment_txs (0.00s)
=== RUN   TestPaymentUsecase_BuildTransactionData_MoreBranches
=== RUN   TestPaymentUsecase_BuildTransactionData_MoreBranches/cross-chain_fee_quote_success_sets_tx_value
=== RUN   TestPaymentUsecase_BuildTransactionData_MoreBranches/cross-chain_fee_quote_zero_returns_invalid_quote_error
=== RUN   TestPaymentUsecase_BuildTransactionData_MoreBranches/source_and_dest_chain_resolved_from_repo_when_relation_missing
=== RUN   TestPaymentUsecase_BuildTransactionData_MoreBranches/source_chain_unresolved_returns_nil_payload
=== RUN   TestPaymentUsecase_BuildTransactionData_MoreBranches/approval_path_propagates_calculateOnchainApprovalAmount_error
=== RUN   TestPaymentUsecase_BuildTransactionData_MoreBranches/cross-chain_with_approval_success_includes_tx_value_and_approval
--- PASS: TestPaymentUsecase_BuildTransactionData_MoreBranches (0.00s)
    --- PASS: TestPaymentUsecase_BuildTransactionData_MoreBranches/cross-chain_fee_quote_success_sets_tx_value (0.00s)
    --- PASS: TestPaymentUsecase_BuildTransactionData_MoreBranches/cross-chain_fee_quote_zero_returns_invalid_quote_error (0.00s)
    --- PASS: TestPaymentUsecase_BuildTransactionData_MoreBranches/source_and_dest_chain_resolved_from_repo_when_relation_missing (0.00s)
    --- PASS: TestPaymentUsecase_BuildTransactionData_MoreBranches/source_chain_unresolved_returns_nil_payload (0.00s)
    --- PASS: TestPaymentUsecase_BuildTransactionData_MoreBranches/approval_path_propagates_calculateOnchainApprovalAmount_error (0.00s)
    --- PASS: TestPaymentUsecase_BuildTransactionData_MoreBranches/cross-chain_with_approval_success_includes_tx_value_and_approval (0.00s)
=== RUN   TestPaymentUsecase_ResolveVaultAddressForApproval_UsesActiveRPCList
--- PASS: TestPaymentUsecase_ResolveVaultAddressForApproval_UsesActiveRPCList (0.00s)
=== RUN   TestPaymentUsecase_CalculateOnchainApprovalAmount_ClientCreateError
--- PASS: TestPaymentUsecase_CalculateOnchainApprovalAmount_ClientCreateError (0.00s)
=== RUN   TestPaymentUsecase_QuoteBridgeFeeByType_CallError
--- PASS: TestPaymentUsecase_QuoteBridgeFeeByType_CallError (0.00s)
=== RUN   TestPaymentUsecase_ResolveVaultAddressForApproval
--- PASS: TestPaymentUsecase_ResolveVaultAddressForApproval (0.00s)
=== RUN   TestPaymentUsecase_CalculateOnchainApprovalAmount_Guards
--- PASS: TestPaymentUsecase_CalculateOnchainApprovalAmount_Guards (0.00s)
=== RUN   TestPaymentUsecase_ResolveBridgeOrder_DefaultFallback
--- PASS: TestPaymentUsecase_ResolveBridgeOrder_DefaultFallback (0.00s)
=== RUN   TestPaymentUsecase_QuoteBridgeFeeByType_PackError
--- PASS: TestPaymentUsecase_QuoteBridgeFeeByType_PackError (0.00s)
=== RUN   TestDecodeRevertDataFromError_DataErrorString
--- PASS: TestDecodeRevertDataFromError_DataErrorString (0.00s)
=== RUN   TestDecodeRevertDataFromError_StringFallback
--- PASS: TestDecodeRevertDataFromError_StringFallback (0.00s)
=== RUN   TestDecodeRevertDataFromError_NoData
--- PASS: TestDecodeRevertDataFromError_NoData (0.00s)
=== RUN   TestNormalizeBytes32Hex
=== PAUSE TestNormalizeBytes32Hex
=== RUN   TestDecodeRouteErrorData_NoErrorRecorded
=== PAUSE TestDecodeRouteErrorData_NoErrorRecorded
=== RUN   TestDecodeRouteErrorData_ErrorString
=== PAUSE TestDecodeRouteErrorData_ErrorString
=== RUN   TestDecodeRouteErrorData_Panic
=== PAUSE TestDecodeRouteErrorData_Panic
=== RUN   TestDecodeRouteErrorData_KnownCustomSelector
=== PAUSE TestDecodeRouteErrorData_KnownCustomSelector
=== RUN   TestDecodeRouteErrorData_KnownCustomSelectorWithPayload
=== PAUSE TestDecodeRouteErrorData_KnownCustomSelectorWithPayload
=== RUN   TestDecodeRouteErrorData_InsufficientNativeFeePayload
=== PAUSE TestDecodeRouteErrorData_InsufficientNativeFeePayload
=== RUN   TestDecodeRouteErrorData_UnknownSelector
=== PAUSE TestDecodeRouteErrorData_UnknownSelector
=== RUN   TestConvertToSmallestUnit_AdditionalBranches
=== RUN   TestConvertToSmallestUnit_AdditionalBranches/leading_dot_normalizes_whole_part
=== RUN   TestConvertToSmallestUnit_AdditionalBranches/multiple_dots_invalid_format
=== RUN   TestConvertToSmallestUnit_AdditionalBranches/trim_spaces_and_plus_with_zero_result
--- PASS: TestConvertToSmallestUnit_AdditionalBranches (0.00s)
    --- PASS: TestConvertToSmallestUnit_AdditionalBranches/leading_dot_normalizes_whole_part (0.00s)
    --- PASS: TestConvertToSmallestUnit_AdditionalBranches/multiple_dots_invalid_format (0.00s)
    --- PASS: TestConvertToSmallestUnit_AdditionalBranches/trim_spaces_and_plus_with_zero_result (0.00s)
=== RUN   TestAddressToBytes32_HexAndAsciiBranches
=== RUN   TestAddressToBytes32_HexAndAsciiBranches/hex_shorter_than_32_bytes_is_left_padded
=== RUN   TestAddressToBytes32_HexAndAsciiBranches/invalid_hex_prefix_falls_back_to_ascii_bytes
=== RUN   TestAddressToBytes32_HexAndAsciiBranches/non-base58_long_ascii_is_right-trimmed
--- PASS: TestAddressToBytes32_HexAndAsciiBranches (0.00s)
    --- PASS: TestAddressToBytes32_HexAndAsciiBranches/hex_shorter_than_32_bytes_is_left_padded (0.00s)
    --- PASS: TestAddressToBytes32_HexAndAsciiBranches/invalid_hex_prefix_falls_back_to_ascii_bytes (0.00s)
    --- PASS: TestAddressToBytes32_HexAndAsciiBranches/non-base58_long_ascii_is_right-trimmed (0.00s)
=== RUN   TestBase58Decode_EmptyStringBranch
--- PASS: TestBase58Decode_EmptyStringBranch (0.00s)
=== RUN   TestPadHelpers
--- PASS: TestPadHelpers (0.00s)
=== RUN   TestChainTypeHelpers
--- PASS: TestChainTypeHelpers (0.00s)
=== RUN   TestConvertToSmallestUnit
=== RUN   TestConvertToSmallestUnit/integer
=== RUN   TestConvertToSmallestUnit/fraction
=== RUN   TestConvertToSmallestUnit/leading_plus
=== RUN   TestConvertToSmallestUnit/zero
=== RUN   TestConvertToSmallestUnit/blank
=== RUN   TestConvertToSmallestUnit/negative
=== RUN   TestConvertToSmallestUnit/non_numeric
=== RUN   TestConvertToSmallestUnit/too_many_decimals
=== RUN   TestConvertToSmallestUnit/bad_decimals
--- PASS: TestConvertToSmallestUnit (0.00s)
    --- PASS: TestConvertToSmallestUnit/integer (0.00s)
    --- PASS: TestConvertToSmallestUnit/fraction (0.00s)
    --- PASS: TestConvertToSmallestUnit/leading_plus (0.00s)
    --- PASS: TestConvertToSmallestUnit/zero (0.00s)
    --- PASS: TestConvertToSmallestUnit/blank (0.00s)
    --- PASS: TestConvertToSmallestUnit/negative (0.00s)
    --- PASS: TestConvertToSmallestUnit/non_numeric (0.00s)
    --- PASS: TestConvertToSmallestUnit/too_many_decimals (0.00s)
    --- PASS: TestConvertToSmallestUnit/bad_decimals (0.00s)
=== RUN   TestAddDecimalStrings
--- PASS: TestAddDecimalStrings (0.00s)
=== RUN   TestBase58EncodeDecode
--- PASS: TestBase58EncodeDecode (0.00s)
=== RUN   TestNormalizeEvmAddress
--- PASS: TestNormalizeEvmAddress (0.00s)
=== RUN   TestBinaryHelpers
--- PASS: TestBinaryHelpers (0.00s)
=== RUN   TestDecimalStringToUint64
--- PASS: TestDecimalStringToUint64 (0.00s)
=== RUN   TestAddressToBytes32
--- PASS: TestAddressToBytes32 (0.00s)
=== RUN   TestUUIDAndAnchorHelpers
--- PASS: TestUUIDAndAnchorHelpers (0.00s)
=== RUN   TestMapStatus_AllBranches
--- PASS: TestMapStatus_AllBranches (0.00s)
=== RUN   TestResolveABI_LoadsFromDB
--- PASS: TestResolveABI_LoadsFromDB (0.00s)
=== RUN   TestResolveABI_FallbackOnNilABI
--- PASS: TestResolveABI_FallbackOnNilABI (0.00s)
=== RUN   TestResolveABI_ErrorPropagation
--- PASS: TestResolveABI_ErrorPropagation (0.00s)
=== RUN   TestApiKeyUsecase_NewAndCreate_Branches
=== RUN   TestApiKeyUsecase_NewAndCreate_Branches/constructor_supports_raw_32-byte_key_fallback
=== RUN   TestApiKeyUsecase_NewAndCreate_Branches/create_fails_when_encryption_key_invalid
--- PASS: TestApiKeyUsecase_NewAndCreate_Branches (0.00s)
    --- PASS: TestApiKeyUsecase_NewAndCreate_Branches/constructor_supports_raw_32-byte_key_fallback (0.00s)
    --- PASS: TestApiKeyUsecase_NewAndCreate_Branches/create_fails_when_encryption_key_invalid (0.00s)
=== RUN   TestApiKeyUsecase_ValidateApiKey_ErrorBranches
=== RUN   TestApiKeyUsecase_ValidateApiKey_ErrorBranches/invalid_timestamp
=== RUN   TestApiKeyUsecase_ValidateApiKey_ErrorBranches/expired_timestamp
=== RUN   TestApiKeyUsecase_ValidateApiKey_ErrorBranches/key_not_found
=== RUN   TestApiKeyUsecase_ValidateApiKey_ErrorBranches/inactive_key
=== RUN   TestApiKeyUsecase_ValidateApiKey_ErrorBranches/decrypt_failure
=== RUN   TestApiKeyUsecase_ValidateApiKey_ErrorBranches/invalid_signature
=== RUN   TestApiKeyUsecase_ValidateApiKey_ErrorBranches/user_preload_missing_and_fetch_user_failed
=== RUN   TestApiKeyUsecase_ValidateApiKey_ErrorBranches/user_preload_missing_and_fetch_user_success
--- PASS: TestApiKeyUsecase_ValidateApiKey_ErrorBranches (0.00s)
    --- PASS: TestApiKeyUsecase_ValidateApiKey_ErrorBranches/invalid_timestamp (0.00s)
    --- PASS: TestApiKeyUsecase_ValidateApiKey_ErrorBranches/expired_timestamp (0.00s)
    --- PASS: TestApiKeyUsecase_ValidateApiKey_ErrorBranches/key_not_found (0.00s)
    --- PASS: TestApiKeyUsecase_ValidateApiKey_ErrorBranches/inactive_key (0.00s)
    --- PASS: TestApiKeyUsecase_ValidateApiKey_ErrorBranches/decrypt_failure (0.00s)
    --- PASS: TestApiKeyUsecase_ValidateApiKey_ErrorBranches/invalid_signature (0.00s)
    --- PASS: TestApiKeyUsecase_ValidateApiKey_ErrorBranches/user_preload_missing_and_fetch_user_failed (0.00s)
    --- PASS: TestApiKeyUsecase_ValidateApiKey_ErrorBranches/user_preload_missing_and_fetch_user_success (0.00s)
=== RUN   TestApiKeyUsecase_ValidateSignatureForJWT_ErrorBranches
--- PASS: TestApiKeyUsecase_ValidateSignatureForJWT_ErrorBranches (0.00s)
=== RUN   TestApiKeyUsecase_RevokeApiKey_Branches
--- PASS: TestApiKeyUsecase_RevokeApiKey_Branches (0.00s)
=== RUN   TestApiKeyUsecase_CreateApiKey
--- PASS: TestApiKeyUsecase_CreateApiKey (0.00s)
=== RUN   TestApiKeyUsecase_ValidateApiKey
--- PASS: TestApiKeyUsecase_ValidateApiKey (0.00s)
=== RUN   TestApiKeyUsecase_ValidateSignatureForJWT
--- PASS: TestApiKeyUsecase_ValidateSignatureForJWT (0.00s)
=== RUN   TestApiKeyUsecase_ListApiKeys
--- PASS: TestApiKeyUsecase_ListApiKeys (0.00s)
=== RUN   TestApiKeyUsecase_RevokeApiKey
--- PASS: TestApiKeyUsecase_RevokeApiKey (0.00s)
=== RUN   TestApiKeyUsecase_CreateApiKey_CreateError
--- PASS: TestApiKeyUsecase_CreateApiKey_CreateError (0.00s)
=== RUN   TestApiKeyUsecase_CreateApiKey_InvalidEncryptionKey
--- PASS: TestApiKeyUsecase_CreateApiKey_InvalidEncryptionKey (0.00s)
=== RUN   TestApiKeyUsecase_ValidateApiKey_InvalidTimestamp
--- PASS: TestApiKeyUsecase_ValidateApiKey_InvalidTimestamp (0.00s)
=== RUN   TestApiKeyUsecase_ValidateApiKey_ExpiredTimestamp
--- PASS: TestApiKeyUsecase_ValidateApiKey_ExpiredTimestamp (0.00s)
=== RUN   TestApiKeyUsecase_ValidateApiKey_KeyInactive
--- PASS: TestApiKeyUsecase_ValidateApiKey_KeyInactive (0.00s)
=== RUN   TestApiKeyUsecase_ValidateApiKey_UserFallbackError
--- PASS: TestApiKeyUsecase_ValidateApiKey_UserFallbackError (0.00s)
=== RUN   TestApiKeyUsecase_ValidateSignatureForJWT_NoKeys
--- PASS: TestApiKeyUsecase_ValidateSignatureForJWT_NoKeys (0.00s)
=== RUN   TestApiKeyUsecase_ValidateSignatureForJWT_RepoError
--- PASS: TestApiKeyUsecase_ValidateSignatureForJWT_RepoError (0.00s)
=== RUN   TestApiKeyUsecase_RevokeApiKey_NotOwner
--- PASS: TestApiKeyUsecase_RevokeApiKey_NotOwner (0.00s)
=== RUN   TestApiKeyUsecase_RevokeApiKey_FindError
--- PASS: TestApiKeyUsecase_RevokeApiKey_FindError (0.00s)
=== RUN   TestAuthUsecase_Register_ErrorBranches_GapExtra
=== RUN   TestAuthUsecase_Register_ErrorBranches_GapExtra/get_by_email_unexpected_error
=== RUN   TestAuthUsecase_Register_ErrorBranches_GapExtra/wallet_chain_resolve_failed
=== RUN   TestAuthUsecase_Register_ErrorBranches_GapExtra/wallet_lookup_unexpected_error
=== RUN   TestAuthUsecase_Register_ErrorBranches_GapExtra/wallet_already_linked_to_another_user
=== RUN   TestAuthUsecase_Register_ErrorBranches_GapExtra/create_user_failed
=== RUN   TestAuthUsecase_Register_ErrorBranches_GapExtra/create_wallet_failed
=== RUN   TestAuthUsecase_Register_ErrorBranches_GapExtra/create_email_verification_failed
--- PASS: TestAuthUsecase_Register_ErrorBranches_GapExtra (0.76s)
    --- PASS: TestAuthUsecase_Register_ErrorBranches_GapExtra/get_by_email_unexpected_error (0.00s)
    --- PASS: TestAuthUsecase_Register_ErrorBranches_GapExtra/wallet_chain_resolve_failed (0.00s)
    --- PASS: TestAuthUsecase_Register_ErrorBranches_GapExtra/wallet_lookup_unexpected_error (0.00s)
    --- PASS: TestAuthUsecase_Register_ErrorBranches_GapExtra/wallet_already_linked_to_another_user (0.00s)
    --- PASS: TestAuthUsecase_Register_ErrorBranches_GapExtra/create_user_failed (0.25s)
    --- PASS: TestAuthUsecase_Register_ErrorBranches_GapExtra/create_wallet_failed (0.25s)
    --- PASS: TestAuthUsecase_Register_ErrorBranches_GapExtra/create_email_verification_failed (0.25s)
=== RUN   TestAuthUsecase_VerifyEmail_MarkVerifiedError_GapExtra
--- PASS: TestAuthUsecase_VerifyEmail_MarkVerifiedError_GapExtra (0.00s)
=== RUN   TestAuthUsecase_RefreshToken_GetUserFailed
--- PASS: TestAuthUsecase_RefreshToken_GetUserFailed (0.00s)
=== RUN   TestAuthUsecase_Register_BadWalletInput
--- PASS: TestAuthUsecase_Register_BadWalletInput (0.00s)
=== RUN   TestAuthUsecase_Register_EmailAlreadyExists
--- PASS: TestAuthUsecase_Register_EmailAlreadyExists (0.00s)
=== RUN   TestAuthUsecase_Register_Success
--- PASS: TestAuthUsecase_Register_Success (0.25s)
=== RUN   TestAuthUsecase_Login_InvalidCredentialCases
--- PASS: TestAuthUsecase_Login_InvalidCredentialCases (0.53s)
=== RUN   TestAuthUsecase_Login_SuccessNoSession
--- PASS: TestAuthUsecase_Login_SuccessNoSession (0.57s)
=== RUN   TestAuthUsecase_VerifyEmail
--- PASS: TestAuthUsecase_VerifyEmail (0.00s)
=== RUN   TestAuthUsecase_RefreshToken
--- PASS: TestAuthUsecase_RefreshToken (0.00s)
=== RUN   TestAuthUsecase_GetTokenExpiry
--- PASS: TestAuthUsecase_GetTokenExpiry (0.00s)
=== RUN   TestAuthUsecase_GetTokenExpiry_MissingExpClaim
--- PASS: TestAuthUsecase_GetTokenExpiry_MissingExpClaim (0.00s)
=== RUN   TestAuthUsecase_ChangePassword
--- PASS: TestAuthUsecase_ChangePassword (1.02s)
=== RUN   TestAuthUsecase_ChangePassword_ErrorBranches
--- PASS: TestAuthUsecase_ChangePassword_ErrorBranches (0.76s)
=== RUN   TestAuthUsecase_ChangePassword_NewPasswordTooLong
--- PASS: TestAuthUsecase_ChangePassword_NewPasswordTooLong (0.51s)
=== RUN   TestAuthUsecase_GetUserByID
--- PASS: TestAuthUsecase_GetUserByID (0.00s)
=== RUN   TestAuthUsecase_Login_UserRepoError
--- PASS: TestAuthUsecase_Login_UserRepoError (0.00s)
=== RUN   TestAuthUsecase_Login_UseSessionRedisError
redis: 2026/02/18 18:07:19 pool.go:426: redis: connection pool: failed to dial after 1 attempts: dial tcp 127.0.0.1:0: connect: can't assign requested address
redis: 2026/02/18 18:07:19 pool.go:426: redis: connection pool: failed to dial after 1 attempts: dial tcp 127.0.0.1:0: connect: can't assign requested address
redis: 2026/02/18 18:07:19 pool.go:426: redis: connection pool: failed to dial after 1 attempts: dial tcp 127.0.0.1:0: connect: can't assign requested address
redis: 2026/02/18 18:07:19 pool.go:426: redis: connection pool: failed to dial after 1 attempts: dial tcp 127.0.0.1:0: connect: can't assign requested address
--- PASS: TestAuthUsecase_Login_UseSessionRedisError (0.79s)
=== RUN   TestAuthUsecase_Login_UseSessionSuccess
--- PASS: TestAuthUsecase_Login_UseSessionSuccess (0.52s)
=== RUN   TestAuthUsecase_Register_ErrorBranches
=== RUN   TestAuthUsecase_Register_ErrorBranches/user_repo_email_lookup_error
=== RUN   TestAuthUsecase_Register_ErrorBranches/invalid_chain_input
=== RUN   TestAuthUsecase_Register_ErrorBranches/wallet_lookup_unexpected_error
=== RUN   TestAuthUsecase_Register_ErrorBranches/wallet_already_linked_to_another_user
=== RUN   TestAuthUsecase_Register_ErrorBranches/existing_wallet_without_user_continues_and_then_user_create_fails
=== RUN   TestAuthUsecase_Register_ErrorBranches/wallet_create_fails_after_user_create
=== RUN   TestAuthUsecase_Register_ErrorBranches/email_verification_create_fails
--- PASS: TestAuthUsecase_Register_ErrorBranches (0.77s)
    --- PASS: TestAuthUsecase_Register_ErrorBranches/user_repo_email_lookup_error (0.00s)
    --- PASS: TestAuthUsecase_Register_ErrorBranches/invalid_chain_input (0.00s)
    --- PASS: TestAuthUsecase_Register_ErrorBranches/wallet_lookup_unexpected_error (0.00s)
    --- PASS: TestAuthUsecase_Register_ErrorBranches/wallet_already_linked_to_another_user (0.00s)
    --- PASS: TestAuthUsecase_Register_ErrorBranches/existing_wallet_without_user_continues_and_then_user_create_fails (0.26s)
    --- PASS: TestAuthUsecase_Register_ErrorBranches/wallet_create_fails_after_user_create (0.25s)
    --- PASS: TestAuthUsecase_Register_ErrorBranches/email_verification_create_fails (0.26s)
=== RUN   TestAuthUsecase_VerifyEmail_MarkVerifiedError
--- PASS: TestAuthUsecase_VerifyEmail_MarkVerifiedError (0.00s)
=== RUN   TestAuthUsecase_RefreshToken_UserLookupError
--- PASS: TestAuthUsecase_RefreshToken_UserLookupError (0.00s)
=== RUN   TestChainResolver_ResolveFromAny_EmptyInput
--- PASS: TestChainResolver_ResolveFromAny_EmptyInput (0.00s)
=== RUN   TestChainResolver_ResolveFromAny_UUIDSuccess
--- PASS: TestChainResolver_ResolveFromAny_UUIDSuccess (0.00s)
=== RUN   TestChainResolver_ResolveFromAny_CAIP2LookupSuccess
--- PASS: TestChainResolver_ResolveFromAny_CAIP2LookupSuccess (0.00s)
=== RUN   TestChainResolver_ResolveFromAny_RawChainIDSuccess
--- PASS: TestChainResolver_ResolveFromAny_RawChainIDSuccess (0.00s)
=== RUN   TestChainResolver_ResolveFromAny_CAIP2FallbackToRawID
    chain_resolver_test.go:99: FAIL:	GetByChainID(context.backgroundCtx,string)
        		at: [/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/usecases/chain_resolver_test.go:92]
    chain_resolver_test.go:99: FAIL: 2 out of 3 expectation(s) were met.
        	The code you are testing needs to make 1 more call(s).
        	at: [/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/usecases/chain_resolver_test.go:99]
--- FAIL: TestChainResolver_ResolveFromAny_CAIP2FallbackToRawID (0.00s)
=== RUN   TestChainResolver_ResolveFromAny_Failure
--- PASS: TestChainResolver_ResolveFromAny_Failure (0.00s)
=== RUN   TestChainResolver_ResolveFromAny_UUIDLookupError
--- PASS: TestChainResolver_ResolveFromAny_UUIDLookupError (0.00s)
=== RUN   TestChainResolver_ResolveFromAny_TrimmedInputAndSolanaFallback
    chain_resolver_test.go:149: FAIL:	GetByChainID(context.backgroundCtx,string)
        		at: [/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/usecases/chain_resolver_test.go:142]
    chain_resolver_test.go:149: FAIL: 2 out of 3 expectation(s) were met.
        	The code you are testing needs to make 1 more call(s).
        	at: [/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/internal/usecases/chain_resolver_test.go:149]
--- FAIL: TestChainResolver_ResolveFromAny_TrimmedInputAndSolanaFallback (0.00s)
=== RUN   TestContractConfigAuditUsecase_Check_DestinationInvalidStillReturnsReport
--- PASS: TestContractConfigAuditUsecase_Check_DestinationInvalidStillReturnsReport (0.00s)
=== RUN   TestContractConfigAuditUsecase_Check_ContractListError
--- PASS: TestContractConfigAuditUsecase_Check_ContractListError (0.00s)
=== RUN   TestContractConfigAuditUsecase_Check_EvmDestRunsOnchainChecksWithRpcMissing
--- PASS: TestContractConfigAuditUsecase_Check_EvmDestRunsOnchainChecksWithRpcMissing (0.00s)
=== RUN   TestContractConfigAuditUsecase_Check_InvalidSource
--- PASS: TestContractConfigAuditUsecase_Check_InvalidSource (0.00s)
=== RUN   TestContractConfigAuditUsecase_Check_SourceChainLoadError
--- PASS: TestContractConfigAuditUsecase_Check_SourceChainLoadError (0.00s)
=== RUN   TestContractConfigAuditUsecase_Check_NoActiveContractWarn
--- PASS: TestContractConfigAuditUsecase_Check_NoActiveContractWarn (0.00s)
=== RUN   TestContractConfigAuditUsecase_CheckByContractID_NonEvmSkipsOnchain
--- PASS: TestContractConfigAuditUsecase_CheckByContractID_NonEvmSkipsOnchain (0.00s)
=== RUN   TestContractConfigAuditUsecase_CheckByContractID_ErrorBranches
=== RUN   TestContractConfigAuditUsecase_CheckByContractID_ErrorBranches/get_contract_failed
=== RUN   TestContractConfigAuditUsecase_CheckByContractID_ErrorBranches/nil_contract_returned
=== RUN   TestContractConfigAuditUsecase_CheckByContractID_ErrorBranches/get_source_chain_failed
=== RUN   TestContractConfigAuditUsecase_CheckByContractID_ErrorBranches/get_all_chains_failed
--- PASS: TestContractConfigAuditUsecase_CheckByContractID_ErrorBranches (0.00s)
    --- PASS: TestContractConfigAuditUsecase_CheckByContractID_ErrorBranches/get_contract_failed (0.00s)
    --- PASS: TestContractConfigAuditUsecase_CheckByContractID_ErrorBranches/nil_contract_returned (0.00s)
    --- PASS: TestContractConfigAuditUsecase_CheckByContractID_ErrorBranches/get_source_chain_failed (0.00s)
    --- PASS: TestContractConfigAuditUsecase_CheckByContractID_ErrorBranches/get_all_chains_failed (0.00s)
=== RUN   TestCrosschainConfigUsecase_Preflight_NoAdapters
--- PASS: TestCrosschainConfigUsecase_Preflight_NoAdapters (0.01s)
=== RUN   TestCrosschainConfigUsecase_AutoFix_NoActiveAdapterContract
--- PASS: TestCrosschainConfigUsecase_AutoFix_NoActiveAdapterContract (0.00s)
=== RUN   TestCrosschainConfigUsecase_AutoFix_LayerZero_AllSkipped
--- PASS: TestCrosschainConfigUsecase_AutoFix_LayerZero_AllSkipped (0.00s)
=== RUN   TestCrosschainConfigUsecase_AutoFix_Hyperbridge_DestinationMissing
--- PASS: TestCrosschainConfigUsecase_AutoFix_Hyperbridge_DestinationMissing (0.00s)
=== RUN   TestCrosschainConfigUsecase_Preflight_CcipNotConfigured
--- PASS: TestCrosschainConfigUsecase_Preflight_CcipNotConfigured (0.01s)
=== RUN   TestCrosschainConfigUsecase_Overview_RecheckFailurePath
--- PASS: TestCrosschainConfigUsecase_Overview_RecheckFailurePath (0.00s)
=== RUN   TestCrosschainConfigUsecase_AutoFix_RegisterAdapterFailed
--- PASS: TestCrosschainConfigUsecase_AutoFix_RegisterAdapterFailed (0.00s)
=== RUN   TestCrosschainConfigUsecase_AutoFix_SetDefaultBridgeFailed
--- PASS: TestCrosschainConfigUsecase_AutoFix_SetDefaultBridgeFailed (0.00s)
=== RUN   TestCrosschainConfigUsecase_AutoFix_SetHyperbridgeConfigFailed
--- PASS: TestCrosschainConfigUsecase_AutoFix_SetHyperbridgeConfigFailed (0.00s)
=== RUN   TestCrosschainConfigUsecase_RecheckRoute_StatusAndFeeQuoteIssue
--- PASS: TestCrosschainConfigUsecase_RecheckRoute_StatusAndFeeQuoteIssue (0.00s)
=== RUN   TestCrosschainConfigUsecase_Overview_GetAllError
--- PASS: TestCrosschainConfigUsecase_Overview_GetAllError (0.00s)
=== RUN   TestCrosschainConfigUsecase_Overview_InvalidSource
--- PASS: TestCrosschainConfigUsecase_Overview_InvalidSource (0.00s)
=== RUN   TestCrosschainConfigUsecase_RecheckRoute_InvalidInput
--- PASS: TestCrosschainConfigUsecase_RecheckRoute_InvalidInput (0.00s)
=== RUN   TestCrosschainConfigUsecase_Preflight_InvalidInput
--- PASS: TestCrosschainConfigUsecase_Preflight_InvalidInput (0.00s)
=== RUN   TestCrosschainConfigUsecase_AutoFix_InvalidSourceInput
--- PASS: TestCrosschainConfigUsecase_AutoFix_InvalidSourceInput (0.00s)
=== RUN   TestMerchantUsecase_ApplyMerchant_ExistingApplication
--- PASS: TestMerchantUsecase_ApplyMerchant_ExistingApplication (0.00s)
=== RUN   TestMerchantUsecase_ApplyMerchant_InvalidType
--- PASS: TestMerchantUsecase_ApplyMerchant_InvalidType (0.00s)
=== RUN   TestMerchantUsecase_GetMerchantStatus_NotFound
--- PASS: TestMerchantUsecase_GetMerchantStatus_NotFound (0.00s)
=== RUN   TestMerchantUsecase_GetMerchantStatus_Active
--- PASS: TestMerchantUsecase_GetMerchantStatus_Active (0.00s)
=== RUN   TestMerchantUsecase_AdminStatusActions
--- PASS: TestMerchantUsecase_AdminStatusActions (0.00s)
=== RUN   TestMerchantUsecase_ApplyMerchant_SuccessCreate
--- PASS: TestMerchantUsecase_ApplyMerchant_SuccessCreate (0.00s)
=== RUN   TestMerchantUsecase_ApplyMerchant_UserLookupError
--- PASS: TestMerchantUsecase_ApplyMerchant_UserLookupError (0.00s)
=== RUN   TestMerchantUsecase_ApplyMerchant_GetByUserError
--- PASS: TestMerchantUsecase_ApplyMerchant_GetByUserError (0.00s)
=== RUN   TestMerchantUsecase_GetMerchantStatus_RepoError
--- PASS: TestMerchantUsecase_GetMerchantStatus_RepoError (0.00s)
=== RUN   TestMerchantUsecase_GetMerchantStatus_MessageVariants
--- PASS: TestMerchantUsecase_GetMerchantStatus_MessageVariants (0.00s)
=== RUN   TestMerchantUsecase_GetMerchantStatus_UnknownStatusFallsBackEmptyMessage
--- PASS: TestMerchantUsecase_GetMerchantStatus_UnknownStatusFallsBackEmptyMessage (0.00s)
=== RUN   TestMerchantUsecase_ApplyMerchant_CreateError
--- PASS: TestMerchantUsecase_ApplyMerchant_CreateError (0.00s)
=== RUN   TestOnchainAdapterUsecase_Setters_InvalidSourceChain
--- PASS: TestOnchainAdapterUsecase_Setters_InvalidSourceChain (0.00s)
=== RUN   TestOnchainAdapterUsecase_Setters_InvalidDestChain
--- PASS: TestOnchainAdapterUsecase_Setters_InvalidDestChain (0.00s)
=== RUN   TestOnchainAdapterUsecase_SetHyperbridgeConfig_ClientFactoryNotConfigured
--- PASS: TestOnchainAdapterUsecase_SetHyperbridgeConfig_ClientFactoryNotConfigured (0.00s)
=== RUN   TestOnchainAdapterUsecase_SetCCIPConfig_ClientFactoryNotConfigured
--- PASS: TestOnchainAdapterUsecase_SetCCIPConfig_ClientFactoryNotConfigured (0.00s)
=== RUN   TestOnchainAdapterUsecase_RegisterAndDefaultBridge_OwnerKeyMissing
--- PASS: TestOnchainAdapterUsecase_RegisterAndDefaultBridge_OwnerKeyMissing (0.00s)
=== RUN   TestOnchainAdapterUsecase_SetLayerZeroConfig_ClientFactoryNotConfigured
--- PASS: TestOnchainAdapterUsecase_SetLayerZeroConfig_ClientFactoryNotConfigured (0.00s)
=== RUN   TestOnchainAdapterUsecase_GetStatus_Success
--- PASS: TestOnchainAdapterUsecase_GetStatus_Success (0.00s)
=== RUN   TestOnchainAdapterUsecase_GetStatus_AllBridgeAdapters
--- PASS: TestOnchainAdapterUsecase_GetStatus_AllBridgeAdapters (0.00s)
=== RUN   TestOnchainAdapterUsecase_GetStatus_InvalidSource
--- PASS: TestOnchainAdapterUsecase_GetStatus_InvalidSource (0.00s)
=== RUN   TestOnchainAdapterUsecase_GetStatus_InvalidDest
--- PASS: TestOnchainAdapterUsecase_GetStatus_InvalidDest (0.00s)
=== RUN   TestOnchainAdapterUsecase_GetStatus_SourceNonEVM
--- PASS: TestOnchainAdapterUsecase_GetStatus_SourceNonEVM (0.00s)
=== RUN   TestOnchainAdapterUsecase_GetStatus_GatewayMissing
--- PASS: TestOnchainAdapterUsecase_GetStatus_GatewayMissing (0.00s)
=== RUN   TestOnchainAdapterUsecase_GetStatus_RouterMissing
--- PASS: TestOnchainAdapterUsecase_GetStatus_RouterMissing (0.00s)
=== RUN   TestOnchainAdapterUsecase_GetStatus_NoRPC
--- PASS: TestOnchainAdapterUsecase_GetStatus_NoRPC (0.00s)
=== RUN   TestOnchainAdapterUsecase_GetStatus_RPCConnectError
--- PASS: TestOnchainAdapterUsecase_GetStatus_RPCConnectError (0.00s)
=== RUN   TestPaymentAppUsecase_CreatePaymentApp_InvalidSourceChain
--- PASS: TestPaymentAppUsecase_CreatePaymentApp_InvalidSourceChain (0.00s)
=== RUN   TestPaymentAppUsecase_CreatePaymentApp_InvalidDestChain
--- PASS: TestPaymentAppUsecase_CreatePaymentApp_InvalidDestChain (0.00s)
=== RUN   TestPaymentAppUsecase_CreatePaymentApp_AutoCreateUserFails
--- PASS: TestPaymentAppUsecase_CreatePaymentApp_AutoCreateUserFails (0.00s)
=== RUN   TestPaymentAppUsecase_CreatePaymentApp_AutoCreateWalletFails
--- PASS: TestPaymentAppUsecase_CreatePaymentApp_AutoCreateWalletFails (0.00s)
=== RUN   TestPaymentAppUsecase_CreatePaymentApp_ExistingWalletPath_ExecutesDelegation
--- PASS: TestPaymentAppUsecase_CreatePaymentApp_ExistingWalletPath_ExecutesDelegation (0.00s)
=== RUN   TestPaymentRequestUsecase_GetPaymentRequest_ChainResolutionBranches
=== RUN   TestPaymentRequestUsecase_GetPaymentRequest_ChainResolutionBranches/resolve_chain_id_from_network_id_when_chain_uuid_is_empty
=== RUN   TestPaymentRequestUsecase_GetPaymentRequest_ChainResolutionBranches/resolve_network_id_from_chain_id_when_network_is_empty
--- PASS: TestPaymentRequestUsecase_GetPaymentRequest_ChainResolutionBranches (0.00s)
    --- PASS: TestPaymentRequestUsecase_GetPaymentRequest_ChainResolutionBranches/resolve_chain_id_from_network_id_when_chain_uuid_is_empty (0.00s)
    --- PASS: TestPaymentRequestUsecase_GetPaymentRequest_ChainResolutionBranches/resolve_network_id_from_chain_id_when_network_is_empty (0.00s)
=== RUN   TestPaymentRequestUsecase_CreatePaymentRequest_MerchantNotFound
--- PASS: TestPaymentRequestUsecase_CreatePaymentRequest_MerchantNotFound (0.00s)
=== RUN   TestPaymentRequestUsecase_CreatePaymentRequest_MerchantInactive
--- PASS: TestPaymentRequestUsecase_CreatePaymentRequest_MerchantInactive (0.00s)
=== RUN   TestPaymentRequestUsecase_CreatePaymentRequest_SuccessEVM
--- PASS: TestPaymentRequestUsecase_CreatePaymentRequest_SuccessEVM (0.00s)
=== RUN   TestPaymentRequestUsecase_CreatePaymentRequest_DecimalsMismatch
--- PASS: TestPaymentRequestUsecase_CreatePaymentRequest_DecimalsMismatch (0.00s)
=== RUN   TestPaymentRequestUsecase_CreatePaymentRequest_NoPrimaryWallet_UsesFirstWallet
--- PASS: TestPaymentRequestUsecase_CreatePaymentRequest_NoPrimaryWallet_UsesFirstWallet (0.00s)
=== RUN   TestPaymentRequestUsecase_GetPaymentRequest_ExpirePending
--- PASS: TestPaymentRequestUsecase_GetPaymentRequest_ExpirePending (0.00s)
=== RUN   TestPaymentRequestUsecase_ListAndMarkCompleted
--- PASS: TestPaymentRequestUsecase_ListAndMarkCompleted (0.00s)
=== RUN   TestPaymentRequestUsecase_CreatePaymentRequest_ErrorBranches
=== RUN   TestPaymentRequestUsecase_CreatePaymentRequest_ErrorBranches/wallet_repository_error
=== RUN   TestPaymentRequestUsecase_CreatePaymentRequest_ErrorBranches/no_wallet_found
=== RUN   TestPaymentRequestUsecase_CreatePaymentRequest_ErrorBranches/invalid_chain_id
=== RUN   TestPaymentRequestUsecase_CreatePaymentRequest_ErrorBranches/token_fallback_to_native_failed
=== RUN   TestPaymentRequestUsecase_CreatePaymentRequest_ErrorBranches/amount_conversion_invalid
=== RUN   TestPaymentRequestUsecase_CreatePaymentRequest_ErrorBranches/create_payment_request_repository_error
--- PASS: TestPaymentRequestUsecase_CreatePaymentRequest_ErrorBranches (0.00s)
    --- PASS: TestPaymentRequestUsecase_CreatePaymentRequest_ErrorBranches/wallet_repository_error (0.00s)
    --- PASS: TestPaymentRequestUsecase_CreatePaymentRequest_ErrorBranches/no_wallet_found (0.00s)
    --- PASS: TestPaymentRequestUsecase_CreatePaymentRequest_ErrorBranches/invalid_chain_id (0.00s)
    --- PASS: TestPaymentRequestUsecase_CreatePaymentRequest_ErrorBranches/token_fallback_to_native_failed (0.00s)
    --- PASS: TestPaymentRequestUsecase_CreatePaymentRequest_ErrorBranches/amount_conversion_invalid (0.00s)
    --- PASS: TestPaymentRequestUsecase_CreatePaymentRequest_ErrorBranches/create_payment_request_repository_error (0.00s)
=== RUN   TestPaymentRequestUsecase_GetAndList_ErrorBranches
=== RUN   TestPaymentRequestUsecase_GetAndList_ErrorBranches/get_payment_request_not_found
=== RUN   TestPaymentRequestUsecase_GetAndList_ErrorBranches/list_payment_requests_merchant_not_found
--- PASS: TestPaymentRequestUsecase_GetAndList_ErrorBranches (0.00s)
    --- PASS: TestPaymentRequestUsecase_GetAndList_ErrorBranches/get_payment_request_not_found (0.00s)
    --- PASS: TestPaymentRequestUsecase_GetAndList_ErrorBranches/list_payment_requests_merchant_not_found (0.00s)
=== RUN   TestCreatePayment_Success
--- PASS: TestCreatePayment_Success (0.00s)
=== RUN   TestProcessIndexerWebhook_Locking
2026/02/18 18:07:20 Processing indexer event: PAYMENT_COMPLETED
--- PASS: TestProcessIndexerWebhook_Locking (0.00s)
=== RUN   TestPaymentUsecase_ReadWrappers
--- PASS: TestPaymentUsecase_ReadWrappers (0.00s)
=== RUN   TestWalletUsecase_ConnectWallet_BadInput
--- PASS: TestWalletUsecase_ConnectWallet_BadInput (0.00s)
=== RUN   TestWalletUsecase_ConnectWallet_ExistingWalletSameUser
--- PASS: TestWalletUsecase_ConnectWallet_ExistingWalletSameUser (0.00s)
=== RUN   TestWalletUsecase_ConnectWallet_KYCRequiredForAdditionalWallet
--- PASS: TestWalletUsecase_ConnectWallet_KYCRequiredForAdditionalWallet (0.00s)
=== RUN   TestWalletUsecase_DisconnectWallet_Forbidden
--- PASS: TestWalletUsecase_DisconnectWallet_Forbidden (0.00s)
=== RUN   TestWalletUsecase_DisconnectWallet_Success
--- PASS: TestWalletUsecase_DisconnectWallet_Success (0.00s)
=== RUN   TestWalletUsecase_ConnectWallet_ErrorBranches
=== RUN   TestWalletUsecase_ConnectWallet_ErrorBranches/user_lookup_error
=== RUN   TestWalletUsecase_ConnectWallet_ErrorBranches/get_wallets_error
=== RUN   TestWalletUsecase_ConnectWallet_ErrorBranches/invalid_chain_id_resolver
=== RUN   TestWalletUsecase_ConnectWallet_ErrorBranches/wallet_exists_for_another_user
--- PASS: TestWalletUsecase_ConnectWallet_ErrorBranches (0.00s)
    --- PASS: TestWalletUsecase_ConnectWallet_ErrorBranches/user_lookup_error (0.00s)
    --- PASS: TestWalletUsecase_ConnectWallet_ErrorBranches/get_wallets_error (0.00s)
    --- PASS: TestWalletUsecase_ConnectWallet_ErrorBranches/invalid_chain_id_resolver (0.00s)
    --- PASS: TestWalletUsecase_ConnectWallet_ErrorBranches/wallet_exists_for_another_user (0.00s)
=== RUN   TestWalletUsecase_ConnectWallet_CreateBranches
=== RUN   TestWalletUsecase_ConnectWallet_CreateBranches/create_error
=== RUN   TestWalletUsecase_ConnectWallet_CreateBranches/admin_additional_wallet_bypass_kyc_and_success
--- PASS: TestWalletUsecase_ConnectWallet_CreateBranches (0.00s)
    --- PASS: TestWalletUsecase_ConnectWallet_CreateBranches/create_error (0.00s)
    --- PASS: TestWalletUsecase_ConnectWallet_CreateBranches/admin_additional_wallet_bypass_kyc_and_success (0.00s)
=== RUN   TestWalletUsecase_DisconnectWallet_GetByIDError
--- PASS: TestWalletUsecase_DisconnectWallet_GetByIDError (0.00s)
=== RUN   TestWalletUsecase_GetWallets_And_SetPrimary
--- PASS: TestWalletUsecase_GetWallets_And_SetPrimary (0.00s)
=== RUN   TestWalletUsecase_ConnectWallet_GetByAddressErrorAndSecondResolveFail
=== RUN   TestWalletUsecase_ConnectWallet_GetByAddressErrorAndSecondResolveFail/get_by_address_returns_unexpected_error
=== RUN   TestWalletUsecase_ConnectWallet_GetByAddressErrorAndSecondResolveFail/second_resolver_call_fails_after_first_success
--- PASS: TestWalletUsecase_ConnectWallet_GetByAddressErrorAndSecondResolveFail (0.00s)
    --- PASS: TestWalletUsecase_ConnectWallet_GetByAddressErrorAndSecondResolveFail/get_by_address_returns_unexpected_error (0.00s)
    --- PASS: TestWalletUsecase_ConnectWallet_GetByAddressErrorAndSecondResolveFail/second_resolver_call_fails_after_first_success (0.00s)
=== RUN   TestWebhookUsecase_ProcessIndexerWebhook_InvalidJSON
2026/02/18 18:07:20 Processing indexer event: PAYMENT_COMPLETED
--- PASS: TestWebhookUsecase_ProcessIndexerWebhook_InvalidJSON (0.00s)
=== RUN   TestWebhookUsecase_ProcessIndexerWebhook_PaymentCompletedSuccess
2026/02/18 18:07:20 Processing indexer event: PAYMENT_COMPLETED
--- PASS: TestWebhookUsecase_ProcessIndexerWebhook_PaymentCompletedSuccess (0.00s)
=== RUN   TestWebhookUsecase_ProcessIndexerWebhook_PaymentUpdateFails
2026/02/18 18:07:20 Processing indexer event: PAYMENT_EXECUTED
2026/02/18 18:07:20 Error processing payment update: db error
--- PASS: TestWebhookUsecase_ProcessIndexerWebhook_PaymentUpdateFails (0.00s)
=== RUN   TestWebhookUsecase_ProcessIndexerWebhook_RequestPaymentReceived
2026/02/18 18:07:20 Processing indexer event: REQUEST_PAYMENT_RECEIVED
--- PASS: TestWebhookUsecase_ProcessIndexerWebhook_RequestPaymentReceived (0.00s)
=== RUN   TestWebhookUsecase_ProcessIndexerWebhook_RequestPaymentReceived_InvalidJSON
2026/02/18 18:07:20 Processing indexer event: REQUEST_PAYMENT_RECEIVED
--- PASS: TestWebhookUsecase_ProcessIndexerWebhook_RequestPaymentReceived_InvalidJSON (0.00s)
=== RUN   TestWebhookUsecase_ProcessIndexerWebhook_RequestPaymentReceived_MarkCompletedErrorStillNil
2026/02/18 18:07:20 Processing indexer event: REQUEST_PAYMENT_RECEIVED
2026/02/18 18:07:20 Error marking payment request as completed: update failed
--- PASS: TestWebhookUsecase_ProcessIndexerWebhook_RequestPaymentReceived_MarkCompletedErrorStillNil (0.00s)
=== RUN   TestWebhookUsecase_ProcessIndexerWebhook_PaymentCompleted_UOWDoError
2026/02/18 18:07:20 Processing indexer event: PAYMENT_COMPLETED
2026/02/18 18:07:20 Error processing payment update: tx begin failed
--- PASS: TestWebhookUsecase_ProcessIndexerWebhook_PaymentCompleted_UOWDoError (0.00s)
=== RUN   TestWebhookUsecase_ProcessIndexerWebhook_UnhandledEvent
2026/02/18 18:07:20 Processing indexer event: SOME_UNKNOWN_EVENT
2026/02/18 18:07:20 Unhandled event type: SOME_UNKNOWN_EVENT
--- PASS: TestWebhookUsecase_ProcessIndexerWebhook_UnhandledEvent (0.00s)
=== RUN   TestWebhookUsecase_ProcessIndexerWebhook_PaymentUpdateStatusError
2026/02/18 18:07:20 Processing indexer event: PAYMENT_EXECUTED
2026/02/18 18:07:20 Error processing payment update: update status failed
--- PASS: TestWebhookUsecase_ProcessIndexerWebhook_PaymentUpdateStatusError (0.00s)
=== RUN   TestWebhookUsecase_ProcessIndexerWebhook_PaymentRequestCreatedBranch
2026/02/18 18:07:20 Processing indexer event: PAYMENT_REQUEST_CREATED
2026/02/18 18:07:20 Payment request created on-chain: {"requestId":"abc"}
--- PASS: TestWebhookUsecase_ProcessIndexerWebhook_PaymentRequestCreatedBranch (0.00s)
=== RUN   TestWebhookUsecase_ProcessIndexerWebhook_PaymentFailed
2026/02/18 18:07:20 Processing indexer event: PAYMENT_FAILED
--- PASS: TestWebhookUsecase_ProcessIndexerWebhook_PaymentFailed (0.00s)
=== CONT  TestFormatDecodedRouteErrorForPreflight
=== RUN   TestFormatDecodedRouteErrorForPreflight/prefer_detailed_message
=== PAUSE TestFormatDecodedRouteErrorForPreflight/prefer_detailed_message
=== RUN   TestFormatDecodedRouteErrorForPreflight/fallback_by_known_name
=== PAUSE TestFormatDecodedRouteErrorForPreflight/fallback_by_known_name
=== RUN   TestFormatDecodedRouteErrorForPreflight/unknown_name_returns_name
=== PAUSE TestFormatDecodedRouteErrorForPreflight/unknown_name_returns_name
=== RUN   TestFormatDecodedRouteErrorForPreflight/selector_fallback
=== PAUSE TestFormatDecodedRouteErrorForPreflight/selector_fallback
=== RUN   TestFormatDecodedRouteErrorForPreflight/generic_fallback
=== PAUSE TestFormatDecodedRouteErrorForPreflight/generic_fallback
=== CONT  TestFormatDecodedRouteErrorForPreflight/prefer_detailed_message
=== CONT  TestDecodeRouteErrorData_UnknownSelector
--- PASS: TestDecodeRouteErrorData_UnknownSelector (0.00s)
=== CONT  TestDecodeRouteErrorData_NoErrorRecorded
--- PASS: TestDecodeRouteErrorData_NoErrorRecorded (0.00s)
=== CONT  TestFormatDecodedRouteErrorForPreflight/unknown_name_returns_name
=== CONT  TestDecodeRouteErrorData_ErrorString
=== CONT  TestDecodeRouteErrorData_InsufficientNativeFeePayload
--- PASS: TestDecodeRouteErrorData_ErrorString (0.00s)
=== CONT  TestDecodeRouteErrorData_KnownCustomSelectorWithPayload
--- PASS: TestDecodeRouteErrorData_InsufficientNativeFeePayload (0.00s)
=== CONT  TestDecodeRouteErrorData_KnownCustomSelector
--- PASS: TestDecodeRouteErrorData_KnownCustomSelectorWithPayload (0.00s)
--- PASS: TestDecodeRouteErrorData_KnownCustomSelector (0.00s)
=== CONT  TestDecodeRouteErrorData_Panic
--- PASS: TestDecodeRouteErrorData_Panic (0.00s)
=== CONT  TestFormatDecodedRouteErrorForPreflight/selector_fallback
=== CONT  TestNormalizeBytes32Hex
--- PASS: TestNormalizeBytes32Hex (0.00s)
=== CONT  TestFormatDecodedRouteErrorForPreflight/generic_fallback
=== CONT  TestFormatDecodedRouteErrorForPreflight/fallback_by_known_name
--- PASS: TestFormatDecodedRouteErrorForPreflight (0.00s)
    --- PASS: TestFormatDecodedRouteErrorForPreflight/prefer_detailed_message (0.00s)
    --- PASS: TestFormatDecodedRouteErrorForPreflight/unknown_name_returns_name (0.00s)
    --- PASS: TestFormatDecodedRouteErrorForPreflight/selector_fallback (0.00s)
    --- PASS: TestFormatDecodedRouteErrorForPreflight/generic_fallback (0.00s)
    --- PASS: TestFormatDecodedRouteErrorForPreflight/fallback_by_known_name (0.00s)
FAIL
FAIL	pay-chain.backend/internal/usecases	8.232s
=== RUN   TestHashAndCheckPassword
--- PASS: TestHashAndCheckPassword (2.00s)
=== RUN   TestGenerateRandomToken
--- PASS: TestGenerateRandomToken (0.00s)
=== RUN   TestHashPasswordAndGenerateRandomToken_ErrorBranches
--- PASS: TestHashPasswordAndGenerateRandomToken_ErrorBranches (0.00s)
PASS
ok  	pay-chain.backend/pkg/crypto	(cached)
=== RUN   TestJWTService_GenerateAndValidate
--- PASS: TestJWTService_GenerateAndValidate (0.00s)
=== RUN   TestJWTService_ValidateInvalidToken
--- PASS: TestJWTService_ValidateInvalidToken (0.00s)
=== RUN   TestJWTService_ValidateExpiredToken
--- PASS: TestJWTService_ValidateExpiredToken (0.00s)
=== RUN   TestJWTService_ValidateWrongSigningMethod
--- PASS: TestJWTService_ValidateWrongSigningMethod (0.00s)
=== RUN   TestJWTService_GenerateTokenPair_ErrorBranches
=== RUN   TestJWTService_GenerateTokenPair_ErrorBranches/access_token_generation_failed
=== RUN   TestJWTService_GenerateTokenPair_ErrorBranches/refresh_token_generation_failed
--- PASS: TestJWTService_GenerateTokenPair_ErrorBranches (0.00s)
    --- PASS: TestJWTService_GenerateTokenPair_ErrorBranches/access_token_generation_failed (0.00s)
    --- PASS: TestJWTService_GenerateTokenPair_ErrorBranches/refresh_token_generation_failed (0.00s)
=== RUN   TestJWTService_ValidateToken_ClaimsTypeAndValidityBranches
=== RUN   TestJWTService_ValidateToken_ClaimsTypeAndValidityBranches/invalid_claims_type
=== RUN   TestJWTService_ValidateToken_ClaimsTypeAndValidityBranches/token_invalid_flag
--- PASS: TestJWTService_ValidateToken_ClaimsTypeAndValidityBranches (0.00s)
    --- PASS: TestJWTService_ValidateToken_ClaimsTypeAndValidityBranches/invalid_claims_type (0.00s)
    --- PASS: TestJWTService_ValidateToken_ClaimsTypeAndValidityBranches/token_invalid_flag (0.00s)
PASS
ok  	pay-chain.backend/pkg/jwt	(cached)
=== RUN   TestInitAndContextLogging
2026-02-17T22:39:57.829+0700	[34mINFO[0m	logger/logger_test.go:25	info	{"request_id": "req-1"}
2026-02-17T22:39:57.830+0700	[35mDEBUG[0m	logger/logger_test.go:26	debug	{"request_id": "req-1"}
2026-02-17T22:39:57.830+0700	[33mWARN[0m	logger/logger_test.go:27	warn	{"request_id": "req-1"}
pay-chain.backend/pkg/logger.TestInitAndContextLogging
	/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/pkg/logger/logger_test.go:27
testing.tRunner
	/usr/local/go/src/testing/testing.go:1934
2026-02-17T22:39:57.830+0700	[31mERROR[0m	logger/logger_test.go:28	error	{"request_id": "req-1"}
pay-chain.backend/pkg/logger.TestInitAndContextLogging
	/Users/staffinc/Documents/Development/pay-chain/pay-chain.backend/pkg/logger/logger_test.go:28
testing.tRunner
	/usr/local/go/src/testing/testing.go:1934
2026-02-17T22:39:57.830+0700	[34mINFO[0m	logger/logger_test.go:29	HTTP Request	{"request_id": "req-1", "method": "GET", "path": "/health", "status": 200, "latency": "10ms", "client_ip": "127.0.0.1"}
--- PASS: TestInitAndContextLogging (0.00s)
=== RUN   TestWithContextNil
--- PASS: TestWithContextNil (0.00s)
=== RUN   TestWithContextTypedRequestID
--- PASS: TestWithContextTypedRequestID (0.00s)
=== RUN   TestInit_ProductionAndWithContextWithoutFields
--- PASS: TestInit_ProductionAndWithContextWithoutFields (0.00s)
=== RUN   TestInit_PanicWhenLoggerBuildFails
--- PASS: TestInit_PanicWhenLoggerBuildFails (0.00s)
PASS
ok  	pay-chain.backend/pkg/logger	(cached)
=== RUN   TestInitInvalidURL
--- PASS: TestInitInvalidURL (0.00s)
=== RUN   TestInitValidURLWithPingHook
--- PASS: TestInitValidURLWithPingHook (0.00s)
=== RUN   TestSetClientAndBasicOpsWithUnreachableRedis
redis: 2026/02/17 22:39:59 pool.go:426: redis: connection pool: failed to dial after 1 attempts: dial tcp 127.0.0.1:0: connect: can't assign requested address
--- PASS: TestSetClientAndBasicOpsWithUnreachableRedis (0.11s)
=== RUN   TestInitAndBasicOpsSuccessWithMiniRedis
redis: 2026/02/17 22:39:59 pool.go:426: redis: connection pool: failed to dial after 1 attempts: dial tcp 127.0.0.1:0: connect: can't assign requested address
--- PASS: TestInitAndBasicOpsSuccessWithMiniRedis (0.02s)
=== RUN   TestPingClient_WrapperExecutes
--- PASS: TestPingClient_WrapperExecutes (0.10s)
=== RUN   TestNewSessionStoreValidation
--- PASS: TestNewSessionStoreValidation (0.00s)
=== RUN   TestSessionStoreEncryptDecrypt
--- PASS: TestSessionStoreEncryptDecrypt (0.00s)
=== RUN   TestSessionStoreEncryptDecrypt_InvalidKeyMaterial
--- PASS: TestSessionStoreEncryptDecrypt_InvalidKeyMaterial (0.00s)
=== RUN   TestSessionStoreCreateGetDeleteWithUnreachableRedis
--- PASS: TestSessionStoreCreateGetDeleteWithUnreachableRedis (0.15s)
=== RUN   TestSessionStoreCreateGetDeleteSuccess
--- PASS: TestSessionStoreCreateGetDeleteSuccess (0.00s)
=== RUN   TestSessionStore_GetSessionInvalidJSONPayload
--- PASS: TestSessionStore_GetSessionInvalidJSONPayload (0.00s)
=== RUN   TestSessionStore_OperationHooks
--- PASS: TestSessionStore_OperationHooks (0.00s)
=== RUN   TestSessionStore_CreateSession_MarshalErrorBranch
--- PASS: TestSessionStore_CreateSession_MarshalErrorBranch (0.00s)
=== RUN   TestSessionStore_CreateSession_EncryptErrorBranch
--- PASS: TestSessionStore_CreateSession_EncryptErrorBranch (0.00s)
=== RUN   TestSessionStore_Encrypt_RandReaderError
--- PASS: TestSessionStore_Encrypt_RandReaderError (0.00s)
=== RUN   TestSessionStore_GCMCreationErrorBranches
--- PASS: TestSessionStore_GCMCreationErrorBranches (0.00s)
=== RUN   TestSessionStore_GetSession_JSONUnmarshalErrorHooked
--- PASS: TestSessionStore_GetSession_JSONUnmarshalErrorHooked (0.00s)
PASS
ok  	pay-chain.backend/pkg/redis	(cached)
=== RUN   TestGetPaginationParams
--- PASS: TestGetPaginationParams (0.00s)
=== RUN   TestCalculateOffset
--- PASS: TestCalculateOffset (0.00s)
=== RUN   TestCalculateMeta
--- PASS: TestCalculateMeta (0.00s)
=== RUN   TestGenerateUUIDv7
--- PASS: TestGenerateUUIDv7 (0.00s)
=== RUN   TestGenerateUUIDv7_FallbackBranch
--- PASS: TestGenerateUUIDv7_FallbackBranch (0.00s)
PASS
ok  	pay-chain.backend/pkg/utils	(cached)
FAIL
make: *** [test] Error 1
